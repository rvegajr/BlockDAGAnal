;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="1838fabd-3aa6-6d6a-0e1a-11af03b9b06a")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,4614845,e=>{e.v({"webhook-events-wrapper":"form-webhooks-events-module__mJ74LW__webhook-events-wrapper"})},2119656,e=>{e.v({"add-webhooks-wrapper":"form-add-webhooks-module__ndWq1q__add-webhooks-wrapper"})},9029673,e=>{"use strict";var t=e.i(847684),s=e.i(7185353),l=e.i(2504781),a=e.i(7137884),i=e.i(8517043),r=e.i(1232681),n=e.i(6891161),o=e.i(455575),c=e.i(509783),d=e.i(6239252),u=e.i(57106),h=e.i(5338940),m=e.i(1119178),x=e.i(3807412),f=e.i(2384992),b=e.i(2565125),p=e.i(6872861),j=e.i(3870791),g=e.i(2098824),v=e.i(4614845);function y(e){let{canListWebhooks:s,arePermissionsLoading:l,selectedEvents:a,onEventsChange:i,webhookTarget:r,filteredEvents:n,noTitle:o}=e;return(0,t.jsxs)("div",{children:[(0,t.jsx)(g.FormTitleDescription,{description:"Select the events the webhook will listen to. At least one must be selected.",title:o?"":"Events"}),!l&&s?(0,t.jsx)("div",{className:v.default["webhook-events-wrapper"],children:(0,t.jsx)(j.WebhookEventsSelector,{initialWebhookEventNames:[],onWebhookEventNamesChange:i,webhookEventNames:a,webhookTarget:r,filteredEvents:n})}):(0,t.jsx)("div",{className:v.default["webhook-events-wrapper"],children:(0,t.jsx)(j.WebhookEventsGroupRedacted,{isLoading:l})})]})}var k=e.i(3500331),w=e.i(6292193);function C(e){let{url:s,onUrlChanged:l}=e;return(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial",children:[(0,t.jsx)("div",{children:(0,t.jsx)(g.FormTitleDescription,{as:"label",description:(0,t.jsxs)("span",{className:"text-copy-14",children:["Webhooks events will be sent as ",(0,t.jsx)(w.InlineCode,{children:"POST"})," ","request to this URL."]}),htmlFor:"webhook-url",title:"Endpoint"})}),(0,t.jsx)(k.Input,{explicitId:"webhook-url",id:"webhook-url",maxLength:512,onChange:e=>l(e.target.value),placeholder:"https://my-app.com/webhooks",value:s,width:"100%"})]})}var N=e.i(2119656);e.s(["AddWebhooks",0,function(e){let{filteredEvents:j,view:g="page",onClose:v,onBack:k,backButtonLabel:w,ModalAction:E,preselectedEvents:T}=e,S=(0,o.useToasts)(),{createWebhook:A,permissions:P}=(0,x.useWebhooks)({enabled:!0}),{data:W,isLoading:_}=(0,f.useWebhookEvents)(),[I,L]=(0,s.useState)(T??[]),[M,O]=(0,s.useState)(""),[B,R]=(0,s.useState)(b.ProjectTypes.ALL),[$,F]=(0,s.useState)([]),{isReady:H,team:U}=(0,h.useTeam)(),[D,V]=(0,s.useState)(null),[Z,z]=(0,s.useState)(!1),K={type:f.WebhookTargetType.Team,projectScope:B===b.ProjectTypes.ALL?f.WebhookProjectScope.All:f.WebhookProjectScope.Selected},G=e=>{R(e),L((0,f.filterWebhookEventNamesByProjectScope)(W.webhookEvents,I,{...K,projectScope:e===b.ProjectTypes.ALL?f.WebhookProjectScope.All:f.WebhookProjectScope.Selected}))},q=(0,s.useCallback)(async()=>{let e={events:I,url:M,projectIds:B===b.ProjectTypes.ALL?void 0:$.map(e=>e.id),teamId:U?.id},t=e.url?e.events.length?null:"At least one event is required":"An Endpoint is required!";if(t)return void S.error(t);z(!0);try{let t=await A(e);V(t),L([]),O(""),R(b.ProjectTypes.ALL),F([])}catch(e){S.error(e?.message??"An error occurred while creating the webhook")}finally{z(!1)}},[A,I,B,$,U?.id,S,M]),Y=U?.billing?.trial&&"pro"===U.billing.plan,J=!!(U?.billing?.plan==="hobby"||Y),Q=!P.isLoading&&P.create&&!J,X=!P.isLoading&&P.list&&!J;return(0,t.jsx)(t.Fragment,{children:"page"===g?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:(0,t.jsx)("h3",{className:"text-heading-20",children:(0,t.jsx)(d.SearchContextHighlighter,{children:"Add Webhooks"})})}),(0,t.jsxs)(i.Fieldset,{className:N.default["add-webhooks-wrapper"],children:[(0,t.jsx)(a.FieldsetContent,{disabled:!Q,children:ee({})}),(0,t.jsxs)(r.FieldsetFooter,{children:[(0,t.jsx)(r.FieldsetFooter.Status,{children:et()}),(0,t.jsx)(r.FieldsetFooter.Actions,{children:es()})]})]}),(0,t.jsx)(p.FormAddWebhookModal,{onClose:()=>{V(null),v?.()},webhook:D,view:g})]}):(0,t.jsx)(t.Fragment,{children:D?(0,t.jsx)(p.FormAddWebhookModal,{onClose:()=>{V(null),v?.()},webhook:D,view:g}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"py-5 px-6 flex flex-col gap-2 border-0 border-b border-gray-200",children:[(0,t.jsxs)(n.Modal.Title,{className:"flex items-center gap-2",children:[(0,t.jsx)(c.Webhook,{color:"gray-700",size:24})," Subscribe with a webhook"]}),(0,t.jsx)(n.Modal.Subtitle,{children:"Follow these steps to subscribe to alerts with a webhook:"})]}),(0,t.jsx)(n.Modal.Body,{children:ee({noTitle:!0})}),(0,t.jsxs)(n.Modal.Actions,{className:"flex flex-row gap-2 items-center",children:[(0,t.jsx)("p",{className:"text-copy-14",children:et()}),es()]})]})})});function ee(e){let{noTitle:s}=e;return(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsx)(b.ProjectSelector,{description:"Choose which projects should send events to the specified endpoint.",disabled:_||!Q,onProjectTypeUpdated:G,onProjectsUpdated:F,projectType:B,projects:$,title:"Projects"}),(0,t.jsx)(y,{arePermissionsLoading:P.isLoading,canListWebhooks:X,onEventsChange:L,selectedEvents:I,webhookTarget:K,filteredEvents:j,noTitle:s}),(0,t.jsx)(C,{onUrlChanged:O,url:M})]})}function et(){return J?(0,t.jsxs)("span",{children:[Y?"This feature is available with a paid":"This feature is available on the"," ",(0,t.jsx)(u.Link,{external:!0,href:"/pricing",tab:!0,type:"highlight",children:"Pro plan"}),"."]}):Q?"page"===g?(0,t.jsxs)("span",{children:["Learn more about"," ",(0,t.jsx)(u.Link,{external:!0,href:"/docs/integrations#webhooks",type:"highlight",children:"Webhooks"})]}):(0,t.jsx)(n.Modal.Action,{onClick:()=>{k?.()},type:"secondary",children:w??"Back"}):"You need additional permissions to manage Webhooks."}function es(){return"embedded-modal"===g&&(!Q||J)?(0,t.jsx)(n.Modal.Action,{onClick:()=>{v?.()},type:"secondary",children:"Close"}):J?(0,t.jsx)(u.Link,{href:"/pricing",type:"highlight",target:"_blank",children:(0,t.jsx)(l.Button,{size:"small",children:"Upgrade"})}):"embedded-modal"===g?(0,t.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[E?(0,t.jsx)(E,{projects:$,url:M,events:I}):null,(0,t.jsx)(n.Modal.Action,{loading:Z||!H,disabled:!Q,onClick:(0,m.promiseToCallback)(q),children:"Create Webhook"})]}):(0,t.jsx)(l.Button,{loading:Z||!H,disabled:!Q,onClick:(0,m.promiseToCallback)(q),size:"small",typeName:"submit",children:"Create Webhook"})}}],9029673)},2384992,e=>{"use strict";var t,s,l=e.i(7909933),a=e.i(1803156),i=e.i(4426431),r=e.i(8040455),n=e.i(277234),o=e.i(4244280),c=e.i(7917902),d=e.i(1717203),u=e.i(7557283),h=((t={}).Integration="webhook-target-integration",t.Team="webhook-target-team",t),m=((s={}).All="all",s.Selected="selected",s.None="none",s);function x(e,t){let s=e.targets.find(e=>f(e).type===t.type);if(!s)throw Error(`No matching webhook target type found for '${t.type}' in webhook event '${e.name}'`);let{projectScope:l}=f(s);return l===t.projectScope||"none"===l}function f(e){return"string"==typeof e?{type:e,projectScope:"none"}:e}function b(e,t){let s=e.find(e=>{let{name:s}=e;return s===t});if(!s)throw Error(`Cannot find webhook event for name '${t}'`);return s}function p(e){return e.map(e=>{let{name:t}=e;return t})}e.s(["WebhookProjectScope",()=>m,"WebhookTargetType",()=>h,"castWebhookTarget",0,f,"filterWebhookEventNamesByProjectScope",0,function(e,t,s){return t.filter(t=>{let l=e.find(e=>{let{name:s}=e;return s===t});if(!l)throw Error(`Could not find webhook event for webhook event name '${t}'`);return x(l,s)})},"filterWebhookEventsByWebhookTargetType",0,function(e,t){return e.filter(e=>e.targets.some(e=>f(e).type===t))},"formatWebhookEventNamesList",0,function(e,t,s){let l=Object.entries((0,a.default)(s,e=>b(t,e).category)).map(s=>{var l,a,i,n;let[o,c]=s,d=c.map(e=>b(t,e)),u=(l=t,a=o,l.filter(e=>e.category===a));return{groupWebhookEvents:d,category:function(e,t){let s=e.find(e=>{let{name:s}=e;return s===t});if(!s)throw Error(`Cannot find webhook event for name '${t}'`);return s}(e,o),includesAllCategoryEvents:(i=d,n=u,(0,r.default)(p(i).sort(),p(n).sort()))}});return e.length===l.length&&l.every(e=>{let{includesAllCategoryEvents:t}=e;return t})?"All events":(0,i.default)(l,[e=>{let{includesAllCategoryEvents:t}=e;return!t},e=>{let{category:t}=e;return t.label}]).map(e=>{let{category:t,includesAllCategoryEvents:s,groupWebhookEvents:l}=e;return s?`All ${t.label}`:l.map(e=>{let{label:t}=e;return t}).join(", ")}).join(", ")},"isWebhookEventWithinProjectScope",0,x,"useWebhookEvents",0,function(e){let t=(0,c.useAccount)(),{can:s,isLoading:a}=(0,d.default)(),i=!a&&s(u.Action.List,u.Resource.Webhooks);return(0,l.default)(()=>{var s,l;let a;return i?(s=e?.integrationSlug,a=new URLSearchParams((l=t.team?.id)?{teamId:l}:{}),s&&a.set("integrationSlug",s),`${o.API_WEBHOOK_EVENTS}?${a.toString()}`):null},e=>(0,n.fetchAPI)(e,{throwOnHTTPError:!0}),e)}])},3211963,e=>{e.v({webhookEventsError:"webhooks-module__jzy6ma__webhookEventsError",webhookEventsGrid:"webhooks-module__jzy6ma__webhookEventsGrid"})},3870791,e=>{"use strict";var t=e.i(847684),s=e.i(1803156),l=e.i(4426431),a=e.i(7185353),i=e.i(8522580),r=e.i(4030453),n=e.i(2384992),o=e.i(3869281),c=e.i(3671642),d=e.i(5468328),u=e.i(4004502),h=e.i(9722978);function m(e){let{label:s,webhookEvents:l,availableWebhookEvents:a,selectedWebhookEvents:i,onSelectedWebhookEventsChange:r}=e;return(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:[(0,t.jsx)(c.Label,{value:s}),(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial",children:l.map(e=>{let s=!x(a,e),l=s?function(e){if(e.deprecated)return"This event has been deprecated and can no longer be added.";if(!e.enabled)return"This event has been disabled.";let t=e.targets?.map(e=>(0,n.castWebhookTarget)(e)).map(e=>e.projectScope);return t?.includes(n.WebhookProjectScope.None)?null:t?.includes(n.WebhookProjectScope.Selected)&&!t?.includes(n.WebhookProjectScope.All)?"This event is only available when Specific Projects is selected.":t?.includes(n.WebhookProjectScope.All)&&!t?.includes(n.WebhookProjectScope.Selected)?"This event is only available when All Projects is selected.":null}(e):null;return(0,t.jsx)(d.Tooltip,{text:l||"",disableTriggers:!l,children:(0,t.jsx)(o.Checkbox,{checked:x(i,e),"data-testid":(0,u.tid)("account-settings",e.name),disabled:s,onChange:()=>{x(i,e)?r?.(i.filter(t=>{let{name:s}=t;return s!==e.name})):r?.([...i,e])},style:{alignItems:"baseline"},children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial",children:[(0,t.jsx)("p",{className:(0,h.default)("text-copy-14",s?"text-gray-800":void 0),children:e.label}),(0,t.jsx)("p",{className:(0,h.default)("text-label-12-mono",s?"text-gray-800":"text-gray-900"),children:e.name})]})})},e.name)})})]})}function x(e,t){return e.some(e=>{let{name:s}=e;return s===t.name})}var f=e.i(3211963),b=e.i(5255926),p=e.i(562525);function j(e){let{webhookEventCount:s,redacted:l}=e;return(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial",children:[l?(0,t.jsx)(p.RedactedBar,{width:150}):(0,t.jsx)(b.Skeleton,{boxHeight:20,height:16,width:160}),(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial",children:Array(s).fill(0).map((e,s)=>(0,t.jsx)(o.Checkbox,{checked:!1,disabled:!0,onChange:()=>{},style:{alignItems:"start"},children:(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial pt-1",children:l?(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial min-w-[150px]",children:[(0,t.jsx)(p.RedactedBar,{width:150}),(0,t.jsx)(p.RedactedBar,{width:120})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(b.Skeleton,{height:18,width:150}),(0,t.jsx)(b.Skeleton,{height:16,width:120})]})})},s))})]})}function g(e){let{webhookEventCategories:a,webhookEvents:i,availableWebhookEvents:r,selectedWebhookEvents:n,onSelectedWebhookEventsChange:o}=e,c=(0,s.default)(i,e=>e.category),d=(0,l.default)(Object.entries(c),e=>e[1].length).reverse().filter(e=>{let[t,s]=e;return s.length>0});return(0,t.jsx)("div",{className:(d?.length??2)>1?f.default.webhookEventsGrid:"",children:d.map(e=>{let[s,l]=e,i=a.find(e=>{let{name:t}=e;return t===s});return(0,t.jsx)(m,{availableWebhookEvents:r,label:i?.label||"Unknown",onSelectedWebhookEventsChange:o,selectedWebhookEvents:n,webhookEvents:l},s)})})}function v(){return(0,t.jsxs)("div",{className:f.default.webhookEventsGrid,children:[(0,t.jsx)(j,{webhookEventCount:4}),(0,t.jsx)(j,{webhookEventCount:2})]})}function y(){return(0,t.jsx)("div",{className:(0,h.default)("flex flex-col items-center justify-center flex-initial",f.default.webhookEventsError),children:(0,t.jsx)(r.Error,{error:{message:"Unable to load webhook events.",action:"Please contact us",link:"https://vercel.com/contact"}})})}e.s(["WebhookEventsGroupRedacted",0,function(e){let{isLoading:s}=e;return(0,t.jsxs)("div",{className:f.default.webhookEventsGrid,children:[(0,t.jsx)(j,{redacted:!s,webhookEventCount:4}),(0,t.jsx)(j,{redacted:!s,webhookEventCount:2})]})},"WebhookEventsSelector",0,function(e){let{initialWebhookEventNames:s,webhookTarget:l,webhookEventNames:r,onWebhookEventNamesChange:o,filteredEvents:c,integrationSlug:d}=e,{data:u,error:h}=(0,n.useWebhookEvents)({integrationSlug:d}),m=(0,a.useCallback)(e=>{o(e.map(e=>{let{name:t}=e;return t}))},[o]);if(!u)return(0,t.jsx)(v,{});if(h)return(0,t.jsx)(y,{});let x=u.webhookEventCategories,f=u.webhookEvents,b=(0,n.filterWebhookEventsByWebhookTargetType)(f,l.type).filter(e=>!!(!e.enabled&&s.includes(e.name))||e.enabled),p=b.filter(e=>{let{name:t}=e;return r.includes(t)}),j=b.filter(e=>{let{deprecated:t,autoSubscribed:s}=e;return!t&&!s}).filter(e=>!c||!!c(e.name)),k=b.filter(e=>{let{deprecated:t,autoSubscribed:s}=e;return t&&!s}),w=k.length>0&&k.some(e=>s.includes(e.name)),C=b.filter(e=>{let{deprecated:t,autoSubscribed:s}=e;return!t&&s}),N=C.length>0,E=b.filter(e=>!!(0,n.isWebhookEventWithinProjectScope)(e,l)&&(!e.deprecated||!!s.includes(e.name)));return(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-10 flex-initial",children:[(0,t.jsx)(g,{availableWebhookEvents:E,onSelectedWebhookEventsChange:m,selectedWebhookEvents:p,webhookEventCategories:x,webhookEvents:j}),w?(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsx)("h3",{className:"text-heading-16",children:"Deprecated Webhooks"}),(0,t.jsxs)(i.Note,{children:["The following webhooks have been deprecated and can no longer be added, only removed. Please check out the"," ",(0,t.jsx)("a",{href:"https://vercel.com/docs/webhooks#introduction/legacy-event-types",children:"Legacy Event Types documentation"})," ","for information on how to upgrade."]}),(0,t.jsx)(g,{availableWebhookEvents:E,onSelectedWebhookEventsChange:m,selectedWebhookEvents:p,webhookEventCategories:x,webhookEvents:k})]}):null,N?(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsx)("h3",{className:"text-heading-16",children:"Automatically Subscribed Webhooks"}),(0,t.jsx)(i.Note,{children:"The following webhooks are subscribed automatically and cannot be disabled."}),(0,t.jsx)(g,{availableWebhookEvents:[],selectedWebhookEvents:C,webhookEventCategories:x,webhookEvents:C})]}):null]})}],3870791)},2854814,e=>{"use strict";var t=e.i(7185353),s=e.i(7909933),l=e.i(8042625),a=e.i(277234),i=e.i(4244280),r=e.i(5338940);e.s(["useActiveBudget",0,function(){let{teamOverride:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{team:n}=(0,r.useTeam)(),o=e||n,c=(0,s.default)(()=>{var e;return o?.id?(e=o.id,`${i.API_BUDGETS}${(0,l.encode)({teamId:e})}`):null},e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),{refreshInterval:()=>1e3*(window.localStorage?.getItem("budgetPolling")==="true")}),d=window.localStorage?.getItem("budgetPolling")==="true",u=(c.data?.data?.length??0)>0,h=c.isLoading||!u&&d;return(0,t.useEffect)(()=>{u&&d&&window.localStorage?.removeItem("budgetPolling")},[u,d]),{...c,activeBudget:c.data?.data[0],mutate:c.mutate,isLoading:h}}])},509783,e=>{"use strict";let t=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M5.8349 3.24994C5.14454 4.44567 5.55423 5.97464 6.74996 6.665L7.39465 7.03721L7.02726 7.68466L5.14599 11C5.21289 11.1531 5.25 11.3222 5.25 11.5C5.25 12.1904 4.69036 12.75 4 12.75C3.30964 12.75 2.75 12.1904 2.75 11.5C2.75 10.8634 3.22584 10.338 3.84123 10.26L5.38944 7.5316C3.95909 6.30274 3.55857 4.19264 4.53586 2.49994C5.64043 0.586765 8.08679 -0.0687357 9.99996 1.03583C11.836 2.09584 12.5137 4.39156 11.5892 6.26591L10.4949 4.33754C10.4418 3.53274 10.0009 2.76843 9.24996 2.33487C8.05423 1.64452 6.52525 2.0542 5.8349 3.24994ZM9.146 4.99996C9.21289 4.84686 9.25 4.67776 9.25 4.5C9.25 3.80964 8.69036 3.25 8 3.25C7.30964 3.25 6.75 3.80964 6.75 4.5C6.75 5.13659 7.22586 5.66203 7.84127 5.74002L9.72266 9.05556L10.0956 9.71274L10.75 9.33493C11.9457 8.64458 13.4747 9.05427 14.165 10.25C14.8554 11.4457 14.4457 12.9747 13.25 13.6651C12.5047 14.0953 11.63 14.0983 10.9096 13.75H8.69252C9.85895 15.4685 12.1727 16.0191 14 14.9641C15.9131 13.8595 16.5686 11.4132 15.4641 9.5C14.4886 7.81038 12.4665 7.10169 10.6895 7.71998L9.146 4.99996ZM13.25 11.5C13.25 12.1904 12.6904 12.75 12 12.75C11.591 12.75 11.228 12.5536 10.9999 12.25H7.9298C7.57875 14.1006 5.95279 15.5 4 15.5C1.79086 15.5 0 13.7091 0 11.5C0 9.40018 1.61801 7.67826 3.67529 7.51299L2.58098 9.44147C1.92792 9.89251 1.5 10.6463 1.5 11.5C1.5 12.8807 2.61929 14 4 14C5.38071 14 6.5 12.8807 6.5 11.5V10.75H7.25H10.9999C11.228 10.4464 11.591 10.25 12 10.25C12.6904 10.25 13.25 10.8096 13.25 11.5Z" fill="currentColor"/>');e.s(["Webhook",0,t])},3807412,e=>{"use strict";var t=e.i(7909933),s=e.i(8042625),l=e.i(277234),a=e.i(4244280),i=e.i(5338940),r=e.i(1717203),n=e.i(7557283),o=e.i(2854814);e.s(["useBudgetWebhookUrl",0,()=>{let{isReady:e,team:r}=(0,i.useTeam)(),{activeBudget:n}=(0,o.useActiveBudget)(),c=(0,t.default)(()=>e&&n?.webhookId?`${a.API_WEBHOOKS}/${n.webhookId}/${(0,s.encode)({teamId:r?.id})}`:null,e=>(0,l.fetchAPI)(e,{throwOnHTTPError:!0}));return{...c,webhookUrl:c.data?.url??void 0}},"useWebhooks",0,function(e){let{isReady:o,team:c}=(0,i.useTeam)(),{can:d,isLoading:u}=(0,r.default)(),h={list:d(n.Action.List,n.Resource.Webhooks),create:d(n.Action.Create,n.Resource.Webhooks),remove:d(n.Action.Delete,n.Resource.Webhooks),isLoading:u},m=(0,t.default)(()=>{var t,s;let l;return o&&!h.isLoading&&h.list&&e?.enabled?(t=c?.id,s=e.projectId,(l=new URLSearchParams).set("limit","20"),l.set("includes[]","project"),t&&l.set("teamId",t),s&&l.set("projectId",s),`${a.API_WEBHOOKS}?${l.toString()}`):null},e=>(0,l.fetchAPI)(e,{throwOnHTTPError:!0}),e),x=async e=>{let{id:t,teamId:i}=e,r=await (0,l.fetchAPI)(`${a.API_WEBHOOKS}/${t}${(0,s.encode)({teamId:i})}`,{method:"DELETE",throwOnHTTPError:!0,returnStatus:!0});return await m.mutate(),r},f=async e=>{let{events:t,projectIds:i,teamId:r,url:n}=e,o=await (0,l.fetchAPI)(`${a.API_WEBHOOKS}${(0,s.encode)({teamId:r})}`,{method:"POST",throwOnHTTPError:!0,body:{events:t,projectIds:i,url:n}});return await m.mutate(),o};return{...m,deleteWebhook:x,createWebhook:f,permissions:h}}])},815619,e=>{e.v({"code-wrapper":"form-add-webhooks-modal-module__KmZ2yW__code-wrapper",dropdown:"form-add-webhooks-modal-module__KmZ2yW__dropdown","modal-main":"form-add-webhooks-modal-module__KmZ2yW__modal-main","modal-title":"form-add-webhooks-modal-module__KmZ2yW__modal-title",secret:"form-add-webhooks-modal-module__KmZ2yW__secret","secret-warn":"form-add-webhooks-modal-module__KmZ2yW__secret-warn","secret-warn-text":"form-add-webhooks-modal-module__KmZ2yW__secret-warn-text","secret-wrapper":"form-add-webhooks-modal-module__KmZ2yW__secret-wrapper"})},6872861,e=>{"use strict";var t=e.i(847684),s=e.i(7185353),l=e.i(762945),a=e.i(2560270),i=e.i(7807066),r=e.i(6891161),n=e.i(4004502),o=e.i(7808943),c=e.i(3408876),d=e.i(2844165),u=e.i(57106);function h(){return(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-copy-14 text-gray-900",children:"Learn more about "}),(0,t.jsx)(u.Link,{external:!0,href:"/docs/integrations/webhooks-overview/webhooks-api#securing-webhooks",type:"secondary",children:"Securing Webhooks"})]})}var m=e.i(815619),x=e.i(9722978);e.s(["FormAddWebhookModal",0,function(e){let{webhook:u,onClose:f,view:b="page"}=e,[p,j]=(0,s.useState)(!1);if("embedded-modal"===b)return u?g():null;return(0,t.jsx)(r.Modal.Modal,{active:!!u,onClickOutside:f,sticky:!0,width:"32rem",children:g()});function g(){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(r.Modal.Body,{children:[(0,t.jsx)(r.Modal.Header,{children:(0,t.jsx)(r.Modal.Title,{children:"Webhook Created"})}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",children:"Make sure to secure all webhook requests."}),(0,t.jsxs)("p",{className:"text-copy-14",children:["Confirm authenticity by comparing the"," ",(0,t.jsx)(o.default,{children:"x-vercel-signature"})," request header to a dynamically generated SHA based on:"]})]}),(0,t.jsxs)("div",{className:(0,x.default)("flex flex-row items-center justify-between gap-1 flex-initial",m.default["secret-wrapper"]),children:[(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-start flex-initial",children:[(0,t.jsx)("p",{className:"text-copy-14",children:"Secret:"}),(0,t.jsx)("p",{className:`text-copy-14 text-pink-900 ${m.default.secret}`,"data-testid":(0,n.tid)("webhooks","secret"),children:u?.secret})]}),(0,t.jsx)(c.default,{label:"Copy code",textToCopy:u?.secret??"",type:"tertiary"})]}),(0,t.jsxs)("div",{className:(0,x.default)("flex flex-row items-center justify-start gap-3 flex-initial",m.default["secret-warn"]),children:[(0,t.jsx)(l.Warning,{}),(0,t.jsx)("p",{className:`text-copy-14 ${m.default["secret-warn-text"]}`,children:"This secret will not be shown again"})]}),(0,t.jsxs)("button",{type:"button",onClick:()=>j(!p),className:(0,x.default)("flex flex-row items-center justify-start gap-1 flex-initial",m.default.dropdown),children:[p?(0,t.jsx)(a.ChevronDown,{size:20}):(0,t.jsx)(i.ChevronRight,{size:20}),(0,t.jsx)("span",{children:"How to verify request headers"})]}),p?(0,t.jsx)("div",{className:m.default["code-wrapper"],children:(0,t.jsx)(d.CodeHighlight,{highlightedLinesNumbers:void 0,language:"javascript",children:`const crypto = require('crypto');

async function verifySignature(req) {
  const payload = await req.text();
  const signature = crypto
    .createHmac('sha1', process.env.WEBHOOK_SECRET)
    .update(payload)
    .digest('hex');
  return signature === req.headers['x-vercel-signature'];
}`})}):null,(0,t.jsx)(h,{})]})]}),(0,t.jsx)(r.Modal.Actions,{children:(0,t.jsx)(r.Modal.Action,{fullWidth:!0,onClick:f,children:"Done"})})]})}}],6872861)},5648459,e=>{"use strict";var t=e.i(847684),s=e.i(9029673),l=e.i(2384992),a=e.i(6891161),i=e.i(3691744),r=e.i(8646915);function n(e){let{url:s,events:l,projects:a}=e,n=(0,r.mapWebhookEventToO11yAlertType)(l[0]);return(0,t.jsx)(i.TestNotification,{channel:"webhook",label:"Test Webhook",projectId:a[0]?.id,type:n&&"all"!==n?n:"usage_anomaly",url:s})}e.s(["WebhooksModal",0,function(e){let{webhookEventName:i,active:o,onClose:c}=e,{data:d}=(0,l.useWebhookEvents)(),{isWebhookEnabled:u}=(0,r.useAlertsFlags)(),h=d?.webhookEvents.filter(e=>!i||e.category===i);return h?.length?(0,t.jsx)(a.Modal.Modal,{active:o,onClickOutside:()=>{c()},children:(0,t.jsx)(s.AddWebhooks,{ModalAction:n,filteredEvents:u,backButtonLabel:"Close",onBack:c,onClose:c,preselectedEvents:["alerts.triggered"],view:"embedded-modal"})}):null}])},4989119,e=>{"use strict";e.s(["FIREWALL_ALERT_TYPES",0,["botId_anomaly","firewallSystemRule_anomaly","firewallCustomRule_anomaly"],"OBSERVABILITY_ALERT_TYPES",0,["usage_anomaly","error_anomaly","testAlert_anomaly","buildTime_anomaly"]])},3691744,e=>{"use strict";var t=e.i(847684),s=e.i(6891161),l=e.i(455575),a=e.i(7185353),i=e.i(9979783),r=e.i(5338940),n=e.i(6060673),o=e.i(1138941);e.s(["TestNotification",0,function(e){let{channel:c,projectId:d,type:u,url:h,label:m,ruleId:x}=e,{team:f}=(0,r.useTeam)(),b=(0,l.useToasts)(),[p,j]=(0,a.useTransition)(),{data:g}=(0,n.useTeamProjects)(),v=(0,o.useProjectIdOrName)();return d||(d=v?g?.find(e=>e.name===v)?.id:g?.[0]?.id),(0,t.jsx)(s.Modal.Action,{disabled:!f||"webhook"===c&&!h||!u||!d,loading:p,onClick:()=>j(async()=>{let e={teamId:f?.id??"",projectId:d??"",type:u??"usage_anomaly",channel:c,ruleId:x};try{let t=await (0,i.typedFetch)("/alerts/v2/publish-event","post",{teamId:f?.id},"webhook"===c?{...e,url:h}:e);429===t.status?b.error("Please retry in 10 seconds"):200===t.status?b.success("Notification sent"):b.error("Unable to send the notification")}catch{b.error("Unable to send the notification")}}),type:"secondary",children:m||"Test Notification"})}])},1894968,e=>{"use strict";var t=e.i(7909933),s=e.i(5757634),l=e.i(9171423),a=e.i(9668517),i=e.i(5338940),r=e.i(706035);let n=(0,r.createServerReference)("404d8304d297d815cb6498256f216c06f172258b83",r.callServer,void 0,r.findSourceMapURL,"getSlackSubscriptions");e.s(["useAlertRules",0,function(){let e=function(){let{mutate:e}=(0,s.useSWRConfig)(),t=(0,a.useTeamSlug)();return{deleteAlertRule:async s=>{t&&(await (0,l.fetchApi)(`/api/alerts/v2/alert-rules/${s}?teamId=${t}`,{method:"DELETE",throwOnHTTPError:!0}),await e(`alert-rules-${t}`))},createAlertRule:async s=>{t&&(await (0,l.fetchApi)(`/api/alerts/v2/alert-rules?teamId=${t}`,{method:"POST",body:JSON.stringify({...s,alertTypes:s.alertTypes??void 0,projectId:s.projectId??void 0}),throwOnHTTPError:!0}),await e(`alert-rules-${t}`))},updateAlertRule:async(s,a)=>{if(!t)return;let i=Object.keys(a).reduce((e,t)=>{let s=a[t];return{...e,[t]:s??null}},{});await (0,l.fetchApi)(`/api/alerts/v2/alert-rules/${s}?teamId=${t}`,{method:"PATCH",body:JSON.stringify(i),throwOnHTTPError:!0}),await e(`alert-rules-${t}`)}}}(),r=(0,a.useTeamSlug)(),o=function(){let{team:e}=(0,i.useTeam)();return(0,t.default)(()=>e?`alert-slack-subscriptions-${e.id}`:null,async()=>{if(e?.id)return n(e.id)})}(),c=(0,t.default)(()=>r?`alert-rules-${r}`:null,async()=>{if(!r)return;let e=await (0,l.fetchApi)(`/api/alerts/v2/alert-rules?teamId=${r}`,{method:"GET",throwOnHTTPError:!0});return e&&"string"!=typeof e?e:[]});return{...e,...c,data:c.data?c.data.map(e=>({...e,slackChannels:o.data?.filter(t=>t.alertRules?.includes(e.id)||!t.alertRules&&"ar_default"===e.id).map(e=>e.channelName)??[]})):void 0}}],1894968)},1513950,e=>{"use strict";var t=e.i(5338940),s=e.i(277234),l=e.i(7909933),a=e.i(7185353),i=e.i(455575),r=e.i(134877);function n(e){return"in_app_feed"===e?"in-app":e}e.s(["AlertChannelTypeLabels",0,{"in-app":"Inbox",email:"Email",push:"Push"},"useAlertsNotificationPreferences",0,function(){let{team:e}=(0,t.useTeam)(),o=(0,i.useToasts)(),[c,d]=(0,a.useTransition)(),u=(0,l.default)(e?`/alerts/v2/notifications?teamId=${e?.id}`:null,async e=>await (0,s.fetchAPI)(e,{throwOnHTTPError:!0}));return{...u,upsertPreference:t=>new Promise(l=>{d(async()=>{try{await (0,s.fetchAPI)(`/alerts/v2/notifications?teamId=${e?.id}`,{method:"PATCH",body:{...t,channel:n(t.channel)},throwOnHTTPError:!0}),await u.mutate()}catch(e){(0,r.isAPIError)(e)&&"forbidden-role"===e.code?o.error("Your role does not have permission to subscribe to Alert notifications."):o.error("An error occurred while updating the Alert notification preferences.")}finally{l()}})}),isPending:c,isSubscribedToAlertType:(e,t)=>u.data?.preferences.find(s=>s.type===e&&s.channel===n(t))?.status==="enabled",isSubscribedToAlertRule:(e,t)=>u.data?.rulePreferences.find(s=>s.ruleId===e&&s.channel===n(t))?.status==="enabled",maybeProjectAdmin:t=>!u.data?.preferences.find(e=>e.type===t)&&u.data?.autosubscribeOwnersInKnock&&(e?.membership?.role==="CONTRIBUTOR"||e?.membership?.role==="DEVELOPER")}}])},4577559,2402473,e=>{"use strict";let t=(0,e.i(9334638).withNewIcon)(`<g clip-path="url(#clip0_872_3152)">
  <path d="M3.42681 10.0787C3.42681 10.9984 2.68351 11.7417 1.76382 11.7417C0.844137 11.7417 0.10083 10.9984 0.10083 10.0787C0.10083 9.15906 0.844137 8.41575 1.76382 8.41575H3.42681V10.0787ZM4.25831 10.0787C4.25831 9.15906 5.00162 8.41575 5.9213 8.41575C6.84099 8.41575 7.58429 9.15906 7.58429 10.0787V14.2362C7.58429 15.1559 6.84099 15.8992 5.9213 15.8992C5.00162 15.8992 4.25831 15.1559 4.25831 14.2362V10.0787Z" fill="#E01E5A"/>
  <path d="M5.92121 3.40158C5.00152 3.40158 4.25821 2.65827 4.25821 1.73858C4.25821 0.818899 5.00152 0.075592 5.92121 0.075592C6.84089 0.075592 7.5842 0.818899 7.5842 1.73858V3.40158H5.92121ZM5.92121 4.24567C6.84089 4.24567 7.5842 4.98898 7.5842 5.90866C7.5842 6.82835 6.84089 7.57165 5.92121 7.57165H1.75113C0.831442 7.57165 0.0881348 6.82835 0.0881348 5.90866C0.0881348 4.98898 0.831442 4.24567 1.75113 4.24567H5.92121Z" fill="#36C5F0"/>
  <path d="M12.5858 5.90866C12.5858 4.98898 13.3291 4.24567 14.2488 4.24567C15.1685 4.24567 15.9118 4.98898 15.9118 5.90866C15.9118 6.82835 15.1685 7.57165 14.2488 7.57165H12.5858V5.90866ZM11.7543 5.90866C11.7543 6.82835 11.011 7.57165 10.0913 7.57165C9.17165 7.57165 8.42834 6.82835 8.42834 5.90866V1.73858C8.42834 0.818899 9.17165 0.075592 10.0913 0.075592C11.011 0.075592 11.7543 0.818899 11.7543 1.73858V5.90866Z" fill="#2EB67D"/>
  <path d="M10.0913 12.5732C11.011 12.5732 11.7543 13.3165 11.7543 14.2362C11.7543 15.1559 11.011 15.8992 10.0913 15.8992C9.17165 15.8992 8.42834 15.1559 8.42834 14.2362V12.5732H10.0913ZM10.0913 11.7417C9.17165 11.7417 8.42834 10.9984 8.42834 10.0787C8.42834 9.15906 9.17165 8.41575 10.0913 8.41575H14.2614C15.1811 8.41575 15.9244 9.15906 15.9244 10.0787C15.9244 10.9984 15.1811 11.7417 14.2614 11.7417H10.0913Z" fill="#ECB22E"/>
  </g>
  <defs>
  <clipPath id="clip0_872_3152">
  <rect width="16" height="16" fill="white"/>
  </clipPath>
  </defs>`);e.s(["LogoSlackColor",0,t],4577559);var s=e.i(847684),l=e.i(5338940),a=e.i(6143247);function i(e){let{start:t=0,children:l}=e;return(0,s.jsx)("ol",{className:"flex flex-col gap-6 p-0 [counter-reset:steps_var(--start)]",start:t,style:{"--start":void 0!==t?t:1},children:l})}function r(e){let{title:t,children:l}=e;return(0,s.jsxs)("li",{className:(0,a.cn)("relative flex flex-col gap-3 p-0","[counter-increment:steps_1] pl-9","after:content last:after:content-none","after:absolute after:-bottom-5 after:left-3 after:top-7 after:w-px after:-translate-x-1/2","after:bg-[repeating-linear-gradient(to_bottom,var(--ds-gray-400)_0px,var(--ds-gray-400)_4px,transparent_4px,transparent_8px)]"),children:[(0,s.jsx)("span",{className:(0,a.cn)("text-copy-16 font-medium","flex items-center -translate-x-9","before:flex before:items-center before:justify-center before:rounded-full before:h-6 before:w-6 before:bg-gray-1000","before:!text-background-100 before:text-label-13 before:font-bold before:content-[counter(steps)] before:mr-3"),children:t}),l]})}var n=e.i(4065455),o=e.i(1017032),c=e.i(7743427),d=e.i(5838627),u=e.i(6891161),h=e.i(5255926),m=e.i(7185353),x=e.i(3691744);let f="!m-0 [&_code]:inline-block [&_pre]:!py-3 [&_pre]:overflow-none [&_.line]:text-wrap [&_.line]:px-3 [&_button]:!top-1.5 [&_button]:!right-1.5";function b(e){let{team:l,onClose:a,ruleId:n,slackChannels:o}=e,c=n?"this alert rule":"alerts";return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"py-5 px-6 flex flex-col gap-2 border-0 border-b border-gray-200",children:[(0,s.jsxs)(u.Modal.Title,{className:"flex items-center gap-2",children:[(0,s.jsx)(t,{size:24})," Subscribe with Slack"]}),(0,s.jsxs)(u.Modal.Subtitle,{children:["Follow these steps to subscribe to ",c," in Slack:"]})]}),(0,s.jsx)(u.Modal.Body,{children:(0,s.jsxs)("div",{className:"flex flex-col gap-5",children:[o?.length?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"-mx-2 p-5 pt-5 bg-background-200 rounded border",children:[(0,s.jsx)("p",{className:"text-label-14 font-medium",children:"Channels subscribed to this rule:"}),o?.map(e=>(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)("span",{className:"text-gray-900",children:["#",e]})},e))]}),(0,s.jsx)("div",{className:"text-label-14 font-medium text-gray-900",children:"Subscribe to this rule in another channel"})]}):null,(0,s.jsxs)(i,{children:[(0,s.jsxs)(r,{title:"Add the Vercel bot to a channel",children:[(0,s.jsx)("span",{children:"Use the following command to add the Vercel put to a Slack channel where you want to receive alerts"}),(0,s.jsx)(d.CodeBlock,{language:"bash",hideLineNumbers:!0,className:f,children:"/invite @Vercel"})]}),(0,s.jsxs)(r,{title:`Subscribe to ${c}`,children:[(0,s.jsxs)("span",{children:["Type this command to subscribe to ",c]}),(0,s.jsx)(d.CodeBlock,{language:"bash",hideLineNumbers:!0,className:f,children:`/vercel subscribe ${l?.id} alerts${n?` +rule:${n}`:""}`})]})]})]})}),(0,s.jsxs)(u.Modal.Actions,{className:"flex flex-row gap-2 items-center",children:[(0,s.jsx)("span",{}),(0,s.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,s.jsx)(x.TestNotification,{channel:"slack",type:"usage_anomaly",ruleId:n}),(0,s.jsx)(u.Modal.Action,{onClick:a,type:"secondary",children:"Close"})]})]})]})}e.s(["SlackModal",0,function(e){let{active:t,onClose:a,ruleId:i,slackChannels:r}=e,{team:d}=(0,l.useTeam)(),{integration:x,isLoading:f}=(0,c.useIntegration)("slack"),{data:p,isLoading:j}=(0,o.useConfigurations)({skip:!x,integrationId:x?.id,skipBillingData:!0}),g=f||j,[v,y]=(0,m.useState)(!1);return(0,m.useEffect)(()=>{p?.length&&!g&&y(!0)},[p,g]),(0,s.jsxs)(u.Modal.Modal,{active:t,onClickOutside:()=>{a()},children:[g&&(0,s.jsx)(h.Skeleton,{className:"h-10 w-full"}),!v&&!g&&x&&(0,s.jsx)(n.InstallExternalIntegrationModal,{account:d,backButtonLabel:"Close",integration:x,isOwnedByVercel:!0,onAnimationDone:()=>y(!0),onBack:a,onSuccessfulInstall:()=>y(!0),teamSlugOrPublic:{teamSlug:d?.slug??""},view:"embedded-modal"}),v&&(0,s.jsx)(b,{onClose:a,team:d,ruleId:i,slackChannels:r})]})}],2402473)},8264347,6753472,e=>{"use strict";var t=e.i(847684),s=e.i(7185353),l=e.i(1717203),a=e.i(6933680),i=e.i(4496450),r=e.i(7114658),n=e.i(8646915);let o={Usage:6,Team:5,Deployments:4,Domains:3,Integrations:2,"Edge Config":1};function c(e){let{team:t}=e,{isLoading:c,hasObservabilityPlus:d}=(0,r.useObservabilityPlusForProjects)(),{can:u,isLoading:h}=(0,l.default)({teamId:t.id}),{isNotificationEnabled:m}=(0,n.useAlertsFlags)(),x=t.billing?.plan==="pro",f=(0,s.useMemo)(()=>(0,a.createNotificationsView)(u,{team:t,showTestButton:!1,usageItemDetails:x,showMonitoring:t.enabledInvoiceItems?.monitoring?.enabled??!1,isLogDrainsGaEnabled:!!t.enabledInvoiceItems?.logDrainsUsage,isSpendManagementEnabled:x,isEntUnbundledPricingEnabled:!!(t.billing?.plan==="enterprise"&&(0,i.isOnUnbundledPricingPlan)(t)),isUnbundledPricingEnabled:(0,i.isOnUnbundledPricingPlan)(t),alertsEnabled:d,isAlertNotificationEnabled:m}).sort((e,t)=>o[t.name]-o[e.name]),[u,t,x,d,m]);return{isLoading:h||c,preferenceItems:f}}e.s(["usePreferenceItems",0,c],6753472);var d=e.i(5255926),u=e.i(4597921),h=e.i(1894968),m=e.i(3869281),x=e.i(5601342),f=e.i(1513950),b=e.i(3063078);function p(e){let{team:s,isWebPushNotificationsEnabled:l}=e,{preferenceItems:a}=c({team:s}),i=a?.find(e=>"Alerts"===e.name);return(0,t.jsx)(g,{isLoading:!i,isWebPushNotificationsEnabled:l,children:i?.groups.map(e=>(0,t.jsx)(v,{name:e.name,teamId:s.id,alertType:e.preferenceNotificationId,isWebPushNotificationsEnabled:l},e.name))})}function j(e){let{team:s,isWebPushNotificationsEnabled:l}=e,{data:a}=(0,h.useAlertRules)();return(0,t.jsx)(g,{isLoading:!a,isWebPushNotificationsEnabled:l,children:a?.map(e=>(0,t.jsx)(v,{name:e.name,teamId:s.id,ruleId:e.id,isWebPushNotificationsEnabled:l},e.id))})}function g(e){let{children:s,isLoading:l,isWebPushNotificationsEnabled:a}=e;return(0,t.jsxs)("table",{className:"table-fixed text-left text-label-16",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-0 border-b border-gray-200",children:[(0,t.jsx)("th",{className:"w-full font-semibold text-label-16 py-3 text-label-14",children:"Anomaly Alerts"}),a?(0,t.jsx)("th",{className:"min-w-12 font-medium text-center text-label-14 px-2",children:"Push"}):null,(0,t.jsx)("th",{className:"min-w-12 font-medium text-center text-label-14 px-2",children:"Email"}),(0,t.jsx)("th",{className:"min-w-12 font-medium text-center text-label-14 px-2",children:"Web"})]})}),(0,t.jsx)("tbody",{children:l?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v,{ruleId:"ar_123",name:(0,t.jsx)(d.Skeleton,{width:100,height:20}),isWebPushNotificationsEnabled:a}),(0,t.jsx)(v,{ruleId:"ar_456",name:(0,t.jsx)(d.Skeleton,{width:150,height:20}),isWebPushNotificationsEnabled:a})]}):s})]})}function v(e){let{teamId:s="teamId",name:l,isWebPushNotificationsEnabled:a,...i}=e;return(0,t.jsxs)("tr",{className:"border-0 border-b border-gray-200",children:[(0,t.jsx)("td",{className:"py-3 text-label-14",children:l}),a?(0,t.jsx)("td",{children:(0,t.jsx)(y,{className:"flex items-center justify-center p-0",channel:"push",teamId:s,...i})}):null,(0,t.jsx)("td",{children:(0,t.jsx)(y,{className:"flex items-center justify-center p-0",channel:"email",teamId:s,...i})}),(0,t.jsx)("td",{children:(0,t.jsx)(y,{className:"flex items-center justify-center p-0",channel:"in_app_feed",teamId:s,...i})})]})}function y(e){let{channel:s,teamId:l,onChange:a,...i}=e,r=(0,u.useServerFlag)("enable-alert-rules",!1)&&"ruleId"in i,n=(0,x.usePreferences)(),{subscriptions:o}=(0,b.usePushNotifications)(),c=o.length>0,{upsertPreference:d,isSubscribedToAlertRule:h,isSubscribedToAlertType:p,isPending:j}=(0,f.useAlertsNotificationPreferences)(),g=r?h(i.ruleId,s):p(i.alertType,s),v=!n.isChannelEnabled(s)||"push"===s&&!c;return(0,t.jsx)(m.Checkbox,{checked:g,disabled:v||j,onChange:function(e){d({type:r?void 0:i.alertType,ruleId:r?i.ruleId:void 0,channel:s,status:g?"disabled":"enabled"}),a?.(e)},...i})}e.s(["AlertNotifications",0,function(e){let{team:s}=e,l=(0,u.useServerFlag)("enable-alert-rules",!1),a=(0,u.useServerFlag)("enable-web-push-notifications",!1);return s?l?(0,t.jsx)(j,{team:s,isWebPushNotificationsEnabled:a}):(0,t.jsx)(p,{team:s,isWebPushNotificationsEnabled:a}):(0,t.jsx)(g,{isLoading:!0,isWebPushNotificationsEnabled:a})}],8264347)},2423133,e=>{"use strict";var t=e.i(847684),s=e.i(8761240);function l(){return(0,t.jsxs)("div",{className:"flex items-center justify-center border rounded min-h-[240px]  flex-col gap-2 bg-white",children:[(0,t.jsx)("div",{className:"size-12 flex items-center justify-center rounded-md border bg-white text-gray-900",children:(0,t.jsx)(s.CheckCircleFill,{className:"size-4"})}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-gray-1000 font-medium flex-col p-2",children:[(0,t.jsx)("span",{children:"No anomalies detected"}),(0,t.jsx)("p",{className:"text-gray-800 text-center",children:"You will see alerts when usage anomalies or error spikes are detected."})]})]})}var a=e.i(992159),i=e.i(1894968);function r(e){let{filterType:s,rule:l}=e,{data:r}=(0,i.useAlertRules)(),n=r?.find(e=>e.id===l)?.name;return(0,t.jsxs)("div",{className:"flex items-center justify-center border rounded min-h-[240px] flex-col gap-2 bg-background-200",children:[(0,t.jsx)("div",{className:"size-10 flex items-center justify-center rounded-md border bg-background-100 text-gray-900",children:(0,t.jsx)(a.Filter,{className:"size-4"})}),(0,t.jsx)("div",{className:"flex items-center gap-2 text-gray-1000 font-medium",children:"all"!==s?(0,t.jsxs)("span",{children:["No ","usage_anomaly"===s?"usage":"error_anomaly"===s?"error":""," alerts found"]}):n?(0,t.jsxs)("span",{children:["No alerts found for rule ",n??""]}):(0,t.jsx)("span",{children:"No alerts found"})})]})}var n=e.i(7432042),o=e.i(8238875),c=e.i(7185353),d=e.i(2504781),u=e.i(8674454),h=e.i(6694387),m=e.i(4991687),x=e.i(5232300),f=e.i(4577559),b=e.i(509783),p=e.i(5601342),j=e.i(9095583),g=e.i(57106),v=e.i(5338940),y=e.i(5140444),k=e.i(6891161),w=e.i(5255926),C=e.i(9523111),N=e.i(3691744),E=e.i(4670733),T=e.i(8264347);function S(e){let{active:s,onClose:l}=e,{team:a}=(0,v.useTeam)();return(0,t.jsxs)(k.Modal.Modal,{active:s,onClickOutside:()=>{l()},children:[(0,t.jsxs)("div",{className:"py-5 px-6 flex flex-col gap-2 border-0 border-b border-gray-200",children:[(0,t.jsxs)(k.Modal.Title,{className:"flex items-center gap-2",children:[(0,t.jsx)(C.Email,{color:"gray-700",size:24})," Vercel Notifications"]}),(0,t.jsx)(k.Modal.Subtitle,{children:"Configure how you want to receive alerts."})]}),(0,t.jsx)(k.Modal.Body,{children:(0,t.jsx)(p.PreferencesProvider,{defaultLoaded:!1,fallback:(0,t.jsx)(A,{team:a}),children:(0,t.jsx)(A,{team:a})})}),(0,t.jsxs)(k.Modal.Actions,{className:"flex flex-row gap-2 items-center",children:[(0,t.jsx)("span",{}),(0,t.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,t.jsx)(N.TestNotification,{channel:"knock",type:"usage_anomaly"}),(0,t.jsx)(k.Modal.Action,{onClick:l,type:"secondary",children:"Close"})]})]})]})}function A(e){let{team:s}=e,{data:l}=(0,j.useEmailNotifications)(),{value:a}=(0,E.useEmailNotificationRulesFlag)(),i=!l&&a,{user:r}=(0,y.useUser)();return(0,t.jsxs)("div",{className:"flex flex-col px-1 gap-4",children:[(0,t.jsx)(T.AlertNotifications,{team:s}),(0,t.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,t.jsxs)("span",{children:["Email notifications are sent to"," ",i||!r?(0,t.jsx)(w.Skeleton,{className:"inline-block -mb-1.5",width:150,height:20}):(0,t.jsx)("span",{className:"font-medium",children:(s?l?.rules[s.id]?.email:null)??r.email})]}),(0,t.jsxs)("span",{className:"text-gray-900",children:["Configure in"," ",(0,t.jsx)(g.Link,{className:"text-blue-700",href:`/${s?.slug}/~/settings/notifications`,underline:!0,external:!0,children:"My Notifications"})]})]})]})}var P=e.i(2402473),W=e.i(5648459);function _(e){let{children:s,webhookEventName:l}=e,[a,i]=(0,c.useState)(!1),[r,n]=(0,c.useState)(!1),[o,d]=(0,c.useState)(!1);return(0,t.jsxs)(m.MenuContainer,{position:"bottom-end",children:[(0,t.jsx)(h.MenuButton,{type:"secondary",children:s}),(0,t.jsx)(u.Menu,{width:"auto",children:(0,t.jsx)(I,{webhookEventName:l,onOpenNotifications:()=>i(!0),onOpenSlack:()=>n(!0),onOpenWebhooks:()=>d(!0)})}),(0,t.jsx)(S,{active:a,onClose:()=>i(!1)}),(0,t.jsx)(P.SlackModal,{active:r,onClose:()=>n(!1)}),l?(0,t.jsx)(W.WebhooksModal,{active:o,onClose:()=>d(!1),webhookEventName:l}):null]})}function I(e){let{webhookEventName:s,onOpenSlack:l,onOpenWebhooks:a,onOpenNotifications:i}=e,{actions:{setOpen:r}}=(0,x.useMenu)();return(0,t.jsxs)("div",{className:"flex flex-col divide-solid divide-y -m-2",children:[(0,t.jsxs)("div",{className:"flex px-4 py-5 gap-2",children:[(0,t.jsxs)("div",{className:"flex-1 flex flex-col w-48 gap-1",children:[(0,t.jsx)("span",{className:"text-label-14 font-medium",children:"Vercel Notifications"}),(0,t.jsx)("span",{className:"text-label-13 text-sm text-gray-900",children:"Dashboard, Email"})]}),(0,t.jsx)(d.Button,{typeName:"button",type:"secondary",onClick:()=>{r(!1),i()},children:"Manage"})]}),(0,t.jsxs)("div",{className:"flex gap-2 p-3 items-center",children:[(0,t.jsx)(d.Button,{typeName:"button",type:"secondary",className:"flex-1",onClick:()=>{r(!1),l()},prefix:(0,t.jsx)(f.LogoSlackColor,{}),children:"Slack"}),s?(0,t.jsx)(d.Button,{typeName:"button",type:"secondary",className:"flex-1",onClick:()=>{r(!1),a()},prefix:(0,t.jsx)(b.Webhook,{}),children:"Webhook"}):null]})]})}var L=e.i(6881349),M=e.i(8923565),O=e.i(409142);let B={alertType:{defaultValue:"all"},rule:{defaultValue:"all"}};function R(){return(0,O.useSearchParamsState)(B)}var $=e.i(4597921),F=e.i(9668517),H=e.i(8646915),U=e.i(4989119);function D(){let{state:e,set:s}=R(),l=(0,$.useServerFlag)("enable-alert-rules",!1),{data:a}=(0,i.useAlertRules)(),r=(0,F.useTeamSlug)(),{isAlertTypeEnabled:n}=(0,H.useAlertsFlags)(),o=(0,c.useMemo)(()=>l&&a&&!(a.length<=1)?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(L.Combobox.Option,{value:"all",children:"All Rules"}),a.map(e=>(0,t.jsx)(L.Combobox.Option,{value:e.id,children:e.name},e.id))]}):null,[l,a]);return(0,t.jsxs)("div",{className:"flex lg:flex-row flex-col gap-2 justify-between items-center",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(M.Switch,{name:"default",children:["all",...U.OBSERVABILITY_ALERT_TYPES].map(l=>"all"===l?(0,t.jsx)(M.Switch.Control,{onClick:()=>s({alertType:l}),checked:e.alertType===l,label:"All",value:l},l):n(l)?(0,t.jsx)(M.Switch.Control,{className:"whitespace-nowrap",onClick:()=>s({alertType:l}),checked:e.alertType===l,label:H.AlertTypeLabels[l],value:l},l):null).filter(V)}),o?(0,t.jsxs)(L.Combobox,{onChange:e=>s({rule:e??"all"}),value:e.rule,clearable:!1,noInputPrefix:!0,children:[(0,t.jsx)(L.Combobox.Input,{}),(0,t.jsx)(L.Combobox.List,{children:o})]}):null]}),l?(0,t.jsx)(g.Link,{variant:"highlight",href:`/${r}/~/settings/alerts`,children:"Configure Alerts"}):(0,t.jsx)(_,{webhookEventName:"observability-events",children:"Subscribe to Alerts"})]})}function V(e){return null!=e}var Z=e.i(1294989);function z(e){let{alerts:s,showProject:l,title:a,isLoading:i}=e;return i||(s?.length??0)!==0?(0,t.jsxs)("div",{className:"space-y-2",children:[i?(0,t.jsx)(w.Skeleton,{height:20,width:60}):(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:a}),(0,t.jsx)("div",{className:"overflow-hidden rounded-md bg-background-100 shadow-sm",children:(0,t.jsx)("div",{className:"overflow-hidden rounded-md bg-background-100 shadow-sm divide-y divide-gray-200",children:(i||!s?[void 0,void 0]:s).map((e,s)=>(0,t.jsx)(Z.AlertRowItem,{alert:e,showProject:l},e?.id||`skeleton-${s}`))})})]}):null}let K=[{key:"active",title:"Active",maxAge:null},{key:"last24Hours",title:"Last 24 hours",maxAge:(0,n.default)("24 hours")},{key:"lastWeek",title:"Last 7 days",maxAge:(0,n.default)("7 days")},{key:"lastMonth",title:"Last 30 days",maxAge:(0,n.default)("30 days")},{key:"lastYear",title:"Last 365 days",maxAge:(0,n.default)("365 days")},{key:"older",title:"Older",maxAge:1/0}];function G(e){let{alerts:s,isLoading:a}=e,i=(0,o.useParams)(),{state:{alertType:n,rule:d}}=R(),u=!(i?.project&&"~"!==i.project),{alertGroups:h,hasFilteredResults:m}=(0,c.useMemo)(()=>{let e,t,l=s?.filter(e=>{let t="all"===n||e.type===n,s="all"===d||e.rules?.includes(d);return t&&s})??[];return{alertGroups:(e=Date.now(),t=Object.fromEntries(K.map(e=>{let{key:t}=e;return[t,[]]})),l.forEach(s=>{if("active"===s.status)t.active.push(s);else if(s.startedAt){let l=e-new Date(s.startedAt).getTime(),a=K.slice(1).find(e=>{let{maxAge:t}=e;return null===t||l<=t});a&&t[a.key].push(s)}}),t),hasFilteredResults:l.length>0}},[s,n,d]);return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(D,{}),a?(0,t.jsx)(z,{showProject:u,isLoading:!0}):m||"all"===n&&"all"===d?0===(s?.length||0)?(0,t.jsx)(l,{}):K.map(e=>{let{key:s,title:l}=e,a=h[s];return a?.length>0?(0,t.jsx)(z,{alerts:a,showProject:u,title:l},s):null}):(0,t.jsx)(r,{filterType:n,rule:d})]})}var q=e.i(5067517),Y=e.i(762945),J=e.i(8087928);function Q(e){let{onRetry:s}=e;return(0,t.jsx)("div",{className:"flex items-center justify-center min-h-[200px] border rounded bg-ds-gray-100",children:(0,t.jsxs)("div",{className:"flex flex-col items-center gap-3 p-6 text-center",children:[(0,t.jsx)(Y.Warning,{className:"size-4 orange-900"}),(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)("p",{className:"text-[16px] leading-[24px] font-medium",children:"Unable to load alerts"}),(0,t.jsx)("p",{className:"text-copy-14 text-gray-700",children:"There was an error fetching your alerts. Please try again."})]}),s&&(0,t.jsx)(d.Button,{type:"secondary",size:"small",prefix:(0,t.jsx)(J.RefreshCounterClockwise,{}),onClick:s,children:"Retry"})]})})}var X=e.i(8161149),ee=e.i(3896684);e.i(6728635);var et=e.i(2630141);function es(e){let s,l,{hasObservabilityPlusAccess:a}=e,i=(0,et.useOpenEnableModal)(),r=(0,c.useCallback)(()=>{i({via:"alerts-empty-state",upgradeUseCase:"anomaly-alerts"})},[i]),n=null;return a?(s="Get anomaly alerts for this project",l="This project has been excluded from Observability Plus. Include it to start getting anomaly alerts.",n="Include this Project"):(s="Get anomaly alerts for your projects",l="Automatically get notified when anomalies arise.",n="Upgrade to Observability Plus"),(0,t.jsxs)(X.EmptyState.Root,{description:l,icon:(0,t.jsx)(X.EmptyState.Icon,{size:42,icon:(0,t.jsx)(ee.ChartActivity,{size:16})}),title:s,children:[n&&(0,t.jsx)(d.Button,{onClick:r,children:n}),(0,t.jsx)(g.Link,{"data-zone":"dashboard",external:!0,href:"/docs/alerts",isDifferentZone:!0,type:"secondary",children:"Learn more"})]})}e.s(["AlertsPage",0,function(){let{alerts:e,error:s,isLoading:l,refetch:a,hasObservabilityPlus:i,isCurrentProjectExcluded:r}=(0,q.useAlertsData)({alertTypes:U.OBSERVABILITY_ALERT_TYPES});return l?(0,t.jsx)(G,{isLoading:!0}):!i||r?(0,t.jsx)(es,{hasObservabilityPlusAccess:i}):s?(0,t.jsx)(Q,{onRetry:a}):(0,t.jsx)(G,{alerts:e||[]})},"AlertsPageSkeleton",0,function(){return(0,t.jsx)(G,{isLoading:!0})}],2423133)}]);

//# debugId=1838fabd-3aa6-6d6a-0e1a-11af03b9b06a
//# sourceMappingURL=79d06085e96b5981.js.map