;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="8a6b2f06-4e89-9d43-e508-327798a4ab58")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7437286,e=>{"use strict";var t=e.i(7185353);e.s(["useIntersectionObserver",0,function(e){let{threshold:r=0,root:i=null,rootMargin:a="0%",freezeOnceVisible:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},[s,l]=(0,t.useState)(),o=s?.isIntersecting&&n,c=e=>{let[t]=e;l(t)};return(0,t.useEffect)(()=>{let t=e?.current;if(!window.IntersectionObserver||o||!t)return;let n=new IntersectionObserver(c,{threshold:r,root:i,rootMargin:a});return n.observe(t),()=>n.disconnect()},[e,r,i,a,o]),s}])},1501978,e=>{"use strict";let t=(0,e.i(9334638).withNewIcon)('<path fill="currentColor" d="M5.5 12.5a2 2 0 1 0-4 0 2 2 0 0 0 4 0Zm9 0a2 2 0 1 0-4 0 2 2 0 0 0 4 0ZM4.145 0l.133.054L7.894 1.5h.212L11.722.054 11.855 0h1.335l.5 6H16v1.5H0V6h2.31l.5-6h1.335Zm4.383 2.946L8.395 3h-.79l-.133-.054L4.179 1.63 3.814 6h8.372l-.366-4.371-3.292 1.317ZM16 12.5a3.5 3.5 0 1 1-7 0 .713.713 0 0 0-.713-.713h-.574A.713.713 0 0 0 7 12.5a3.5 3.5 0 1 1-.521-1.838 2.205 2.205 0 0 1 1.234-.375h.574c.457 0 .881.138 1.234.375A3.5 3.5 0 0 1 16 12.5Z"/>');e.s(["Incognito",0,t])},9436889,e=>{"use strict";e.s(["selectInvestigation",0,e=>e.activeSheet&&e.investigations.has(e.activeSheet)?e.investigations.get(e.activeSheet)??null:null,"selectSheetOpen",0,e=>!!(e.activeSheet&&e.investigations.has(e.activeSheet))])},7946960,e=>{"use strict";var t=e.i(847684),r=e.i(1111237),i=e.i(7437286),a=e.i(5255926),n=e.i(7185353);e.s(["QueryVisualizationStep",0,function(e){let{widget:s}=e,l=(0,n.useRef)(null),o=(0,i.useIntersectionObserver)(l,{threshold:.1,freezeOnceVisible:!0});return(0,t.jsxs)("div",{className:"flex flex-col gap-2",ref:l,children:[(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)("p",{className:"text-heading-16 break-all",children:s.title})}),o?.isIntersecting?(0,t.jsx)(r.ResultsChart,{hideTableSearch:!0,horizontal:!0,query:s.query,chartHeight:200}):(0,t.jsx)(a.Skeleton,{height:200,style:{width:"100%"}})]})}])},3045072,1943935,e=>{"use strict";var t=e.i(847684),r=e.i(503082),i=e.i(7946960),a=e.i(7185353),n=e.i(8761240),s=e.i(762945),l=e.i(1501978),o=e.i(8284460),c=e.i(6143247),d=e.i(2455417),u=e.i(5406549),m=e.i(9436889);function p(e){let{widget:r}=e,i=(0,u.useAIInvestigationsStore)(e=>!!(0,m.selectInvestigation)(e)?.error);return(0,t.jsxs)("div",{className:"text-label-14 flex items-center gap-3 tabular-nums",children:[i?(0,t.jsx)(s.Warning,{color:"gray-900",size:16}):(0,t.jsx)(l.Incognito,{color:"gray-900",size:16}),0===r.searches.length?(0,t.jsxs)("span",{className:"text-label-14 flex items-center gap-2 text-gray-800 group-data-[state=open]:hidden",children:[i?"Investigation failed before streaming":"Starting investigation","…"]}):(0,t.jsxs)("div",{children:["Investigated"," ",(0,t.jsxs)("span",{className:"font-medium",children:[r.searches.length," chart",1===r.searches.length?"":"s"]})," ",void 0!==r.startTime?(0,t.jsxs)(t.Fragment,{children:["in"," ",(0,t.jsx)(h,{startTime:r.startTime,endTime:r.endTime})]}):null]})]})}function g(e){let{widget:r}=e;return r.searches.findLast(e=>"analysis-completed"!==e.state),(0,t.jsx)(o.Root,{className:"group border-b border-gray-alpha-200 bg-background-100 px-8 py-2.5",type:"single",collapsible:!0,children:(0,t.jsxs)(o.Item,{value:"summary",children:[(0,t.jsx)(o.Trigger,{className:(0,c.cn)("group flex w-full items-center justify-between bg-transparent transition-transform ease-in-out px-0",{"pointer-events-none":0===r.searches.length}),children:(0,t.jsx)(p,{widget:r})}),(0,t.jsx)(o.Content,{children:(0,t.jsx)("ol",{className:"mt-4 space-y-2",children:r.searches.map(e=>(0,t.jsxs)("li",{className:"text-label-14 flex list-none flex-row items-center gap-3 px-1.5",children:["analysis-completed"===e.state?(0,t.jsx)(n.CheckCircleFill,{}):(0,t.jsx)("span",{className:"flex size-4 items-center",children:(0,t.jsx)(d.LoadingDots,{size:3})}),(0,t.jsx)("p",{children:e.summary})]},e.summary))})})]})})}function h(e){let{startTime:r,endTime:i}=e,n=(0,a.useRef)(null),[s,l]=(0,a.useState)(i||Date.now());return(0,a.useEffect)(()=>{if(i){n.current&&clearInterval(n.current);return}return n.current=setInterval(()=>l(Date.now()),500),()=>n.current?clearInterval(n.current):void 0},[i]),(0,t.jsxs)("span",{children:[Math.floor((s-r)/1e3)," seconds"]})}var f=e.i(3306538),x=e.i(5255926),y=e.i(57106),v=e.i(7807066),b=e.i(2375916),j=e.i(4233469),w=e.i(4337458),N=e.i(1283928),k=e.i(5120783);let L={log:{label:"Log"},deny:{label:"Deny"},challenge:{label:"Challenge"},bypass:{label:"Bypass"},rate_limit:{label:"Rate Limit"},redirect:{label:"Redirect"}};var S=e.i(4597921),T=e.i(564509),I=e.i(3558964);function R(e){let{widget:r}=e,i=(0,S.useServerFlag)("enable-firewall-agent-recommendations",!1);return(0,t.jsx)("div",{className:"flex gap-8 bg-background-200 px-8 py-4",children:(0,t.jsx)("div",{className:"text-label-13 grow",children:(0,t.jsxs)("div",{className:"flex w-full flex-col gap-4",children:[(0,t.jsx)("div",{className:"@container",children:r.summary?(0,t.jsx)(T.AgentMarkdown,{children:r.summary}):(0,t.jsx)(x.Skeleton,{className:"h-4 w-32"})}),r.affectedResources.length>0?(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("p",{className:"text-heading-14",children:["Affected Resource",r.affectedResources.length>1?"s":""]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2 max-w-[60ch]",children:r.affectedResources.map(e=>(0,t.jsx)(q,{value:e},e.value))})]}):null,i&&r.recommendedActions.length>0?(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("p",{className:"text-heading-14",children:["Recommended Action",r.recommendedActions.length>1?"s":""]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-4",children:r.recommendedActions.map(e=>(0,t.jsx)(O,{rule:e},e.id))})]}):null,r.feedbackActivityId?(0,t.jsx)(I.AiFeedback,{activityId:r.feedbackActivityId}):null]})})})}function C(e){let{value:r}=e;return(0,t.jsx)("div",{className:"inline-flex size-4 items-center justify-center rounded-full bg-gray-300 font-mono text-[11px] font-medium text-gray-800",children:r})}function q(e){let{value:r,referenceNumber:i}=e,a=(0,w.useSlugScope)(r.scope),n=N.AllDimensions[r.dimension]?.label;return(0,t.jsxs)("div",{className:"inline-flex items-center justify-between rounded border border-gray-200 bg-background-100 p-2",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,t.jsxs)("p",{className:"text-gray-800",children:[n," ",void 0!==i?(0,t.jsx)(C,{value:i}):null]}),(0,t.jsx)(H,{transparent:!0,children:r.value})]}),a?(0,t.jsx)(y.ButtonLink,{tab:!0,svgOnly:!0,"aria-label":"Investigate Affected Resources",size:"small",type:"secondary",className:"ml-4 !shadow-none",href:(0,j.computeResourceLink)(a,r),children:(0,t.jsx)(v.ChevronRight,{})}):null]})}function H(e){let{children:r,subtle:i,transparent:a}=e;return(0,t.jsx)("div",{className:(0,c.cn)("my-px inline-flex min-h-4 min-w-4 items-center justify-center gap-1.5 rounded font-mono font-medium",{"text-gray-800":i,"bg-gray-300 px-1 py-0.5":!a}),children:r})}function O(e){let{rule:r}=e,i=r.action?.mitigate?.action,a=i?L[i]:void 0,n=r.conditionGroup.flatMap(e=>e.conditions);return(0,t.jsxs)("div",{className:"flex max-h-[300px] min-h-[150px] w-[300px] flex-col gap-2.5 rounded border border-gray-200 bg-background-100 px-4 py-5",children:[(0,t.jsxs)("div",{className:"grow space-y-3",children:[(0,t.jsxs)("p",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-label-12 text-gray-900",children:"Firewall Rule"}),a?(0,t.jsx)(f.Badge,{size:"sm",variant:"red-subtle",capitalize:!0,children:a.label}):null]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-1 text-sm",children:[a?.label,n.map((e,r)=>{let i=k.baseModules[e.type],a=Array.isArray(e.value)?e.value.length:1;return(0,t.jsxs)("span",{className:"font-medium",children:[1===a?`1 ${i.title}`:`${a} ${i.title}s`,r<n.length-1?", ":""]},r)})]})]}),r.firewallRuleUrl?(0,t.jsx)(y.ButtonLink,{prefix:(0,t.jsx)(b.Shield,{color:"gray-100"}),href:r.firewallRuleUrl,children:"Configure Firewall Rule"}):null]},r.id)}var A=e.i(1950288),z=e.i(9304734),B=e.i(5579493),F=e.i(256253),M=e.i(2560270),P=e.i(9722978);let $=(0,F.default)(B.default);function E(e){let{widget:r}=e;return(0,t.jsx)(o.Root,{type:"single",collapsible:!0,className:"flex flex-col bg-background-200",value:r.collapsed?void 0:"item-1",children:(0,t.jsxs)(o.Item,{value:"item-1",children:[(0,t.jsxs)(o.Trigger,{className:"group text-label-14 sticky top-0 z-50 flex w-full list-none flex-row items-center justify-between gap-3 bg-background-200 px-8 py-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 truncate",children:["analysis-completed"===r.state?(0,t.jsx)(n.CheckCircleFill,{}):(0,t.jsx)("span",{className:"flex size-4 items-center",children:(0,t.jsx)(d.LoadingDots,{size:3})}),(0,t.jsx)("p",{className:"truncate",children:r.tagline})]}),(0,t.jsx)(M.ChevronDown,{className:"transition-transform ease-in-out group-data-[state='open']:-rotate-180"})]}),(0,t.jsx)(o.Content,{className:"@container overflow-y-clip data-[state=closed]:animate-content-close data-[state=open]:animate-content-open",children:(0,t.jsxs)("div",{className:"grid xl:grid-cols-2 gap-4 px-8 py-2 pb-4",children:[r.charts.map((e,r)=>void 0!==e.query?(0,t.jsxs)("div",{className:"self-start rounded-md border border-gray-200 px-2 pb-2 min-w-96",children:[(0,t.jsx)(z.QueryTaglineHeader,{className:"p-2",query:e.query,filterDisplay:"count"}),(0,t.jsx)(A.SingleRollupResultLineChart,{allowTooltipEscape:!0,query:e.query,result:e.result,height:200,emptyState:"Querying…"})]},r):null),(0,t.jsx)("div",{className:(0,P.default)("prose prose-sm max-h-[400px] overflow-y-auto dark:prose-invert",r.charts.length>1||0===r.charts.length?"col-span-full":"col-span-1"),children:(0,t.jsx)($,{children:r.analysis??""})})]})})]})})}function V(e){let{widget:r}=e;switch(r.type){case"query-visualization":return(0,t.jsx)(i.QueryVisualizationStep,{widget:r});case"investigation-steps":return(0,t.jsx)(g,{widget:r});case"investigation-digest":return(0,t.jsx)(R,{widget:r});case"analyzed-query":return(0,t.jsx)(E,{widget:r});default:return null}}e.s(["InvestigationBody",0,function(e){let{conversation:i,status:a,className:n}=e,s=(0,r.extractInvestigation)(i.messages,a);return(0,t.jsx)("div",{className:n,children:s.widgets.map(e=>(0,t.jsx)("div",{children:(0,t.jsx)(V,{widget:e})},e.id))})}],3045072);var D=e.i(4585051),U=e.i(9424270),Z=e.i(5203356);e.s(["InvestigationHeader",0,function(e){let{investigation:r,rightContent:i,className:a}=e;return(0,t.jsxs)("header",{className:a,children:[(0,t.jsxs)("section",{className:"flex items-center justify-start gap-4 px-8",children:[(0,t.jsxs)("div",{className:"flex gap-2 items-center",children:[null,(0,t.jsx)("p",{className:"text-heading-24",children:r.title})]}),(0,t.jsx)(f.Badge,{variant:"pink",children:"Beta"}),i]}),(0,t.jsxs)("div",{className:"text-label-14 flex items-center justify-start gap-0 border-gray-200 px-8 pb-2.5",children:[(0,t.jsx)("span",{children:(0,Z.getWorkflowContext)(r.workflow)}),r.input&&"startTime"in r.input&&"endTime"in r.input&&r.input.startTime&&r.input.endTime?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(U.SlashForward,{color:"gray-700"}),(0,t.jsx)("span",{children:(0,Z.getInvestigationTimeRange)({startTime:r.input.startTime,endTime:r.input.endTime})}),(0,t.jsx)(U.SlashForward,{color:"gray-700"}),(0,t.jsx)("span",{children:(0,Z.formatInvestigationDateRange)(r.input.startTime,r.input.endTime)})]}):null,r.createdBy?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(U.SlashForward,{color:"gray-700"}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:["Triggered by"," ",(0,t.jsx)(D.Avatar,{size:16,uid:r.createdBy.uid,title:r.createdBy.username}),r.createdBy.username]})]}):null]})]})}],1943935)},8626589,e=>{"use strict";let t=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M7.24058 1.8685L7.35907 1.12792L5.87791 0.89093L5.75942 1.63151L5.22046 5H2.5H1.75V6.5H2.5H4.98046L4.42046 10H2.5H1.75V11.5H2.5H4.18046L3.75942 14.1315L3.64093 14.8721L5.12209 15.1091L5.24058 14.3685L5.69954 11.5H9.18046L8.75942 14.1315L8.64093 14.8721L10.1221 15.1091L10.2406 14.3685L10.6995 11.5H13.5H14.25V10H13.5H10.9395L11.4995 6.5H13.5H14.25V5H13.5H11.7395L12.2406 1.8685L12.3591 1.12792L10.8779 0.89093L10.7594 1.63151L10.2205 5H6.73954L7.24058 1.8685ZM9.98046 6.5H6.49954L5.93954 10H9.42046L9.98046 6.5Z" fill="currentColor"/>');e.s(["Hash",0,t])},4233469,e=>{"use strict";var t=e.i(8690335);Symbol("RELATIVE_LINK"),e.s(["computeLink",0,function(e){let{teamSlug:t,page:r,env:i,to:a,from:n,detailPage:s}=e,l=[t,"projectName"in e&&e.projectName?e.projectName:"~","observability",r,s].filter(Boolean),o=new URLSearchParams;return i&&o.set("environment",i),a&&n&&(o.set("to",`${Math.floor(a.getTime()/1e3)}`),o.set("from",`${Math.floor(n.getTime()/1e3)}`)),`/${l.join("/")}${o.size?`?${o.toString()}`:""}`},"computeResourceLink",0,function(e,r){var i;let a,{dimension:n,value:s,event:l,startTime:o,endTime:c}=r,d=(a="project"===(i=e).type?i.projectNames[0]??"~":"~",[i.teamSlug,a,"observability"]),u=`/${d.join("/")}`,m=new URLSearchParams;switch(o&&c&&(m.set("to",`${Math.floor(c.getTime()/1e3)}`),m.set("from",`${Math.floor(o.getTime()/1e3)}`)),n){case"route":return`${u}/route/${encodeURIComponent(s)}?${m.toString()}`;case"requestPath":return`${u}/requestPath/${encodeURIComponent(s)}?${m.toString()}`;default:return`${u}/query?${(0,t.prefillQuery)({aggregation:"sum",metric:l?`${l}.count`:"incomingRequest.count",by:[n],time:o&&c?{from:o,to:c}:void 0})}`}}])},6722259,e=>{"use strict";e.s(["urlAttributes",0,{action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]}])},5579493,e=>{"use strict";var t=e.i(4897802),r=e.i(4945334),i=e.i(6722259),a=e.i(847684);e.i(7185353);var n=e.i(8403010),s=e.i(3652652),l=e.i(7879302),o=e.i(2446207),c=e.i(1159902);let d=[],u={allowDangerousHtml:!0},m=/^(https?|ircs?|mailto|xmpp)$/i,p=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function g(e){let t=e.indexOf(":"),r=e.indexOf("?"),i=e.indexOf("#"),a=e.indexOf("/");return -1===t||-1!==a&&t>a||-1!==r&&t>r||-1!==i&&t>i||m.test(e.slice(0,t))?e:""}e.s(["default",0,function(e){var m;let h,f,x,y,v,b=(h=(m=e).rehypePlugins||d,f=m.remarkPlugins||d,x=m.remarkRehypeOptions?{...m.remarkRehypeOptions,...u}:u,(0,l.unified)().use(n.default).use(f).use(s.default,x).use(h)),j=(y=e.children||"",v=new c.VFile,"string"==typeof y?v.value=y:(0,t.unreachable)("Unexpected value `"+y+"` for `children` prop, expected `string`"),v);return function(e,n){let s=n.allowedElements,l=n.allowElement,c=n.components,d=n.disallowedElements,u=n.skipHtml,m=n.unwrapDisallowed,h=n.urlTransform||g;for(let e of p)Object.hasOwn(n,e.from)&&(0,t.unreachable)("Unexpected `"+e.from+"` prop, "+(e.to?"use `"+e.to+"` instead":"remove it")+" (see <https://github.com/remarkjs/react-markdown/blob/main/changelog.md#"+e.id+"> for more info)");return s&&d&&(0,t.unreachable)("Unexpected combined `allowedElements` and `disallowedElements`, expected one or the other"),(0,o.visit)(e,function(e,t,r){if("raw"===e.type&&r&&"number"==typeof t)return u?r.children.splice(t,1):r.children[t]={type:"text",value:e.value},t;if("element"===e.type){let t;for(t in i.urlAttributes)if(Object.hasOwn(i.urlAttributes,t)&&Object.hasOwn(e.properties,t)){let r=e.properties[t],a=i.urlAttributes[t];(null===a||a.includes(e.tagName))&&(e.properties[t]=h(String(r||""),t,e))}}if("element"===e.type){let i=s?!s.includes(e.tagName):!!d&&d.includes(e.tagName);if(!i&&l&&"number"==typeof t&&(i=!l(e,t,r)),i&&r&&"number"==typeof t)return m&&e.children?r.children.splice(t,1,...e.children):r.children.splice(t,1),t}}),(0,r.toJsxRuntime)(e,{Fragment:a.Fragment,components:c,ignoreInvalidStyle:!0,jsx:a.jsx,jsxs:a.jsxs,passKeys:!0,passNode:!0})}(b.runSync(b.parse(j),j),e)}],5579493)},256253,(e,t,r)=>{"use strict";var i=e.e&&e.e.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=e.e&&e.e.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,i=Object.getOwnPropertySymbols(e);a<i.length;a++)0>t.indexOf(i[a])&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(r[i[a]]=e[i[a]]);return r};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return function(t){var r=t.defaultOrigin,l=void 0===r?"":r,o=t.allowedLinkPrefixes,c=void 0===o?[]:o,d=t.allowedImagePrefixes,u=void 0===d?[]:d,m=t.components,p=a(t,["defaultOrigin","allowedLinkPrefixes","allowedImagePrefixes","components"]),g=c.length&&!c.every(function(e){return"*"===e}),h=u.length&&!u.every(function(e){return"*"===e});if(!l&&(g||h))throw Error("defaultOrigin is required when allowedLinkPrefixes or allowedImagePrefixes are provided");var f=function(e){if("string"!=typeof e)return null;try{var t=new URL(e);return t}catch(r){if(l)try{var t=new URL(e,l);return t}catch(e){}return null}},x=function(e){return"string"==typeof e&&e.startsWith("/")},y=function(e,t){if(!e||!f(e))return null;if(t.includes("*")){var r=x(e),i=f(e);return i?r?i.pathname+i.search+i.hash:i.href:null}var a=x(e),n=f(e);return n&&t.some(function(e){var t=f(e);return!!t&&t.origin===n.origin&&n.href.startsWith(t.href)})?a?n.pathname+n.search+n.hash:n.href:null},v=i(i({},m),{a:function(e){var t=e.href,r=e.children,l=e.node,o=a(e,["href","children","node"]),d=y(t,c);return null!==d?(null==m?void 0:m.a)?(0,s.createElement)(m.a,i({href:d,children:r,node:l,target:"_blank",rel:"noopener noreferrer"},o)):(0,n.jsx)("a",i({href:d},o,{target:"_blank",rel:"noopener noreferrer",children:r})):(0,n.jsxs)("span",{className:"text-gray-500",title:"Blocked URL: ".concat(t),children:[r," [blocked]"]})},img:function(e){var t=e.src,r=e.alt,l=e.node,o=a(e,["src","alt","node"]),c=y(t,u);return null!==c?(null==m?void 0:m.img)?(0,s.createElement)(m.img,i({src:c,alt:r,node:l},o)):(0,n.jsx)("img",i({src:c,alt:r},o)):(0,n.jsxs)("span",{className:"inline-block bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-400 px-3 py-1 rounded text-sm",children:["[Image blocked: ",r||"No description","]"]})}}),b=i(i({},p),{components:v});return(0,s.createElement)(e,b)}};var n=e.r(847684),s=e.r(7185353)},2405943,e=>{"use strict";let t=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M6.89531 2.23972C6.72984 2.12153 6.5 2.23981 6.5 2.44315V5.25001C6.5 6.21651 5.7165 7.00001 4.75 7.00001H2.5V13.5H12.1884C12.762 13.5 13.262 13.1096 13.4011 12.5532L14.4011 8.55318C14.5984 7.76425 14.0017 7.00001 13.1884 7.00001H9.25H8.5V6.25001V3.51458C8.5 3.43384 8.46101 3.35807 8.39531 3.31114L6.89531 2.23972ZM5 2.44315C5 1.01975 6.6089 0.191779 7.76717 1.01912L9.26717 2.09054C9.72706 2.41904 10 2.94941 10 3.51458V5.50001H13.1884C14.9775 5.50001 16.2903 7.18133 15.8563 8.91698L14.8563 12.917C14.5503 14.1412 13.4503 15 12.1884 15H1.75H1V14.25V6.25001V5.50001H1.75H4.75C4.88807 5.50001 5 5.38808 5 5.25001V2.44315Z" fill="currentColor"/>');e.s(["ThumbUp",0,t])},503082,e=>{"use strict";var t=e.i(1233856);function r(e){if("tool-query-metrics"===e.type){let r=e.output;return{result:void 0===r?void 0:(0,t.fromApiSonarResult)(r),query:e.output?.query??e.input?.query,tagline:e.input?.tagline}}if("tool-queryFirewallTraffic"===e.type){let r=e.output;return{result:void 0===r?void 0:(0,t.fromApiSonarResult)(r),query:e.output?.query,tagline:e.input?.tagline}}if("data-query-results"===e.type){let r=e.data.results;return{result:void 0===r?void 0:(0,t.fromApiSonarResult)(r),query:e.data?.query,tagline:e.data?.tagline}}if("tool-query-logs"===e.type)return{tagline:"Querying application logs",result:void 0,query:void 0}}e.s(["extractInvestigation",0,function(e){let t,i,a,n,s,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"complete",o=e.filter(e=>"assistant"===e.role),c=[],d=[],u=[],m=[],p=0;for(let e of o)for(let o of e.parts){if("data-start-section"===o.type){n=o.data.section;continue}let e=c.at(c.length-1),g=r(o);if(g){if(void 0!==e&&"analyzed-query"===e.type&&void 0===e.analysis)g.query&&e.charts.push({query:g.query,result:g.result}),g.tagline&&(e.tagline+=`, ${g.tagline}`);else{let e=g.query?[{query:g.query,result:g.result}]:[];c.push({type:"analyzed-query",id:`widget-${p++}`,charts:e,tagline:g.tagline,state:"analysis-started",collapsed:!1})}d.push({summary:g.tagline??"",state:"streaming"===l?"analysis-started":"analysis-completed"})}if("data-start-time"===o.type&&(i=o.data.startTime),"data-end-time"===o.type&&(a=o.data.endTime),"data-activity-id"===o.type&&(s=o.data.activityId),"data-related-resource"===o.type&&u.push(o.data),"data-rule-recommendation"===o.type&&m.push(o.data),"text"===o.type)if("summary"===n)t=t?`${t}
${o.text}`:o.text;else{let e=c.at(-1);e&&"analyzed-query"===e.type&&void 0===e.analysis&&(e.analysis=o.text)}}let g=void 0!==t||u.length>0||m.length>0;g&&c.push({type:"investigation-digest",id:"widget-investigation-digest",summary:t,affectedResources:u,recommendedActions:m,feedbackActivityId:"complete"===l?s:void 0}),c.unshift({id:"widget-investigation-steps",type:"investigation-steps",startTime:i,endTime:a,searches:d});let h=c.findLastIndex(e=>"analyzed-query"===e.type&&(e.charts?.length>0||void 0!==e.analysis));for(let e=0;e<c.length;e++){let t=c[e];"analyzed-query"===t.type&&(e<h||g)&&(t.collapsed=!0)}let f=c.findLastIndex(e=>"analyzed-query"===e.type);for(let e=0;e<c.length;e++){let t=c[e];"analyzed-query"===t.type&&(e<f||g)&&(t.state="analysis-completed")}return{widgets:c,messages:e,status:l}},"extractQueryResult",0,r])},564509,e=>{"use strict";var t=e.i(847684),r=e.i(256253),i=e.i(5579493),a=e.i(6143247);let n=(0,r.default)(i.default);e.s(["AgentMarkdown",0,function(e){let{children:r,className:i}=e;return(0,t.jsx)("div",{className:(0,a.cn)("prose prose-sm dark:prose-invert prose-headings:text-heading-14 prose-strong:font-medium prose-headings:mb-0 prose-p:break-before-avoid prose-li:break-before-avoid prose-li:my-0 prose-ul:my-0 prose-li:list-['-'] prose-li:marker:text-gray-900 prose-ul:ps-2 prose-code:before:content-none prose-code:after:content-none prose-code:text-amber-1000",i),children:(0,t.jsx)(n,{children:r})})}])},3558964,e=>{"use strict";var t=e.i(847684),r=e.i(7185353),i=e.i(8436238),a=e.i(1114103),n=e.i(2504781),s=e.i(3500331),l=e.i(4991687),o=e.i(8674454),c=e.i(5232300),d=e.i(2405943),u=e.i(2924363),m=e.i(6143247);function p(e){let{feedbackType:r,setFeedbackType:i,buttonSize:a}=e,{actions:{setOpen:s,closeAndRestoreFocus:l},state:{buttonId:o,buttonRef:m,menuId:p,open:g,popperAttributes:h,popperStyles:f}}=(0,c.useMenu)(),x={size:a,shape:"square",svgOnly:!0,type:"tertiary","aria-controls":p,"aria-expanded":g,"aria-haspopup":!0,style:{...f.reference,opacity:1},id:o,ref:m,...h.reference},y=e=>{e===r?(l(1),i(null)):(g||s(!0),i(e))};return(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(n.Button,{"aria-label":"Feedback: thumbs up",onClick:()=>y("positive"),...x,children:(0,t.jsx)(d.ThumbUp,{color:"positive"===r?"gray-1000":"negative"===r?"gray-500":"gray-1000"})}),(0,t.jsx)(n.Button,{"aria-label":"Feedback: thumbs down",onClick:()=>y("negative"),...x,children:(0,t.jsx)(u.ThumbDown,{color:"negative"===r?"gray-1000":"positive"===r?"gray-500":"gray-1000"})})]})}function g(e){let{feedbackType:i,activityId:a,onClose:l}=e,[o,d]=(0,r.useState)(""),{actions:{setOpen:u},state:{open:m}}=(0,c.useMenu)(),p=(0,r.useRef)(null);(0,r.useEffect)(()=>{m&&setTimeout(()=>{p.current?.focus()},0)},[m]);let g=()=>{i&&fetch("/vercel-agent/api/feedback",{method:"POST",body:JSON.stringify({activityId:a,thumbsUp:"positive"===i,comment:o.trim()})}),d(""),l(!0),u(!1)};return(0,t.jsxs)("div",{className:"flex flex-col gap-2 -m-2",children:[(0,t.jsxs)("div",{className:"m-3 mb-1",children:[(0,t.jsx)("h3",{className:"text-label-13 text-gray-900 mb-2",children:"negative"===i?"Help us improve":"Share your thoughts"}),(0,t.jsx)(s.Input,{ref:p,"aria-label":"Comment",value:o,onKeyDown:e=>{"Enter"===e.key&&g()},onChange:e=>d(e.target.value),placeholder:"negative"===i?"Not what you expected? (optional)":"What do you appreciate? (optional)",className:"w-full"})]}),(0,t.jsx)("div",{className:"flex gap-2 justify-end bg-background-200 border-0 border-t border-solid border-t-gray-alpha-400 p-2 ",children:(0,t.jsx)(n.Button,{onClick:g,type:"default","aria-label":"Submit feedback",size:"small",children:"Send"})})]})}e.s(["AiFeedback",0,function(e){let{className:n="",activityId:s,buttonSize:c="medium"}=e,[d,u]=(0,r.useState)(null),[h,f]=(0,r.useState)(!1),x=e=>{e&&f(!0),u(null)};return(0,t.jsx)("div",{className:(0,m.cn)("flex flex-col",n),children:(0,t.jsx)("div",{className:"flex gap-2 items-center",children:(0,t.jsx)(a.AnimatePresence,{mode:"wait",children:h?(0,t.jsx)(i.motion.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},transition:{duration:.2},className:"text-sm font-medium",children:"Thanks for your feedback!"},"thanks-message"):(0,t.jsx)(i.motion.div,{initial:{opacity:1},exit:{opacity:0,scale:.95},transition:{duration:.2},children:(0,t.jsxs)(l.MenuContainer,{position:"top",closeOnSelect:!1,onClose:()=>x(),children:[(0,t.jsx)(p,{feedbackType:d,setFeedbackType:u,buttonSize:c}),(0,t.jsx)(o.Menu,{width:300,children:(0,t.jsx)(g,{feedbackType:d,onClose:x,activityId:s})})]})},"feedback-buttons")})})})}])},1950288,9304734,e=>{"use strict";var t=e.i(847684),r=e.i(5182595),i=e.i(2923544),a=e.i(9179929),n=e.i(1283928),s=e.i(1233856),l=e.i(7185353),o=e.i(5255926),c=e.i(8690335),d=e.i(9031477);e.s(["SingleRollupResultLineChart",0,function(e){let{query:u,result:m,height:p,rollup:g,shareTitle:h,allowTooltipEscape:f,emptyState:x}=e,y=(0,s.getRollup)(u,g)??{name:"value",measure:"count",aggregation:"sum"},v=(0,i.labelForMeasure)(u.event,y.measure),b=(0,c.getFormatter)(y.aggregation,n.AllMeasures[y.measure].unit),j=(0,l.useMemo)(()=>0===u.groupBy.length?{singleCategoryName:v,rollupName:y.name}:1===u.groupBy.length?{category:u.groupBy[0]}:{category:e=>u.groupBy.map(t=>e[t]).join(", ")},[u.groupBy,v,y.name]),w=(0,a.useTimeseriesData)(m,j);return(0,t.jsx)("div",{className:"w-full",children:(0,t.jsx)(o.Skeleton,{show:void 0===m,children:(0,t.jsx)(d.ShareDomCopy,{title:h??v,children:(0,t.jsx)("div",{style:{height:p??"230px"},children:(0,t.jsx)(r.LineChart,{allowTooltipEscape:f,data:w??[],sonarQueryResults:m,disableLegend:!0,disableZoom:!0,emptyState:x??"No data in this time range",formatValue:b,maxLines:25,title:null,xTickCount:5})})})})})}],1950288);var u=e.i(9722978);function m(e){let{groupBy:r,groupByDisplay:a}=e;return 0===r.length?null:"show-all"===a||"count-if-multiple"===a&&1===r.length?(0,t.jsxs)("span",{className:"ms-1",children:[(0,t.jsx)("span",{className:"text-gray-900",children:"by"})," ",r.map(e=>(0,i.labelForDimension)(e)).join(", ")]}):(0,t.jsxs)("span",{className:"bg-gray-200 text-gray-800 rounded-md px-2 py-1 ms-2 break-words",title:r.map(e=>e).join(", "),children:["by ",r.length," Group",r.length>1?"s":""]})}function p(e){let{filter:r,filterDisplay:i}=e,a=r?(0,c.parseFilters)(r):[];return 0===a.length?null:"count"===i||"count-if-multiple"===i&&a.length>1?(0,t.jsxs)("span",{className:"ms-2 bg-gray-200 text-gray-900 rounded-md px-2 py-1 whitespace-nowrap",title:r,children:[a.length," Filter",a.length>1?"s":""]}):(0,t.jsx)("span",{className:"max-w-full truncate font-mono",children:r})}e.s(["QueryTaglineHeader",0,function(e){let{query:r,rollup:a,groupByDisplay:n="show-all",filterDisplay:l="show-all",className:o}=e,c=(0,s.getRollup)(r,a),d=c?(0,i.labelForMeasure)(r.event,c.measure):void 0;return(0,t.jsxs)("div",{className:(0,u.default)("text-sm break-words flex-row items-center gap-2 leading-6",o),children:[d,(0,t.jsx)(m,{groupBy:r.groupBy,groupByDisplay:n}),(0,t.jsx)(p,{filter:r.filter,filterDisplay:l})]})}],9304734)}]);

//# debugId=8a6b2f06-4e89-9d43-e508-327798a4ab58
//# sourceMappingURL=b0fb5c5aa2b7504a.js.map