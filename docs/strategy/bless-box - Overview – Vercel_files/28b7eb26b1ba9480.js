;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="95f8a79f-dc2a-a8f8-20fb-13bd905dadda")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,6671454,e=>{"use strict";var t=e.i(847684),i=e.i(7185353),a=e.i(5169576),n=e.i(2504781),s=e.i(8161149),l=e.i(6352514),r=e.i(4759942),o=e.i(5338940),c=e.i(57106),d=e.i(4004502),u=e.i(4011256),h=e.i(1017032),x=e.i(7594446),m=e.i(8087728),p=e.i(5669250),g=e.i(7759431),f=e.i(8573953),j=e.i(2486836),y=e.i(3748432);function b(e){let{teamSlug:o,team:c,installationsWithFilters:h,testIdPrefix:b,actionButtons:v}=e,{installationsByIntegration:N,legacyInstallations:C,search:I,onSearchChanged:k,onCategoryChanged:w,category:T,categories:S,onLoadNextPage:A,hasMorePages:P,installationType:M,onInstallationTypeChanged:L}=h,{isLoading:_,canCreateIntegrationConfiguration:R}=(0,x.useIntegrationPermissions)(),[E,D]=(0,i.useState)({active:!1,team:null}),O=e=>{let{id:t,slug:i}=e;r.analytics.track(l.AnalyticsEvent.INTEGRATION_OVERVIEW_MANAGE_CLICKED,{integration:{id:t,slug:i}})},F=(0,i.useCallback)(e=>D({active:!0,...e}),[]),B=(0,i.useCallback)(()=>D({...E,active:!1}),[E]);return(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-20 flex-1 w-full",children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-5 flex-initial",children:[(0,t.jsx)(m.InstalledIntegrationsFilters,{actionButtons:v,categories:S,category:T,installationType:M,onCategoryChanged:w,onInstallationTypeChanged:L,onSearchChanged:k,search:I,searchInputTestId:b?(0,d.tid)(b,"search-input"):void 0}),N.length>0?(0,t.jsxs)("div",{className:g.default.integrationList,children:[(0,t.jsx)(f.ReinstallationModal,{onCancel:B,state:E}),N.map((e,i)=>{let a=function(e,t,i,a){if(a&&!i&&1===e.installations.length){let i=e.installations[0].id;return"scopes-review"===e.requiredAction?(0,u.getPermissionsLink)({teamSlug:t,configurationId:i}):(0,u.getInstallationDetailsLink)({teamSlug:t,configurationId:i,integrationSlug:e.slug,isMarketplace:e.isMarketplace})}return(0,u.getIntegrationDetailsLink)({integrationSlug:e.slug,teamSlugOrPublic:{teamSlug:t},installationHash:!0})}(e,o,_,R);return(0,t.jsx)(y.ConditionalNavigationMarker,{enabled:0===i,phase:"content",label:"MarketplaceInstalledIntegrationsContent",children:(0,t.jsx)(p.InstallationCard,{integrationWithInstallations:e,link:a,testId:b?(0,d.tid)(b,"entity",e.integrationId):void 0,onClick:()=>{switch(e.requiredAction){case"reinstall-log-drain":case"reinstall-log-drain-admin":F({configuration:{integrationId:e.integrationId,name:e.name,slug:e.slug,id:e.installations[0].id},team:c});break;default:O({id:e.integrationId,slug:e.slug})}}})},e.integrationId)})]}):(0,t.jsx)(s.EmptyState.Root,{className:g.default.emptyState,description:I?`Your search for "${I}" did not return any results.`:void 0,icon:(0,t.jsx)(s.EmptyState.Icon,{icon:(0,t.jsx)(a.Information,{size:32})}),secondary:!0,title:"No Results Found"}),P?(0,t.jsx)(n.Button,{onClick:A,type:"secondary",children:"Show More"}):null]}),C.length>0?(0,t.jsx)(j.LegacyIntegrations,{legacyInstallations:C,onCardClicked:O,teamSlug:o}):null]})}e.s(["InstalledIntegrations",0,function(e){let{teamSlug:i,configurations:n,testIdPrefix:l,actionButtons:r}=e,{team:d}=(0,o.useTeam)(),{data:x}=(0,h.useConfigurations)({skipBillingData:!0}),p=(0,m.useInstalledIntegrationsFilters)({integrationInstallations:x??n});return 0===n.length?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-5 flex-1 w-full",children:(0,t.jsx)(s.EmptyState.Root,{className:g.default.emptyState,description:"You don't have any integration installed.",icon:(0,t.jsx)(s.EmptyState.Icon,{icon:(0,t.jsx)(a.Information,{size:32})}),secondary:!0,title:"No Integrations Installed",children:(0,t.jsx)(c.ButtonLink,{href:(0,u.getBrowseMarketplaceLink)({teamSlugOrPublic:{teamSlug:i}}),type:"secondary",children:"Browse Marketplace"})})})}):(0,t.jsx)(b,{actionButtons:r,installationsWithFilters:p,team:d,teamSlug:i,testIdPrefix:l})},"MarketplaceInstalledIntegrationsPlaceholder",0,function(e){let{externalCounter:i}=e;return(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-20 flex-1 w-full",children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-5 flex-initial",children:[(0,t.jsx)(m.InstalledIntegrationsFiltersPlaceholder,{}),(0,t.jsx)("div",{className:g.default.integrationList,children:Array.from({length:i??3}).map((e,i)=>(0,t.jsx)(p.MarketplaceInstallationCardPlaceholder,{},`marketplace${i}`))})]})})}])},3999030,e=>{"use strict";var t=e.i(847684),i=e.i(7185353),a=e.i(5255926),n=e.i(2504781),s=e.i(8238875),l=e.i(8544664);e.i(5628754);var r=e.i(9203481);e.i(5463680);var o=e.i(15312);e.i(553769);var c=e.i(3758860);e.i(6887680);var d=e.i(6810699),u=e.i(1909206),h=e.i(2483928),x=e.i(6315360),m=e.i(8525850),p=e.i(7594446),g=e.i(2704354);function f(e){return(0,t.jsx)(n.Button,{onClick:()=>{window.requestAnimationFrame(e.onClick)},type:"secondary",children:"Load More"})}function j(){let e=(0,s.useParams)(),i=(0,l.usePlaceholderCount)(`installed-products:${e?.teamSlug}-${e?.slug}`,void 0);return i?(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-5 flex-initial",children:[(0,t.jsx)("p",{className:"text-heading-20",children:"Installed Products"}),(0,t.jsx)(y,{count:Math.min(i,4),hasAvatar:!0,hasTitle:!0}),i&&i>4?(0,t.jsx)("div",{className:"h-[40px]"}):null]}):null}function y(e){return(0,t.jsx)("div",{className:x.default.marketplaceDetailsProductsGrid,children:Array.from({length:e.count}).map((i,a)=>(0,t.jsx)(h.MarketplaceProductDetailsCardPlaceholder,{hasAvatar:e.hasAvatar,hasTitle:e.hasTitle},`product${a}`))})}function b(e){return(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-5 flex-initial",children:[(0,t.jsx)("p",{className:"text-heading-20",children:e.title}),(0,t.jsx)(u.InstallMarketplaceProductProvider,{configuration:e.configuration,teamSlugOrPublic:e.teamSlugOrPublic,displayModalsInline:!1,children:(0,t.jsx)("div",{className:x.default.marketplaceDetailsProductsGrid,children:e.products.map(i=>(0,t.jsx)(h.MarketplaceProductDetailsCard,{configuration:e.configuration,disabled:!e.allowInstallation||e.disabled,hasAvatar:!0,integration:e.integration,product:i,teamSlugOrPublic:e.teamSlugOrPublic,enableMarketplaceNewCheckout:e.enableMarketplaceNewCheckout,tooltip:e.allowInstallation?void 0:"You don't have permission to install this product"},i.id))})})]})}e.s(["MarketplaceDetailsProducts",0,function(e){let[a,n]=(0,i.useState)(4),s=e.integration,l=("products"in s?s.products:void 0)||[],{data:u}=(0,d.useResourceList)({integrationIdOrSlug:s.slug,integrationConfigurationId:e.configuration.id,skipMetadata:!0,fallbackData:e.resourcesData?{stores:e.resourcesData}:void 0}),h=(u?.stores?.length??0)>a,{isLoading:y,canCreateIntegrationConfiguration:v}=(0,p.useIntegrationPermissions)(),N=y||!v,C="single-product"===s.layout,I=u?.stores?.filter(t=>t.product.integrationConfigurationId===e.configuration?.id),k=I?.slice(0,a);return(I?.length===0||e.teamSlugOrPublic.isPublic)&&e.renderAllIntegrationProducts&&"products"in s&&(0,g.isMarketplaceIntegration)(s)?(0,t.jsx)(b,{title:`Products by ${s.createdBy}`,integration:s,products:l,teamSlugOrPublic:e.teamSlugOrPublic,disabled:e.disabled||!!e.configuration?.deleteRequestedAt,allowInstallation:!N,enableMarketplaceNewCheckout:e.enableMarketplaceNewCheckout||!1,configuration:e.configuration}):C?null:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-10 flex-initial",children:[I?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-5 flex-initial",children:[(0,t.jsx)("p",{className:"text-heading-20",children:e.label}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsx)("div",{className:x.default.marketplaceDetailsProductsGrid,children:k?.map(i=>(0,t.jsx)(o.ResourceModalsProvider,{protocolType:(0,c.getPrimaryProtocolByProduct)(i.product),children:(0,t.jsx)(r.ResourceItem,{item:i,resourceLinkFunc:()=>(0,m.getResourceDetailsPath)(i,e.teamSlugOrPublic.teamSlug??""),showCreatedAt:!1})},i.id))}),h?(0,t.jsx)(f,{onClick:function(){n(a+4)}}):null]})]})}):(0,t.jsx)(j,{}),e.renderAllIntegrationProducts&&"products"in s&&(0,g.isMarketplaceIntegration)(s)?(0,t.jsx)(b,{configuration:e.configuration,title:"More Products",integration:s,products:l,teamSlugOrPublic:e.teamSlugOrPublic,disabled:e.disabled||!!e.configuration?.deleteRequestedAt,allowInstallation:!N,enableMarketplaceNewCheckout:e.enableMarketplaceNewCheckout||!1}):null]})},"ProductsOrResourcesPlaceholder",0,function(){let e=(0,s.useParams)();return(0,l.usePlaceholderCount)(`installed-products:${e?.teamSlug}-${e?.slug}`,void 0)?(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-10 flex-initial",children:[(0,t.jsx)(j,{}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-5 flex-initial",children:[(0,t.jsx)("p",{className:"text-heading-20",children:"More Products"}),(0,t.jsx)(y,{count:1,hasAvatar:!1,hasTitle:!0})]})]}):(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-5 flex-initial",children:[(0,t.jsx)("p",{className:"text-heading-20",children:(0,t.jsx)(a.Skeleton,{width:200})}),(0,t.jsx)(y,{count:4,hasAvatar:!1,hasTitle:!1}),(0,t.jsx)("div",{className:"h-[200px]"})]})}])},3690352,e=>{e.v({button:"integration-video-player-module__Gy_CcG__button",loading:"integration-video-player-module__Gy_CcG__loading",play:"integration-video-player-module__Gy_CcG__play","play-icon":"integration-video-player-module__Gy_CcG__play-icon",player:"integration-video-player-module__Gy_CcG__player"})},8447345,e=>{e.v({gallery:"details-gallery-module__uxYlVW__gallery",grayscale:"details-gallery-module__uxYlVW__grayscale",image:"details-gallery-module__uxYlVW__image","image-skeleton":"details-gallery-module__uxYlVW__image-skeleton","image-wrapper":"details-gallery-module__uxYlVW__image-wrapper",wrapper:"details-gallery-module__uxYlVW__wrapper"})},2434652,e=>{"use strict";var t=e.i(847684),i=e.i(5255926),a=e.i(9739627),n=e.i(7185353);let s=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M13.4549 7.22745L13.3229 7.16146L2.5 1.74999L2.4583 1.72914L1.80902 1.4045L1.3618 1.18089C1.19558 1.09778 1 1.21865 1 1.4045L1 1.9045L1 2.63041L1 2.67704L1 13.3229L1 13.3696L1 14.0955L1 14.5955C1 14.7813 1.19558 14.9022 1.3618 14.8191L1.80902 14.5955L2.4583 14.2708L2.5 14.25L13.3229 8.83852L13.4549 8.77253L14.2546 8.37267L14.5528 8.2236C14.737 8.13147 14.737 7.86851 14.5528 7.77638L14.2546 7.62731L13.4549 7.22745ZM11.6459 7.99999L2.5 3.42704L2.5 12.5729L11.6459 7.99999Z" fill="currentColor"/>');var l=e.i(8735244),r=e.i(6891161),o=e.i(3690352);function c(e){let{videoId:i}=e,[a,c,d]=(()=>{let[e,t]=(0,n.useState)(!1);return[e,(0,n.useCallback)(()=>t(!0),[]),(0,n.useCallback)(()=>t(!1),[])]})(),[u,h]=(0,n.useState)(!0);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{className:o.default.button,onClick:c,type:"button",children:(0,t.jsx)("div",{className:o.default.play,children:(0,t.jsx)("div",{className:o.default["play-icon"],children:(0,t.jsx)(s,{})})})}),(0,t.jsx)(r.Modal.Modal,{active:a,drawer:!1,onClickOutside:d,width:"80vw",children:(0,t.jsxs)("div",{className:o.default.player,children:[u?(0,t.jsx)("div",{className:o.default.loading,children:(0,t.jsx)(l.Spinner,{size:64})}):null,(0,t.jsx)("iframe",{allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,frameBorder:"0",height:"100%",onLoad:()=>h(!1),referrerPolicy:"no-referrer",src:`https://www.youtube.com/embed/${i}`,title:"Integration video player",width:"100%"})]})})]})}function d(e){let{src:i}=e,a=i.startsWith("https://img.youtube.com/vi/")?(i.split("https://img.youtube.com/vi/").pop()||"").split("/0.jpg").shift():null;return a?(0,t.jsx)(c,{videoId:a}):null}var u=e.i(8447345),h=e.i(9722978);e.s(["DetailsGallery",0,function(e){let{images:n,grayscale:s}=e;return(0,t.jsx)("div",{className:u.default.gallery,children:(0,t.jsx)("div",{className:(0,h.default)("flex flex-row items-stretch justify-start gap-4 flex-initial",u.default.wrapper),style:{"--width":`${504*(n.length||1)}px`},children:0===n.length?(0,t.jsx)("div",{className:u.default["image-wrapper"],children:(0,t.jsx)("div",{className:u.default.image,children:(0,t.jsx)(i.Skeleton,{className:u.default["image-skeleton"],height:"var(--skeleton-height)",width:"var(--skeleton-width)"})})}):n.map((e,i)=>{let n="string"==typeof e?e:`https:${e.fields.file.url}`,l="string"==typeof e?"":e.fields.description,r={srcDark:n,srcLight:n,layout:"fill",objectFit:"cover",priority:i<=2};return(0,t.jsx)("div",{className:u.default["image-wrapper"],children:(0,t.jsx)("div",{className:u.default.image,children:"string"==typeof e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d,{src:n}),(0,t.jsx)(a.Image,{...r,alt:l})]}):(0,t.jsx)(a.Image,{...r,alt:l,className:s?u.default.grayscale:void 0})})},n)})})})}],2434652)},943709,e=>{"use strict";var t=e.i(847684),i=e.i(5328446),a=e.i(4138437),n=e.i(2504781),s=e.i(6891161),l=e.i(455575),r=e.i(7185353),o=e.i(5338940),c=e.i(8797711),d=e.i(6111613),u=e.i(2333337),h=e.i(1914640),x=e.i(2452025),m=e.i(553769);function p(e){let{configuration:i,billingPlan:a,header:n,onNext:l,onBack:r,cancelLabel:o}=e;return(0,t.jsx)(x.ModalWrapper,{SuccessAction:(0,t.jsx)(s.Modal.Action,{onClick:l,children:"Confirm"}),cancelLabel:o,header:n,onBack:r,children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsx)("p",{className:"text-[16px] leading-[24px] font-medium",children:"Billing Plan"}),(0,t.jsx)(h.ReadOnlyPanel,{title:"Selected Billing Plan",children:(0,t.jsx)(h.ReadOnlyBillingPlan,{billingPlan:a,isAwsIntegration:!!i.integration&&(0,m.isAwsIntegration)(i.integration)})})]})})}var g=e.i(5255926),f=e.i(9544652),j=e.i(8843717),y=e.i(4987761),b=e.i(7743427),v=e.i(9471356),N=e.i(9588822),C=e.i(57106);function I(e){let{integration:i,onAccept:a,onBack:n,cancelLabel:l}=e;return(0,t.jsx)(x.ModalWrapper,{SuccessAction:(0,t.jsx)(s.Modal.Action,{buttonType:"submit",onClick:()=>{let e=new Date().toISOString(),t={};i.eulaDocUri&&(t.eula=e),i.privacyDocUri&&(t.privacy=e),a(t)},children:"Accept and Continue"}),cancelLabel:l,header:(0,t.jsx)(x.ModalWrapperHeader,{title:"Accept Terms & Conditions",subtitle:"Please review the following policies."}),onBack:n,children:(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial",children:[(0,t.jsx)("p",{children:'By clicking "Accept and Continue", you agree to:'}),(0,t.jsxs)("p",{className:"text-copy-14",children:[(0,t.jsx)("span",{className:"pr-1",children:"• "}),(0,t.jsx)(C.Link,{external:!0,href:"/legal/integration-marketplace-end-users-addendum",type:"primary",children:"Vercel Integration Marketplace End User Addendum"})]}),i.eulaDocUri?(0,t.jsxs)("p",{className:"text-copy-14",children:[(0,t.jsx)("span",{className:"pr-1",children:"• "}),(0,t.jsxs)(C.Link,{external:!0,href:i.eulaDocUri,type:"primary",children:[i.name," EULA"]})]}):null,i.privacyDocUri?(0,t.jsxs)("p",{className:"text-copy-14",children:[(0,t.jsx)("span",{className:"pr-1",children:"• "}),(0,t.jsxs)(C.Link,{external:!0,href:i.privacyDocUri,type:"primary",children:[i.name," Privacy Policy"]})]}):null]})})})}function k(e){let{configuration:i,transferRequest:a,onCancel:n,onDone:s}=e,l=(0,o.useTeam)(),{data:c,isLoading:d}=(0,b.useIntegration)(i.integrationId),u=l.team,h=l.isLoading||d,[x,m]=(0,r.useTransition)(),p=u&&c;return(0,t.jsx)(f.DisabledContext.Provider,{value:h||x,children:p?(0,t.jsx)(T,{configuration:i,transferRequest:a,team:u,integration:c,onCancel:n,onDone:s,isTransitioning:x,startTransition:m}):(0,t.jsx)(w,{cancelLabel:"Cancel",onBack:n})})}function w(e){let{onBack:i,cancelLabel:a}=e;return(0,t.jsx)(x.ModalWrapper,{SuccessAction:(0,t.jsx)(s.Modal.Action,{buttonType:"submit",disabled:!0,loading:!0,children:"..."}),cancelLabel:a,header:(0,t.jsx)(x.ModalWrapperHeader,{subtitle:(0,t.jsx)(g.Skeleton,{height:"20px",width:80}),title:"Transfer Your Account to Vercel"}),onBack:i,children:(0,t.jsx)(g.Skeleton,{height:"40px",width:400})})}let T=(0,N.withStripe)(function(e){let{configuration:i,transferRequest:a,team:n,integration:s,onCancel:l,onDone:o,isTransitioning:h,startTransition:m}=e,[g,f]=(0,r.useState)("policies"),[b,N]=(0,r.useState)({}),C=a.billingPlan,k=i.id,{data:w}=(0,j.useInstallationPaymentMethodState)({integrationConfigurationId:k}),{createAuthorization:T}=(0,y.useMarketplaceBillingAuthorizationApi)(),S=(0,y.useAwaitAuthorization)(),[A,P]=(0,r.useState)(null),[M,L]=(0,r.useState)(!1),[_,R]=(0,r.useState)(void 0),[E,D]=(0,r.useState)(!1),O=(0,t.jsx)(x.ModalWrapperHeader,{subtitle:(0,t.jsx)("span",{className:"flex flex-row items-center justify-start gap-1 flex-initial",children:i.name||i.slug}),title:"Transfer Your Account to Vercel"}),F=()=>{f("provisioning"),L(!1),R(void 0);let e=async()=>{try{let e=await T(n.id,{integrationIdOrSlug:i.integrationId,integrationConfigurationId:i.id,transferRequestId:a.requestId,billingPlanId:a.billingPlan.id,metadata:{},source:"marketplace"});if(P(e?.id??null),!e)throw Error("Authorization creation failed");let t=await S(n.id,e.id);if("succeeded"!==t.status)return;await (0,v.clientTypedFetchData)("/v1/integrations/installations/{integrationConfigurationId}/transfers/to-marketplace","post",{teamId:n.id,integrationConfigurationId:i.id},{requestId:a.requestId,authorizationId:e.id,acceptedPolicies:b}),L(!0)}catch(e){R("Failed to transfer account")}};m(()=>{e()})};switch(g){case"policies":return(0,t.jsx)(I,{integration:s,onAccept:e=>{N(e),f("confirm")},onBack:l,cancelLabel:"Cancel"});case"confirm":return(0,t.jsx)(p,{configuration:i,billingPlan:C,header:O,onNext:()=>{!w||(0,d.getIsPaymentMethodStepNeeded)(n,w,C)||E?f("payment-method"):F()},onBack:l,cancelLabel:"Cancel"});case"payment-method":return w?(0,t.jsx)(c.PaymentMethodStep,{header:O,installationId:k,onBack:()=>f("confirm"),onNext:()=>{D(!1),F()},paymentMethodState:w,requireNew:E,team:n}):null;case"provisioning":return(0,t.jsx)(u.ProvisioningStep,{authorizationId:A,complete:M,error:_,header:O,isTransitioning:!M||h,onBack:()=>f("payment-method"),onChangePaymentMethod:()=>{D(!0),f("payment-method")},onNext:()=>{m(()=>{o()})},successMessage:"Your account has been transferred successfully",teamId:n.id});default:return null}});var S=e.i(8238875),A=e.i(1509709),P=e.i(4011256);e.s(["RequestTransferToVercelNotification",0,function(e){let{integration:c,configurationId:d}=e,[u,h]=(0,r.useState)(!1),[x,m]=(0,r.useTransition)(),{data:p,mutate:g}=(0,i.default)(d),f=(0,l.useToasts)(),j=(0,S.useRouter)(),y=(0,o.useTeam)().team,b=p?.transferRequest;if(!p||b?.kind!=="transfer-to-marketplace")return null;let N=()=>{h(!1)},C=async()=>{try{await (0,v.clientTypedFetchData)("/v1/integrations/installations/{integrationConfigurationId}/transfers/discard","post",{teamId:y?.id,integrationConfigurationId:p.id},{requestId:b.requestId}),await g()}catch(e){(0,A.captureException)(e),f.error("Failed to discard transfer request. Please try again.")}};return(0,t.jsxs)("section",{className:"mx-auto my-0 max-w-[520px] rounded-lg p-4",children:[(0,t.jsxs)(a.Card,{border:!0,shadow:!0,className:"max-w-[600px] p-4",children:[(0,t.jsx)("p",{className:"text-heading-24",children:"Transfer your account from ACME to Vercel"}),(0,t.jsx)("p",{className:"text-copy-14",children:"All your resources will be transferred to Vercel. After the transfer is complete, your billing will be handled by Vercel and you’ll use their platform to manage your resources."}),(0,t.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,t.jsx)(n.Button,{onClick:()=>{C()},disabled:x,type:"secondary",children:"Discard"}),(0,t.jsx)(n.Button,{onClick:()=>{m(()=>{h(!0)})},loading:x,className:"ml-auto",children:"Proceed with transfer"})]})]}),(0,t.jsx)(s.Modal,{active:u,onClickOutside:N,children:(0,t.jsx)(k,{configuration:p,transferRequest:b,onDone:()=>{N(),j.replace((0,P.getIntegrationInstallationLink)(y?.slug||"",c.slug,p.id))},onCancel:N})})]})}],943709)},417098,e=>{"use strict";var t=e.i(847684),i=e.i(5328446),a=e.i(4138437),n=e.i(2504781),s=e.i(6891161),l=e.i(455575),r=e.i(7185353),o=e.i(8238875),c=e.i(5338940),d=e.i(9471356),u=e.i(1509709),h=e.i(2452025);function x(e){let{configuration:i,header:a,onNext:n,onBack:l,cancelLabel:r}=e;return(0,t.jsx)(h.ModalWrapper,{SuccessAction:(0,t.jsx)(s.Modal.Action,{onClick:n,children:"Confirm"}),cancelLabel:r,header:a,onBack:l,children:(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:(0,t.jsx)("p",{className:"text-[16px] leading-[24px] font-medium",children:"some information on the transfer"})})})}var m=e.i(5255926),p=e.i(9544652),g=e.i(8735244);function f(e){let{header:i,isTransitioning:a,onNext:n,onBack:l,complete:r,error:o}=e;return(0,t.jsx)(h.ModalWrapper,{SuccessAction:(0,t.jsx)(s.Modal.Action,{disabled:!r,loading:!r||a,onClick:n,children:r?"Done":"Processing"}),cancelLabel:"Back",disableCancel:!r,header:i,onBack:l,children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[r?(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",children:"Provisioning complete."}):(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[(0,t.jsx)(g.Spinner,{size:16}),(0,t.jsx)("p",{className:"text-[16px] leading-[24px] font-medium",children:"Processing"})]}),o?(0,t.jsx)("p",{className:"text-copy-14",children:o}):null]})})}function j(e){let{configuration:i,transferRequest:a,onCancel:n,onDone:s}=e,l=(0,c.useTeam)(),o=l.team,d=l.isLoading,[u,h]=(0,r.useTransition)();return(0,t.jsx)(p.DisabledContext.Provider,{value:d||u,children:o?(0,t.jsx)(y,{configuration:i,transferRequest:a,team:o,onCancel:n,onDone:s,isTransitioning:u,startTransition:h}):(0,t.jsx)(b,{cancelLabel:"Cancel",onBack:n})})}function y(e){let{configuration:i,transferRequest:a,team:n,onCancel:s,onDone:l,isTransitioning:o,startTransition:c}=e,[u,m]=(0,r.useState)("confirm"),[p,g]=(0,r.useState)(!1),[j,y]=(0,r.useState)(void 0),b=(0,t.jsx)(h.ModalWrapperHeader,{subtitle:(0,t.jsx)("span",{className:"flex flex-row items-center justify-start gap-1 flex-initial",children:i.name||i.slug}),title:"Transfer Your Account from Vercel"});switch(u){case"confirm":return(0,t.jsx)(x,{configuration:i,header:b,onNext:()=>{m("processing"),g(!1),y(void 0);let e=async()=>{try{await (0,d.clientTypedFetchData)("/v1/integrations/installations/{integrationConfigurationId}/transfers/from-marketplace","post",{teamId:n.id,integrationConfigurationId:i.id},{requestId:a.requestId}),g(!0)}catch(e){y("Failed to transfer account")}};c(()=>{e()})},onBack:s,cancelLabel:"Cancel"});case"processing":return(0,t.jsx)(f,{header:b,isTransitioning:o,onNext:()=>{c(()=>{l()})},onBack:s,complete:p,error:j});default:return null}}function b(e){let{onBack:i,cancelLabel:a}=e;return(0,t.jsx)(h.ModalWrapper,{SuccessAction:(0,t.jsx)(s.Modal.Action,{buttonType:"submit",disabled:!0,loading:!0,children:"..."}),cancelLabel:a,header:(0,t.jsx)(h.ModalWrapperHeader,{subtitle:(0,t.jsx)(m.Skeleton,{height:"20px",width:80}),title:"Transfer Your Account from Vercel"}),onBack:i,children:(0,t.jsx)(m.Skeleton,{height:"40px",width:400})})}e.s(["RequestTransferFromVercelNotification",0,function(e){let{integration:h,configurationId:x}=e,[m,p]=(0,r.useState)(!1),[g,f]=(0,r.useTransition)(),{data:y,mutate:b}=(0,i.default)(x),v=(0,l.useToasts)(),N=(0,o.useRouter)(),C=(0,c.useTeam)().team,I=y?.transferRequest;if(!y||I?.kind!=="transfer-from-marketplace")return null;let k=()=>{p(!1)},w=async()=>{try{await (0,d.clientTypedFetchData)("/v1/integrations/installations/{integrationConfigurationId}/transfers/discard","post",{teamId:C?.id,integrationConfigurationId:y.id},{requestId:I.requestId}),await b()}catch(e){(0,u.captureException)(e),v.error("Failed to discard transfer request. Please try again.")}};return(0,t.jsxs)("section",{className:"mx-auto my-0 max-w-[520px] rounded-lg p-4",children:[(0,t.jsxs)(a.Card,{border:!0,shadow:!0,className:"max-w-[600px] p-4",children:[(0,t.jsxs)("p",{className:"text-heading-24",children:["Transfer your account from ",h.name," to Vercel"]}),(0,t.jsxs)("p",{className:"text-copy-14",children:["All your resources will be transferred to ",h.name,". After the transfer is complete, your billing will be handled by"," ",h.name," and you’ll use their platform to manage your resources."]}),(0,t.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,t.jsx)(n.Button,{onClick:()=>{w()},disabled:g,type:"secondary",children:"Discard"}),(0,t.jsx)(n.Button,{onClick:()=>{f(()=>{p(!0)})},loading:g,className:"ml-auto",children:"Proceed with transfer"})]})]}),(0,t.jsx)(s.Modal,{active:m,onClickOutside:k,children:(0,t.jsx)(j,{configuration:y,transferRequest:I,onDone:()=>{k(),N.replace(`/${C?.slug}/~/integrations/${h.slug}/${x}`)},onCancel:k})})]})}],417098)},3942353,e=>{"use strict";var t=e.i(847684),i=e.i(7185353),a=e.i(2504781),n=e.i(6318858),s=e.i(5366204),l=e.i(1114103),r=e.i(8436238);e.s(["IntegrationPublicUrlShareButton",0,function(e){let{integrationSlug:o}=e,[c,d]=(0,i.useState)(!1);async function u(){let e=`https://vercel.com/marketplace/${o}`;try{await navigator.clipboard.writeText(e),d(!0),setTimeout(()=>{d(!1)},2e3)}catch(e){}}return o?(0,t.jsx)(l.AnimatePresence,{mode:"wait",children:c?(0,t.jsxs)(r.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.1},className:"top-px flex h-4 items-center gap-1 p-1",children:[(0,t.jsx)(n.Check,{color:"green-700",size:12}),(0,t.jsx)("span",{className:"text-xs leading-none text-green-700",children:"URL copied"})]},"success"):(0,t.jsx)(r.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.1},className:"flex h-4 items-center",children:(0,t.jsx)(a.Button,{variant:"unstyled",className:"top-px flex items-center rounded p-1 text-[var(--accents-3)] transition-all duration-300 hover:bg-gray-200 disabled:hover:cursor-default disabled:hover:bg-transparent [&>span]:inline-flex [&>span]:h-fit [&>span]:items-center [&>span]:justify-center [&>span]:p-0",size:"tiny",onClick:()=>{u()},children:(0,t.jsx)(s.Link,{size:12})})},"normal")}):null}])},3646190,e=>{"use strict";var t=e.i(847684),i=e.i(5328446),a=e.i(7426968);e.s(["InstallationStatus",0,function(e){let{configurationId:n}=e,{data:s}=(0,i.default)(n);return(0,t.jsx)(a.NotificationCallout,{notification:s?.notification,ssoParams:{integrationConfigurationId:s?.id,teamIdOrSlug:s?.teamId}})}])},2007186,e=>{e.v({detailsSection:"details-sidebar-module__IOjKpW__detailsSection",detailsWrapper:"details-sidebar-module__IOjKpW__detailsWrapper"})},2171370,e=>{"use strict";var t=e.i(847684),i=e.i(5255926),a=e.i(5468328),n=e.i(4011256),s=e.i(57106);e.i(6887680);var l=e.i(9219571),r=e.i(6810699),o=e.i(2007186),c=e.i(9722978);function d(e){let{title:i,value:n,truncate:s,wrapTitle:l,tooltip:r}=e;return n?(0,t.jsx)("div",{className:o.default.detailsSection,children:(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-between gap-4 flex-initial",children:[(0,t.jsx)(a.Tooltip,{text:r,children:(0,t.jsx)("p",{className:(0,c.default)("text-copy-14",l&&"text-wrap"),children:i})}),(0,t.jsx)("p",{className:(0,c.default)("text-copy-14",s&&"truncate"),children:n})]})}):null}function u(){return(0,t.jsx)("div",{className:o.default.detailsSection,children:(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-between gap-4 flex-initial",children:[(0,t.jsx)(i.Skeleton,{height:18,width:"40%"}),(0,t.jsx)(i.Skeleton,{height:18,width:"40%"})]})})}e.s(["DetailSidebar",0,function(e){let{integration:i,Support:a}=e;if(!i)return(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsx)(u,{}),(0,t.jsx)(u,{}),(0,t.jsx)(u,{}),(0,t.jsx)(u,{})]});let n="object"==typeof i&&"products"in i,l="single-product"===i.layout,r=[];if(n&&l){let e=i.products?.[0];r=e?.resourceLinks??[]}return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d,{title:"Developer",value:i.createdBy}),(0,t.jsx)(d,{title:"Website",truncate:!0,value:i.website?(0,t.jsx)(s.Link,{href:i.website,type:"highlight",children:i.website.replace(/https?:\/\//,"").replace(/\/$/,"")}):null}),(0,t.jsx)(d,{title:"Documentation",value:i.documentationUri?(0,t.jsx)(s.Link,{external:!0,href:i.documentationUri,type:"highlight",children:"Read"}):null}),(0,t.jsx)(d,{title:"EULA",value:i.eulaDocUri?(0,t.jsx)(s.Link,{external:!0,href:i.eulaDocUri,type:"highlight",children:"Read"}):null}),(0,t.jsx)(d,{title:"Privacy Policy",value:i.privacyDocUri?(0,t.jsx)(s.Link,{external:!0,href:i.privacyDocUri,type:"highlight",children:"Read"}):null}),a??(0,t.jsx)(d,{title:"Support",tooltip:"Need help? Reach out to your integration partner for support.",truncate:!0,value:i.supportUri?(0,t.jsxs)(s.Link,{external:!0,href:i.supportUri,prefetch:!1,type:"highlight",children:["Open in ",i.name]}):i.supportContactEmail?(0,t.jsx)(s.Link,{external:!0,href:i.supportContactEmail.includes("@")?`mailto:${i.supportContactEmail}`:i.supportContactEmail,type:"highlight",children:i.supportContactEmail}):null,wrapTitle:!0}),r.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-heading-20 mt-6",children:"Resources"}),(0,t.jsx)("div",{children:r.map(e=>(0,t.jsx)(d,{title:e.title,value:(0,t.jsx)(s.Link,{href:e.href,type:"highlight",external:!0,children:"Read"})},e.title))})]})]})},"MarketplaceSidebarBalance",0,function(e){let{configuration:i}=e,{data:a}=(0,l.useMarketplaceBillingBalance)(i.id),s=a?.balance?.currencyValueInCents??i.billingData?.credit?.balanceTotalCent;return void 0===s?null:(0,t.jsx)(d,{title:"Prepaid Balance",value:(0,n.formatMarketplaceBillingTotal)(s/100)})},"MarketplaceSidebarDetailSection",0,d,"MarketplaceSidebarResourceCount",0,function(e){let{integrationIdOrSlug:a,integrationConfigurationId:n,teamSlug:s}=e,{data:l}=(0,r.useResourceList)({teamSlug:s,integrationIdOrSlug:a,integrationConfigurationId:n});return(0,t.jsx)(d,{title:"Installed products",value:l?.stores.length??(0,t.jsx)(i.Skeleton,{height:20,width:10})})}])},3967785,e=>{"use strict";var t=e.i(847684),i=e.i(7185353),a=e.i(8248823),n=e.i(8761240),s=e.i(2504781),l=e.i(455575),r=e.i(5140444),o=e.i(1857939),c=e.i(57106),d=e.i(1119178),u=e.i(2704354);function h(e){let{integration:i}=e,{isLoggedOut:a}=(0,o.useIsLoggedIn)();return(0,u.isCodeRepository)(i)?(0,t.jsxs)(c.ButtonLink,{href:a?"/signup":"/new",children:["Continue with ",i.name]}):null}function x(e){let{integration:i}=e;return(0,u.hasCustomCta)(i)&&i.ctaUrl?(0,t.jsx)(c.ButtonLink,{href:i.ctaUrl,children:i.ctaText}):null}function m(e){let{integration:o}=e,{user:h}=(0,r.useUser)(),x=(0,l.useToasts)(),[m,p]=(0,i.useState)(!1),[g,f]=(0,i.useState)(!1),j=async()=>{if(h?.email&&h.uid){f(!0);try{await (0,u.requestIntegration)({userId:h.uid,email:h.email,slug:o.slug}),x.success("Request submitted successfully."),p(!0)}catch(e){x.error((0,a.errorToString)(e))}finally{f(!1)}}};return h?(0,t.jsx)(s.Button,{disabled:g||m,loading:g,onClick:(0,d.promiseToCallback)(j),prefix:m?(0,t.jsx)(n.CheckCircleFill,{color:"green-700"}):void 0,children:m?"Requested":"Request Integration"}):(0,t.jsx)(c.ButtonLink,{href:"#request",children:"Request Integration"})}e.s(["ContentfulIntegrationButton",0,function(e){let{integration:i}=e;return(0,u.isCodeRepository)(i)||(0,u.hasCustomCta)(i)?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h,{integration:i}),(0,t.jsx)(x,{integration:i})]}):(0,t.jsx)(m,{integration:i})}])},9811698,e=>{e.v({button:"request-form-module__8eWAma__button",label:"request-form-module__8eWAma__label",wrapper:"request-form-module__8eWAma__wrapper"})},3252593,e=>{e.v({content:"contentful-integration-details-module__10dLUa__content","mdx-container":"contentful-integration-details-module__10dLUa__mdx-container"})},5267109,e=>{"use strict";var t=e.i(847684),i=e.i(1857939),a=e.i(7775029),n=e.i(2704354),s=e.i(7185353),l=e.i(8248823),r=e.i(2504781),o=e.i(3500331),c=e.i(9318197),d=e.i(455575),u=e.i(9811698);function h(e){let{children:i}=e;return(0,t.jsx)("span",{className:u.default.label,children:i})}let x={background:"var(--input-background)"};function m(e){let{slug:i}=e,[a,m]=(0,s.useState)(""),[p,g]=(0,s.useState)(""),[f,j]=(0,s.useState)(""),[y,b]=(0,s.useState)(!1),v=(0,d.useToasts)(),N=async e=>{e.preventDefault(),b(!0);try{await (0,n.requestIntegration)({firstName:a,lastName:p,email:f,slug:i}),m(""),g(""),j(""),v.success("Request submitted successfully.")}catch(e){v.error((0,l.errorToString)(e))}finally{b(!1)}};return(0,t.jsx)("div",{className:u.default.wrapper,children:(0,t.jsxs)("form",{onSubmit:N,children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsx)(o.Input,{disabled:y,id:"integrations-first-name",label:(0,t.jsx)(h,{children:"First Name"}),maxLength:40,name:"firstName",onChange:e=>m(e.target.value),pattern:".*\\S+.*",placeholder:"Jane",required:!0,style:x,title:"This field cannot be blank.",value:a,width:"100%"}),(0,t.jsx)(o.Input,{disabled:y,id:"integrations-last-name",label:(0,t.jsx)(h,{children:"Last Name"}),maxLength:40,name:"lastName",onChange:e=>g(e.target.value),pattern:".*\\S+.*",placeholder:"Doe",required:!0,style:x,title:"This field cannot be blank.",value:p,width:"100%"})]}),(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:(0,t.jsx)(o.Input,{disabled:y,id:"integrations-email",label:(0,t.jsx)(h,{children:"Email"}),maxLength:40,name:"email",onChange:e=>j(e.target.value),placeholder:"janedoe@example.com",required:!0,style:x,title:"This field cannot be blank.",typeName:"email",value:f,width:"100%"})})]}),(0,t.jsx)(c.Spacer,{y:2}),(0,t.jsx)("div",{className:u.default.button,children:(0,t.jsx)(r.Button,{loading:y,size:"large",children:"Request Integration"})})]})})}var p=e.i(3252593);e.s(["RequestContentfulIntegration",0,function(e){let{integration:s}=e,{isLoading:l,isLoggedOut:r}=(0,i.useIsLoggedIn)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsx)("p",{className:"text-heading-20",children:"Overview"}),(0,t.jsx)("div",{className:p.default["mdx-container"],children:(0,a.renderContentfulDocument)(s.overview)})]}),l||!r||(0,n.isCodeRepository)(s)?null:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsx)("div",{id:"request",children:(0,t.jsx)("p",{className:"text-heading-20",children:"Request Integration"})}),(0,t.jsx)(m,{slug:s.slug})]})]})}],5267109)},1003898,e=>{"use strict";var t=e.i(847684),i=e.i(7185353),a=e.i(5338940),n=e.i(7275883),s=e.i(6881349),l=e.i(8161149);e.i(2815631);var r=e.i(5225151),o=e.i(2800132),c=e.i(266062),d=e.i(1091997),u=e.i(7909933),h=e.i(277234),x=e.i(4244280);e.i(3092247);var m=e.i(397510),p=e.i(4011256);function g(e,t,i){let a=e.find(e=>e.name===t);return a?(0,p.getResourceDashboardLink)(a,{teamSlug:i,path:"usage"}):""}function f(e){let{dimensions:i=4}=e;return(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-5 flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between gap-2 flex-initial",children:[(0,t.jsx)("p",{className:"text-heading-20",children:"Usage Report"}),(0,t.jsxs)(s.Combobox,{clearable:!1,noInputPrefix:!0,value:"week",width:140,children:[(0,t.jsx)(s.Combobox.Input,{}),(0,t.jsx)(s.Combobox.List,{children:(0,t.jsx)(s.Combobox.Option,{value:"week",children:"Last 7 days"})})]})]}),(0,t.jsx)(r.MarketplaceChartPlaceholder,{description:"This chart shows the cost per product over time.",dimensions:i,title:"Cost per Product"})]})}e.s(["MarketplaceBillingChart",0,function(e){var p;let{integration:j,stores:y,teamSlug:b,integrationConfigurationId:v,integrationSlug:N,resourceId:C}=e,[I,k]=(0,i.useState)("week"),{team:w}=(0,a.useTeam)(),T=(p=w?{integrationConfigurationId:v,teamId:w.id,period:I}:null,(0,u.default)(()=>{if(!p)return null;let{integrationConfigurationId:e,teamId:t,period:i}=p,a=new URLSearchParams;return a.append("teamId",t),a.append("period",i),`${x.API_INTEGRATION_CONTROLLER_V2}/installations/${e}/billing/data/series?${a.toString()}`},h.fetchAPI)),S=(0,i.useMemo)(()=>{let e,t,i;if(!T.data?.byResource||!T.data.installation)return null;if(T.data.installation.credit?.balanceTotalCent.length){let t=new Map;T.data.installation.credit.balanceTotalCent.forEach(e=>{let i=new Date(e.timestamp).getTime();t.has(i)||t.set(i,{date:i,records:{}});let a=t.get(i);a&&(a.records.Total=e.value/100)}),T.data.byResource.forEach(e=>{let i=e.externalResourceId;i&&e.credit?.balanceTotalCent.length&&e.credit.balanceTotalCent.forEach(e=>{let a=new Date(e.timestamp).getTime();t.has(a)||t.set(a,{date:a,records:{}});let n=t.get(a),s=y.find(e=>e.externalResourceId===i)?.name;n&&s&&(n.records[s]=e.value/100)})}),e=t.size>0?Array.from(t.values()):void 0}if(T.data.installation.spending?.totalCent.length){let e=new Map;T.data.installation.spending.totalCent.forEach(t=>{let i=new Date(t.timestamp).getTime();e.has(i)||e.set(i,{date:i,records:{}});let a=e.get(i);a&&(a.records.Total=t.value/100)}),T.data.byResource.forEach(t=>{let i=t.externalResourceId;i&&t.spending?.totalCent.length&&t.spending.totalCent.forEach(t=>{let a=new Date(t.timestamp).getTime();e.has(a)||e.set(a,{date:a,records:{}});let n=e.get(a),s=y.find(e=>e.externalResourceId===i)?.name;n&&s&&(n.records[s]=t.value/100)})}),t=e.size>0?Array.from(e.values()):void 0}if(T.data.installation.usage?.byMetrics.length){let e=new Map;T.data.installation.usage.byMetrics.forEach(t=>{t.usageItems.forEach(i=>{let a=e.get(t.name)?.map;a||(a=new Map,e.set(t.name,{type:t.type,units:t.units,map:a}));let n=new Date(i.timestamp).getTime();a.has(n)||a.set(n,{date:n,records:{}});let s=a.get(n);s&&(s.records.Total=i.value)})}),i=Array.from(e.entries()).map(e=>{let[t,{type:i,units:a,map:n}]=e;return{metric:{name:t,type:i,units:a},data:Array.from(n.values())}})}return{noData:!e&&!t&&!i,prepayment:e,subscription:t,usageByMetric:i}},[T.data,y]);return T.isLoading?(0,t.jsx)(f,{dimensions:y.length}):!S||S.noData?(0,t.jsx)(l.EmptyState.Root,{description:"edgedb"===N?"There are no data available yet for this period.":"Usage tracking is not yet available for this service.",icon:(0,t.jsx)(l.EmptyState.Icon,{icon:(0,t.jsx)(n.ChartBarPeak,{}),size:32}),paddingY:200,secondary:!0,title:"No data available",children:(0,t.jsx)(m.OpenInPartnerDashboardButton,{componentType:"button",buttonVariant:"secondary",integrationConfigurationId:v,label:`See usage in ${j.name}`,teamIdOrSlug:w?.id,path:"usage"})}):(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-5 flex-initial",children:[C?(0,t.jsx)(o.ResourceUsageCharts,{resourceId:C}):(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between gap-2 flex-initial",children:[(0,t.jsx)("p",{className:"text-heading-20",children:"Usage Report"}),(0,t.jsxs)(s.Combobox,{clearable:!1,noInputPrefix:!0,onChange:e=>{e&&k(e)},value:I,width:140,children:[(0,t.jsx)(s.Combobox.Input,{}),(0,t.jsxs)(s.Combobox.List,{children:[(0,t.jsx)(s.Combobox.Option,{value:"week",children:"Last 7 days"}),(0,t.jsx)(s.Combobox.Option,{value:"month",children:"Last month"}),(0,t.jsx)(s.Combobox.Option,{value:"year",children:"Last year"})]})]})]}),S.prepayment?(0,t.jsx)(d.MarketplaceLineChart,{chartData:S.prepayment,description:"This chart shows the balance over time.",formatter:(0,c.formatUsageValueByUnit)("$"),legendSuffix:"Balance",linkMapper:e=>g(y,e,b),title:"Balance"}):null,S.subscription?(0,t.jsx)(d.MarketplaceLineChart,{chartData:S.subscription,description:"This chart shows the cost per product over time.",formatter:(0,c.formatUsageValueByUnit)("$"),legendSuffix:"Total Cost",linkMapper:e=>g(y,e,b),title:"Cost per Product"}):null,S.usageByMetric?.map(e=>"total"===e.metric.type?(0,t.jsx)(d.MarketplaceLineChart,{chartData:e.data,description:`This chart shows the ${e.metric.name} over time.`,formatter:(0,c.formatUsageValueByUnit)(e.metric.units),legendSuffix:`Total ${e.metric.name}`,title:e.metric.name},e.metric.name):(0,t.jsx)(r.MarketplaceBarChart,{chartData:e.data,description:`This chart shows the ${e.metric.name} over time.`,formatter:(0,c.formatUsageValueByUnit)(e.metric.units),legendSuffix:`Total ${e.metric.name}`,title:e.metric.name},e.metric.name))]})},"MarketplaceBillingChartPlaceholder",0,f],1003898)},773959,e=>{"use strict";var t=e.i(847684),i=e.i(2504781),a=e.i(3869281),n=e.i(7137884),s=e.i(4557026),l=e.i(8517043),r=e.i(1232681),o=e.i(3500331),c=e.i(3895030),d=e.i(9792418),u=e.i(5468328),h=e.i(4585051),x=e.i(8735244),m=e.i(8522580),p=e.i(3998369),g=e.i(5806401),f=e.i(762945),j=e.i(5169576),y=e.i(2560270),b=e.i(7399351),v=e.i(6942035),N=e.i(5761705),C=e.i(9156420),I=e.i(7749291),k=e.i(1821888),w=e.i(9598279),T=e.i(7185353),S=e.i(8238875),A=e.i(6352514),P=e.i(4759942),M=e.i(8042625),L=e.i(277234),_=e.i(4244280),R=e.i(1119178),E=e.i(4004502),D=e.i(4011256),O=e.i(57106);e.i(6887680);var F=e.i(6810699),B=e.i(553769),U=e.i(3758860),q=e.i(9349058),$=e.i(8525850),W=e.i(9243747);e.i(7037808);var V=e.i(5098510),z=e.i(1574218),G=e.i(5074599);e.i(2886798);var Y=e.i(1055938),H=e.i(9186321);function K(e){return e.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}function Z(e){let{eulaLink:i,billingType:a,subscriptionEndDate:n,integrationName:s}=e;return(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14",children:["By clicking to uninstall, you acknowledge that you have read the"," ",(0,t.jsx)(O.Link,{external:!0,href:i,prefetch:!1,type:"primary",children:"EULA"}),"and understand your rights upon termination.","prepayment"===a?" Unused or prepaid credits may not be refunded in accordance with this provider's terms and policies.":"",n?` Your active subscription ends on ${n}. The provider may terminate it at any time in accordance with their terms and policies. The remaining period may not be refunded.`:""]}),(0,t.jsxs)("p",{className:"text-copy-14",children:["You're uninstalling ",s,", which will remove all associated"," ",s," products that have been installed. Projects connected to the following products will lose their access."]})]})}function J(e){let{loading:n,integration:l,open:r,onOpenChange:c,onCancel:d,onConfirm:u,billingType:h,eulaLink:m,singleResource:p,subscriptionEndDate:j,team:y,resourceStores:b,showSuccess:C,onDone:I,showError:k,errorMessage:w,onRetry:S,onClose:A}=e,P=(0,T.useRef)(null),[M,L]=(0,T.useState)(!1),[_,R]=(0,T.useState)(""),[E,D]=(0,T.useState)(!1);(0,T.useEffect)(()=>{r&&requestAnimationFrame(()=>{let e=Array.from(P.current?.elements??[]);e.find(e=>"INPUT"===e.tagName)?.focus()})},[r]);let F=(0,T.useCallback)(e=>{e.preventDefault(),!n&&P.current?.checkValidity()&&M&&u()},[u,M,_,n]);return(0,t.jsx)(g.Sheet,{onOpenChange:c,open:r,children:(0,t.jsxs)(g.SheetContent,{className:"m-3 h-[calc(100%-1.5rem)] w-[calc(100%-1.5rem)] overflow-visible rounded-[1rem] bg-white p-0 lg:w-[600px] xl:w-[640px] sm:max-w-[auto]",side:"right",children:[(0,t.jsx)(g.SheetClose,{asChild:!0,children:(0,t.jsx)(i.Button,{"aria-label":"Close",shape:"square",size:"medium",svgOnly:!0,type:"tertiary",className:"absolute top-4 right-4 z-20",children:(0,t.jsx)(v.Cross,{})})}),(0,t.jsxs)("div",{className:"flex h-full flex-col overflow-hidden rounded-[1rem]",children:[(0,t.jsx)(g.SheetHeader,{className:"sticky top-0 z-10 bg-white p-6 pb-0",children:(0,t.jsx)(g.SheetTitle,{children:"Uninstall Integration"})}),C?(0,t.jsx)("div",{className:"flex h-full flex-col items-center justify-center p-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(N.CheckCircle,{className:"w-16 h-16 text-green-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-heading-20 mb-2",children:"Integration Uninstalled"}),(0,t.jsxs)("p",{className:"text-copy-14 text-gray-700 mb-4 max-w-md",children:[(0,t.jsx)("strong",{children:l.name})," has been uninstalled from"," ",(0,t.jsx)("strong",{children:y.name}),"."]}),(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsx)(s.Feedback,{copy:"Want to tell us more?",label:"integrations-post-uninstall",siteType:"front",type:"inline",onFeedbackSubmit:I,onFeedbackFormOpen:()=>{D(!0)},onFeedbackFormClose:()=>{D(!1)},fullWidth:!0})}),!E&&(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)(i.Button,{onClick:I,children:"Done"})})]})}):k?(0,t.jsx)("div",{className:"flex h-full flex-col items-center justify-center p-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(f.Warning,{className:"w-16 h-16 text-red-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-heading-20 mb-2",children:"Uninstall Paused"}),(0,t.jsx)("p",{className:"text-copy-14 text-gray-700 mb-6 max-w-md",children:w||"An unexpected error occurred while uninstalling the integration. Please try again."}),(0,t.jsxs)("div",{className:"flex justify-center gap-3",children:[(0,t.jsx)(i.Button,{onClick:S,type:"default",children:"Try Again"}),(0,t.jsx)(i.Button,{onClick:A,type:"secondary",children:"Close"})]})]})}):n?(0,t.jsx)("div",{className:"flex h-full flex-col items-center justify-center p-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"flex justify-center mb-4",children:(0,t.jsx)(x.Spinner,{})}),(0,t.jsx)("p",{className:"text-[18px] leading-[24px] font-semibold mb-2",children:"Uninstalling Integration"}),(0,t.jsx)("p",{className:"text-copy-14 text-gray-700",children:"Removing resources and cleaning up your account..."})]})}):(0,t.jsxs)("form",{onSubmit:F,ref:P,className:"flex flex-1 min-h-0 flex-col",children:[(0,t.jsx)("div",{className:"flex-1 overflow-y-auto px-6 pt-4",children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsx)(Z,{eulaLink:m,billingType:h,subscriptionEndDate:j,integrationName:l.name}),b&&b.length>0?(0,t.jsx)(X,{resourceStores:b,teamSlug:y.slug}):(0,t.jsx)(Q,{integrationName:l.name})]}),p?(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14",children:[z.PRODUCT," will"," ",(0,t.jsxs)("b",{children:["delete your"," ",(0,G.getProductNameAndResourceTitle)(p.product)]}),", along with all of its items. Any projects connected to this"," ",(0,G.getResourceTitleByProductForDeletion)(p.product)," ","will no longer be able to read its contents."]}),(0,t.jsxs)("p",{className:"text-copy-14",children:[z.PRODUCT," recommends that you ensure this"," ",(0,G.getResourceTitleByProductForDeletion)(p.product)," ","is no longer used by any projects before continuing."]})]}),p.projectsMetadata.length?(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial",children:[(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:"Deleting the database will cause the deletion of connections to the following projects"}),(0,t.jsx)(V.ProjectConnectionsListInModal,{connections:p.projectsMetadata})]}):null]}):null,(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:(0,t.jsx)("label",{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["Enter the integration name"," ",(0,t.jsx)("span",{className:"font-medium break-all text-gray-1000",children:l.slug})," ","to continue:"]}),(0,t.jsx)(o.Input,{"aria-label":"Resource Name",name:"resourceName",pattern:`\\s*${l.slug}\\s*`,required:!0,onChange:e=>R(e.target.value)})]})})}),(0,t.jsx)(a.Checkbox,{checked:M,onChange:e=>L(e.target.checked),iconClassName:"mt-0.5",labelClassName:"font-medium text-sm",children:(0,B.isAwsIntegration)(l)?(0,t.jsxs)(t.Fragment,{children:["I understand that this action is not reversible and will permanently remove this integration, all associated resources, and my ability to view AWS billing and account information. I understand that my AWS account will close and my content will be deleted in accordance with"," ",(0,t.jsx)(O.Link,{external:!0,href:"https://aws.amazon.com/agreement/",prefetch:!1,type:"primary",children:"AWS documentation"}),", and that this Vercel user will not be able to create another AWS integration."]}):(0,t.jsxs)(t.Fragment,{children:["I acknowledge that this action is not reversible and will delete my ",l.name," integration and all associated products listed above."]})})]})}),(0,t.jsxs)(g.SheetFooter,{className:"mt-auto bg-background-200 hidden sm:flex sm:justify-between border-t border-solid border-gray-alpha-400 gap-4 p-4 sticky bottom-0",children:[(0,t.jsx)(i.Button,{disabled:n,onClick:n?void 0:d,type:"secondary",typeName:"button",className:n?"opacity-50 cursor-not-allowed":"",children:"Cancel"}),(0,t.jsx)(i.Button,{typeName:"submit",disabled:n||!M||_!==l.slug,className:`inline-flex items-center justify-center rounded-md bg-red-600 px-4 py-2 text-sm font-medium text-white shadow ${n||!M||_!==l.slug?"opacity-50 cursor-not-allowed":"hover:bg-red-700"}`,children:n?"Uninstalling...":"Uninstall"})]})]})]})]})})}function Q(e){let{integrationName:i}=e;return(0,t.jsx)(Y.EmptyResourcesState,{title:(0,t.jsx)("span",{className:"text-[14px] font-medium",children:`No Installed ${i} Products`}),subtitle:(0,t.jsx)("span",{className:"text-[14px]",children:"You don't have any connected projects."}),Icon:(0,t.jsx)("div",{style:{width:"32px",height:"32px",backgroundColor:"var(--ds-background-100)",border:"1px solid var(--ds-gray-300)",borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,t.jsx)(C.Puzzle,{color:"gray-900"})})})}function X(e){let{resourceStores:i,teamSlug:a}=e,[n,s]=(0,T.useState)(new Set),[l,r]=(0,T.useState)(!1),o=(0,T.useCallback)(e=>{s(t=>{let i=new Set(t);return i.has(e)?i.delete(e):i.add(e),i})},[]),c=l?i:i.slice(0,3),d=i.length>3;return(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsx)("p",{className:"text-copy-16 font-medium text-gray-1000 pb-2",children:"Products that will be deleted"}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial border border-gray-200 rounded-md divide-y divide-gray-200 overflow-hidden",children:[(0,t.jsx)(m.Note,{fill:!0,type:"error",className:"rounded-none border-0 p-4",icon:(0,t.jsx)(j.Information,{size:16}),children:(0,t.jsx)("p",{className:"text-copy-14",children:"The following products will be deleted when you uninstall this integration."})}),c.map(e=>{let i=e.projectsMetadata&&e.projectsMetadata.length>0,s=n.has(e.id);return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"w-full flex items-center justify-between text-left bg-white relative",children:[(0,t.jsxs)(O.Link,{href:(0,$.getResourceDetailsPath)(e,a),target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 min-w-0 flex-1 p-4 hover:bg-gray-50 transition-colors",children:[(0,t.jsx)("div",{className:"w-4 h-4 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(h.Avatar,{hash:e.product.integration.icon,size:24})}),(0,t.jsx)("p",{className:"text-copy-14 font-medium truncate flex-1 min-w-0",title:e.name,children:e.name})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0 pt-3 pb-3 p-4 relative z-10",children:[(0,t.jsxs)("p",{className:`text-label-14 ${e.projectsMetadata?.length===0?"text-gray-600":"text-gray-900"}`,children:[e.projectsMetadata?.length||0," connected project",e.projectsMetadata?.length!==1?"s":""]}),(0,t.jsx)("button",{type:"button","aria-label":s?"Collapse project list":"Expand project list",onClick:()=>o(e.id),className:"p-0.5 w-6 h-6 flex items-center justify-center rounded bg-white hover:bg-gray-50 transition-colors",children:s&&i?(0,t.jsx)(b.ChevronUp,{className:"w-3 h-3"}):(0,t.jsx)(y.ChevronDown,{className:"w-3 h-3",color:i?"gray-900":"gray-600"})})]})]}),i&&s&&(0,t.jsx)("div",{className:"border-t border-gray-200 p-3 bg-gray-50",children:(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:e.projectsMetadata?.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2 pl-7",children:[(0,t.jsx)("p",{className:"text-copy-14 truncate",title:e.name,children:e.name}),(0,t.jsx)(O.Link,{href:`https://vercel.com/${a}/${e.name}`,className:"flex items-center gap-2 text-gray-600 hover:text-gray-800 text-sm pr-1",children:(0,t.jsx)(I.ExternalSmall,{className:"w-4 h-4"})},e.id)]},e.id))})})]},e.id)})]}),d&&(0,t.jsx)(p.ShowMore,{expanded:l,onClick:()=>r(!l),className:"w-full mx-0 mt-0"})]})}e.s(["MarketplaceUninstallIntegration",0,function(e){let{integration:a,configuration:s,team:o,canDelete:x,singleResource:m}=e,{data:p}=(0,F.useResourceList)({skip:"marketplace"!==s.installationType,integrationIdOrSlug:a.slug,integrationConfigurationId:s.id}),{deleteResource:g}=(0,q.useMutateResource)(),f=!!s.deleteRequestedAt,y=p?.stores.length??0,b=y>0,v=!x,N=(0,S.useRouter)(),[C,I]=(0,T.useState)(!1),[B,V]=(0,T.useState)(!1),[z,G]=(0,T.useState)(!1),[Y,Z]=(0,T.useState)(!1),[Q,X]=(0,T.useState)(""),ee=(0,T.useCallback)(()=>{let e=(0,D.getMarketplaceInstallationsLink)({teamSlug:o.slug});N.push(e)},[N,o.slug]),et=(0,T.useCallback)(()=>{I(!1),Z(!1),G(!1),X("")},[]),ei=(0,T.useCallback)(()=>{et(),ee()},[et,ee]),ea=(0,T.useCallback)(()=>I(!0),[]),en=(0,T.useCallback)(async()=>{if(v||B)return;V(!0);let e=(0,M.encode)({teamId:o.id});try{if("marketplace"===s.installationType&&p?.stores){let e=p.stores.map(async e=>{try{await g(e.id)}catch(t){console.warn(`Failed to delete resource ${e.id}:`,t)}});await Promise.allSettled(e)}"marketplace"===s.installationType?await (0,L.fetchAPI)(`${_.API_INTEGRATION_CONTROLLER_V2}/installations/${s.id}/uninstall${e}`,{method:"POST",body:{},throwOnHTTPError:!0}):await (0,L.fetchAPI)(`${_.API_INTEGRATION_CONTROLLER}/configuration/${s.id}${e}`,{method:"DELETE"}),P.analytics.track(A.AnalyticsEvent.INTEGRATION_CONFIGURATION_REMOVE_SUCCEEDED),P.analytics.track(A.AnalyticsEvent.INTEGRATION_UNINSTALLED,{integration_id:a.id,integration_slug:a.slug,source:"installation view",target:"team"}),G(!0)}catch(e){X((0,U.getUserIntegrationError)(e,"We ran into a temporary issue while cleaning up your resources. Please try again to finish uninstalling the integration.")),Z(!0)}finally{V(!1)}},[s,a.id,a.slug,o,et,ee,p?.stores,g,v,B]),es=(0,T.useCallback)(()=>{Z(!1),X(""),en()},[en]);(0,T.useEffect)(()=>{C&&P.analytics.track(A.AnalyticsEvent.INTEGRATION_CONFIGURATION_REMOVE_MODAL_OPENED)},[C]);let el="marketplace"===s.installationType?s.billingPlan?.type:void 0,er="marketplace"===s.installationType&&a.flags?.includes(H.LaunchDarklyIntegrationFlags.MarketplaceInstallationDeletePendingAt)&&s.billingData?.spending?.periodEnd?K(new Date(s.billingData.spending.periodEnd)):void 0,eo=s.deleteRequestedAt&&s.deleteRequestedAt>Date.now()?K((0,w.addDays)(s.deleteRequestedAt,1)):void 0,ec="marketplace"===s.installationType&&(0,W.getIntegrationOps)({integration:a}).isSingleProductLayout();return(0,t.jsxs)(l.Fieldset,{type:"error",children:[(0,t.jsxs)(n.FieldsetContent,{children:[(0,t.jsx)(d.FieldsetTitle,{children:"Uninstall Integration"}),!ec&&b?(0,t.jsxs)(c.FieldsetSubtitle,{color:"gray-900",children:["This integration has"," ",(0,t.jsxs)(k.Root,{children:[(0,t.jsx)(k.Trigger,{asChild:!0,children:(0,t.jsxs)(O.Link,{className:"inline-flex items-center gap-1 underline-offset-4 hover:underline bg-transparent border-none cursor-pointer p-0 font-inherit",children:[(0,t.jsxs)("span",{children:[y," connected product",1!==y?"s":""]}),(0,t.jsx)(j.Information,{className:"w-3 h-3"})]})}),(0,t.jsx)(k.Portal,{children:(0,t.jsxs)(k.Content,{className:"bg-white rounded-[8px] shadow-[0_8px_30px_rgb(0,0,0,0.12)] p-4 max-w-[280px] z-50",sideOffset:8,children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("div",{className:"font-medium text-[14px] text-[var(--geist-foreground)]",children:"Connected Products"}),p?.stores.length?(0,t.jsx)("div",{className:"space-y-2 max-h-[320px] overflow-y-auto",children:p.stores.map(e=>(0,t.jsxs)(O.Link,{href:(0,$.getResourceDetailsPath)(e,o.slug),className:"flex items-center gap-2 p-1 hover:bg-gray-50 rounded transition-colors",target:"_blank",rel:"noopener noreferrer",children:[(0,t.jsx)("div",{className:"w-4 h-4 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(h.Avatar,{hash:e.product.iconUrl,size:24})}),(0,t.jsx)("span",{className:"text-[14px] text-[var(--geist-foreground)] truncate flex-1",children:e.name})]},e.id))}):(0,t.jsx)("div",{className:"text-[14px] text-[var(--geist-gray)]",children:"No products found"})]}),(0,t.jsx)(k.Arrow,{className:"fill-white"})]})})]})," ","that will be automatically removed when you uninstall."]}):null,f?(0,t.jsxs)("p",{className:"pt-4 pb-4 text-copy-14 text-gray-900",children:["This integration is scheduled to be uninstalled",eo?` on ${eo}`:" within 24 hours","."]}):null]}),(0,t.jsx)(r.FieldsetFooter,{className:"bg-red-100 border-t border-red-400",children:(0,t.jsx)(r.FieldsetFooter.Actions,{children:(0,t.jsxs)(u.Tooltip,{disableTriggers:!v,text:function(e){let{isDeleteRequested:t}=e;return t?"This integration is scheduled to be uninstalled.":"You need additional permissions to uninstall integration."}({isDeleteRequested:f}),children:[(0,t.jsx)(i.Button,{"data-testid":(0,E.tid)("integration","uninstall"),disabled:v,onClick:ea,type:"error",children:"Uninstall Integration"}),(0,t.jsx)(J,{open:C,onOpenChange:I,billingType:el,eulaLink:a.eulaDocUri,integration:a,loading:B,onCancel:()=>{P.analytics.track(A.AnalyticsEvent.INTEGRATION_CONFIGURATION_REMOVE_CANCELED),et()},onConfirm:(0,R.promiseToCallback)(en),singleResource:p?.stores.find(e=>e.id===m?.id)??m,subscriptionEndDate:er,team:o,resourceStores:p?.stores,showSuccess:z,onDone:ei,showError:Y,errorMessage:Q,onRetry:es,onClose:et})]})})})]})},"MarketplaceUninstallIntegrationPlaceholder",0,function(){return(0,t.jsxs)(l.Fieldset,{type:"error",children:[(0,t.jsxs)(n.FieldsetContent,{children:[(0,t.jsx)(d.FieldsetTitle,{children:"Uninstall Integration"}),(0,t.jsx)(c.FieldsetSubtitle,{color:"gray-900",children:"Uninstalling your integration deletes all products linked to it."})]}),(0,t.jsx)(r.FieldsetFooter,{children:(0,t.jsx)(r.FieldsetFooter.Actions,{children:(0,t.jsx)(i.Button,{disabled:!0,children:"Uninstall Integration"})})})]})}])},1452390,e=>{"use strict";var t=e.i(847684),i=e.i(2504781),a=e.i(7137884),n=e.i(8517043),s=e.i(1232681),l=e.i(3500331),r=e.i(6891161),o=e.i(8522580),c=e.i(3895030),d=e.i(9792418),u=e.i(5468328),h=e.i(455575),x=e.i(7185353),m=e.i(8238875),p=e.i(6352514),g=e.i(4759942),f=e.i(8042625),j=e.i(277234),y=e.i(4244280),b=e.i(1119178),v=e.i(4004502),N=e.i(4011256),C=e.i(588428),I=e.i(134877),k=e.i(8843717),w=e.i(7164486),T=e.i(5561425),S=e.i(2704354),A=e.i(4987761),P=e.i(2333337);function M(e){let{loading:i,originatingTeam:a,configuration:n,resources:s,active:l,complete:o,error:c,onCancel:d,transferInstallation:u,onCompleted:h}=e,[m,p]=(0,x.useState)(null),[g,f]=(0,x.useState)(),[j,y]=(0,x.useState)("Team"),[v,N]=(0,x.useState)(),{data:C}=(0,k.useInstallationPaymentMethodState)({integrationConfigurationId:n.id}),{createAuthorization:I}=(0,A.useMarketplaceBillingAuthorizationApi)(),w=(0,A.useAwaitAuthorization)(),T=(0,x.useCallback)(async()=>{if(!g)throw Error("Invalid state, no team selected");y("Provision");let e=function(e,t){let i,a,n,s,l=e.billingPlan?.scope||"resource",r=e.billingPlan?.id??e.lastAuthorization?.billingPlanId,o=e.billingPlan?.type==="prepayment"?0:void 0;if("resource"===l){for(let e of t){if(!s){s=e,a=e.metadata;continue}e.billingPlan?.preauthorizationAmount&&e.billingPlan.preauthorizationAmount>(s.billingPlan?.preauthorizationAmount??0)&&(s=e,a=e.metadata)}s&&(s.billingPlan?.type==="prepayment"&&(o=0),r=s.billingPlan?.id,i=s.id,a=s.metadata,n=s.product.id)}return{billingPlanId:r??"",metadata:a??{},resourceId:i,productId:n,integrationIdOrSlug:e.integrationId,integrationConfigurationId:e.id,prepaymentAmountCents:o}}(n,s),t=await I(a.id,{...e,overrideTeamForInstallationTransfer:g.id,paymentMethodId:v,overwritePreviousAuthorization:!0,source:"resource-claims"});if(p(t?.id??null),t){if("succeeded"!==(await w(g.id,t.id)).status)return;await u(g.id,t.id,v)}},[u,n,s,a,g,v,I,w]);return(0,t.jsxs)(r.Modal.Modal,{active:l,onClickOutside:function(){f(void 0),N(void 0),y("Team"),d()},width:500,children:["Team"!==j&&g?null:(0,t.jsx)(_,{integrationId:n.integrationId,loading:i,onCancel:d,onContinue:function(){N(void 0),C?.required?y("Card"):y("Confirm")},setTargetTeam:f,targetTeam:g,sourceTeamId:a.id}),"Card"===j&&g?(0,t.jsx)(R,{onBack:function(){y("Team")},onContinue:function(e){N(e),y("Confirm")},targetTeam:g}):null,"Confirm"===j&&g?(0,t.jsx)(E,{integrationSlug:n.slug,loading:i,onBack:function(){y("Card")},onConfirm:(0,b.promiseToCallback)(T)}):null,"Provision"===j&&g?(0,t.jsx)(P.ProvisioningStep,{authorizationId:m,complete:o,error:c,header:(0,t.jsx)(L,{}),isTransitioning:!1,onBack:()=>y("Confirm"),onChangePaymentMethod:function(){y("Card")},onNext:h,successMessage:"Funds have been added",teamId:g.id}):null]})}function L(){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Modal.Title,{children:"Transfer Integration"}),(0,t.jsx)(r.Modal.Subtitle,{children:"This integration will be transferred to the selected team."}),(0,t.jsx)(o.Note,{center:!0,fill:!0,label:"Warning",type:"error",variant:"contrast",children:"This action is only reversible from the selected team."})]})}function _(e){let{loading:i,integrationId:a,targetTeam:n,setTargetTeam:s,onCancel:l,onContinue:o,sourceTeamId:c}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Modal.Body,{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsx)(L,{}),(0,t.jsx)(r.Modal.Inset,{last:!0,children:(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:(0,t.jsx)("label",{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:"Select a Vercel team to transfer the integration to:"}),(0,t.jsx)(T.TeamSelect,{account:n??void 0,integrationId:a,onChange:e=>{s(e)},type:"marketplace",excludeTeamId:c})]})})})})]})}),(0,t.jsxs)(r.Modal.Actions,{children:[(0,t.jsx)(r.Modal.Action,{disabled:i,onClick:l,type:"secondary",children:"Cancel"}),(0,t.jsx)(r.Modal.Action,{disabled:i||!n,loading:i,onClick:o,type:"default",children:"Continue"})]})]})}function R(e){let{targetTeam:i,onBack:a,onContinue:n}=e;return(0,t.jsx)(w.SelectPaymentMethodActionForTeam,{cancelLabel:"Back",continueLabel:"Continue",onAbort:a,onContinue:n,team:i})}function E(e){let{active:i,integrationSlug:a,loading:n,onBack:s,onConfirm:o}=e,c=(0,x.useRef)(null),d="transfer my integration";(0,x.useEffect)(()=>{i&&requestAnimationFrame(()=>{let e=Array.from(c.current?.elements??[]);e.find(e=>"INPUT"===e.tagName)?.focus()})},[i]);let u=(0,x.useCallback)(e=>{e.preventDefault(),c.current?.checkValidity()&&o()},[o]);return(0,t.jsxs)("form",{onSubmit:u,ref:c,children:[(0,t.jsx)(r.Modal.Body,{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsx)(L,{}),(0,t.jsx)(r.Modal.Inset,{last:!0,children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsx)("label",{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["Enter the integration slug"," ",(0,t.jsx)("b",{style:{overflowWrap:"anywhere"},children:a})," ","to continue:"]}),(0,t.jsx)(l.Input,{"aria-label":"Integration Slug",name:"integrationSlug",pattern:`\\s*${a}\\s*`,required:!0})]})}),(0,t.jsx)("label",{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["To verify, type ",(0,t.jsx)("b",{children:d})," below:"]}),(0,t.jsx)(l.Input,{"aria-label":"Verification Code",name:"verificationText",pattern:`\\s*${d}\\s*`,required:!0})]})})]})})]})}),(0,t.jsxs)(r.Modal.Actions,{children:[(0,t.jsx)(r.Modal.Action,{disabled:n,onClick:s,type:"secondary",children:"Back"}),(0,t.jsx)(r.Modal.Action,{buttonType:"submit",disabled:n,loading:n,children:"Continue"})]})]})}let D=(0,e.i(9588822).withStripe)(function(e){let{integration:l,configuration:r,resources:o,team:b,canTransfer:k}=e,w="marketplace"===r.installationType,T=!k||!w,A=(0,h.useToasts)(),P=(0,m.useRouter)(),[L,_]=(0,x.useState)(!1),[R,E]=(0,x.useState)(!1),[D,O]=(0,x.useState)(!1),F=(0,x.useCallback)(()=>_(!0),[]),B=(0,x.useCallback)(()=>_(!1),[]),[U,q]=(0,x.useState)(void 0),{value:$,isReady:W}=(0,C.useMarketplaceIntegrationConfigurationTransferToTeam)(),V=(0,x.useCallback)(()=>{let e=(0,N.getMarketplaceInstallationsLink)({teamSlug:b.slug});P.push(e)},[P,b.slug]),z=(0,x.useCallback)(async(e,t,i)=>{E(!0);let a=(0,f.encode)({teamId:b.id});try{if("marketplace"!==r.installationType)throw Error("Integration is not from the marketplace");await (0,j.fetchAPI)(`${y.API_INTEGRATION_CONTROLLER_V2}/installations/${r.id}/transfer${a}`,{method:"POST",body:{toTeamId:e,authorizationId:t,newInstallationPaymentMethodId:i},throwOnHTTPError:!0}),g.analytics.track(p.AnalyticsEvent.INTEGRATION_CONFIGURATION_TEAM_TRANSFER_SUCCEEDED),g.analytics.track(p.AnalyticsEvent.INTEGRATION_UNINSTALLED,{integration_id:l.id,integration_slug:l.slug,source:"installation view",target:"team"}),O(!0),V()}catch(t){let e="Failed to transfer integration";(0,I.isAPIError)(t)&&(e=t.message),A.error(e),q(e),E(!1)}},[r,l.id,l.slug,b,A,V]);return((0,x.useEffect)(()=>{L&&g.analytics.track(p.AnalyticsEvent.INTEGRATION_CONFIGURATION_REMOVE_MODAL_OPENED)},[L]),(0,S.isMarketplaceInstallation)(r)&&W&&$)?(0,t.jsxs)(n.Fieldset,{children:[(0,t.jsxs)(a.FieldsetContent,{children:[(0,t.jsx)(d.FieldsetTitle,{children:"Transfer Integration"}),(0,t.jsx)(c.FieldsetSubtitle,{color:"gray-900",children:"To transfer this integration please delete all the projects linked to this integration's resources."})]}),(0,t.jsx)(s.FieldsetFooter,{children:(0,t.jsx)(s.FieldsetFooter.Actions,{children:(0,t.jsxs)(u.Tooltip,{disableTriggers:!T,text:function(e){let{canTransferIntegration:t}=e;return t?"You need additional permissions to transfer integrations.":"Delete all the project connections before transferring the integration"}({canTransferIntegration:w}),children:[(0,t.jsx)(i.Button,{"data-testid":(0,v.tid)("integration","transfer"),disabled:T,onClick:F,children:"Transfer Integration"}),(0,t.jsx)(M,{active:L,originatingTeam:b,configuration:r,resources:o,loading:R,onCancel:()=>{g.analytics.track(p.AnalyticsEvent.INTEGRATION_CONFIGURATION_REMOVE_CANCELED),B()},transferInstallation:z,onCompleted:V,complete:D,error:U})]})})})]}):null});e.s(["MarketplaceTransferIntegration",0,D,"MarketplaceTransferIntegrationPlaceholder",0,function(){return(0,t.jsxs)(n.Fieldset,{children:[(0,t.jsxs)(a.FieldsetContent,{children:[(0,t.jsx)(d.FieldsetTitle,{children:"Transfer Integration"}),(0,t.jsx)(c.FieldsetSubtitle,{color:"gray-900",children:"To transfer this integration please disconnect all the projects linked to this this integration's resources."})]}),(0,t.jsx)(s.FieldsetFooter,{children:(0,t.jsx)(s.FieldsetFooter.Actions,{children:(0,t.jsx)(i.Button,{disabled:!0,children:"Transfer Integration"})})})]})}])}]);

//# debugId=95f8a79f-dc2a-a8f8-20fb-13bd905dadda
//# sourceMappingURL=637aa22649bb346e.js.map