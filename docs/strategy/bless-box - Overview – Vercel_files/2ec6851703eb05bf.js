;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="02e786f2-b245-a2d2-051e-95dcb96d299c")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3154500,e=>{"use strict";var t=e.i(847684),s=e.i(7185353),i=e.i(1906681),n=e.i(455575),a=e.i(8522580),l=e.i(57106),r=e.i(6352514),o=e.i(4759942),c=e.i(7917902),d=e.i(1717203),p=e.i(7557283),u=e.i(3802983),h=e.i(5807088),x=e.i(8188735),m=e.i(6060673),y=e.i(3555274),g=e.i(1138941),f=e.i(9068719),j=e.i(185801),b=e.i(5978342),v=e.i(7799383),P=e.i(9367781),w=e.i(9722978);let I="__VERCEL_PASS__";function N(){let e=(0,n.useToasts)(),h=(0,g.useProjectIdOrName)(),{data:N,mutate:T}=(0,m.useProject)(h),k=(0,c.useAccount)(),{can:A,isLoading:S}=(0,d.default)(),{user:E,team:D}=k,[R,M]=(0,s.useState)(!!N?.passwordProtection),[O,_]=(0,s.useState)(""),B="all_except_custom_domains",[L,F]=(0,s.useState)(N?.passwordProtection?.deploymentType||B),[V,H]=(0,s.useState)(!1),[U,$]=(0,s.useState)(null),[z,q]=(0,s.useState)(!1),Y=(0,s.useCallback)(async()=>{H(!0);try{o.analytics.track(r.AnalyticsEvent.DEPLOYMENT_PROTECTION_TOGGLE_PASSWORD_PROTECTION,{enabled:R,protectProductionEnvironment:"all"===L,projectId:h}),$(null);let t=O&&O!==I?O:null;await (0,x.default)(h,D?.id,{passwordProtection:R?{deploymentType:L,password:t||void 0}:null}),e.success("Updated Password Protection successfully."),await T()}catch(e){$(e.message)}H(!1),q(!1)},[h,T,D,e,R,L,O]),W=(0,s.useCallback)(e=>{M(e),q(!0)},[]),G=(0,s.useCallback)(()=>{O===I&&_("")},[O]),J=(0,s.useCallback)(()=>{""===O&&N?.passwordProtection&&_(I)},[N?.passwordProtection,O]),K=(0,s.useCallback)(e=>{_(e),q(!0)},[]),Z=(0,s.useCallback)(e=>{F(e),q(!0)},[]);(0,s.useEffect)(()=>{M(!!N?.passwordProtection),_(N?.passwordProtection?I:""),F(N?.passwordProtection?.deploymentType||B)},[N?.passwordProtection,B]);let{addOn:Q,isADPEnabled:X,enableADP:ee,ADPModal:et}=(0,f.useToggleAdvancedDeploymentProtection)("project-settings-password-protection"),{enabled:es,message:ei,action:en}=(0,y.default)({addOn:Q,isEnabled:X,enable:ee,modal:et}),ea=!N||!(D||E)||S,el=A(p.Action.Update,p.Resource.Project),er=A(p.Action.Create,p.Resource.PasswordProtection),eo=el&&O&&z,ec=(0,s.useCallback)(()=>el?es?(0,t.jsxs)("p",{className:"text-gray-900 text-copy-14",children:["Learn more about"," ",(0,t.jsx)(l.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-protect-deployments/password-protection",type:"highlight",children:"Password Protection"})]}):er?ei:(0,t.jsxs)("p",{className:"text-gray-900 text-copy-14",children:["You need additional permissions to enable"," ",(0,t.jsx)(l.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-protect-deployments/password-protection",type:"highlight",children:"Password Protection"})," ","for your project."]}):(0,t.jsxs)("p",{className:"text-gray-900 text-copy-14",children:["You need additional permissions to manage your project's"," ",(0,t.jsx)(l.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-protect-deployments/password-protection",type:"highlight",children:"Password Protection"}),"."]}),[el,es,ei,er]);if(ea)return(0,t.jsx)(C,{});let ed=V||!R,ep=!el||!es;return(0,t.jsx)(j.ProjectSettingsFieldset,{action:er?en:void 0,description:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial gap-4",children:[(0,t.jsx)("span",{className:"text-copy-14",children:"Ensures visitors to your deployments must enter a password in order to gain access."}),N.appliedCve55182Migration&&N.passwordProtection?.deploymentType==="prod_deployment_urls_and_all_previews"?(0,t.jsxs)(a.Note,{label:!1,type:"warning",children:["Password protection was automatically upgraded for this project due to"," ",(0,t.jsx)(l.Link,{href:"/changelog/cve-2025-55182",external:!0,variant:"highlight",children:"CVE-2025-55182"}),"to protect old deployments. To override this, this setting can be updated to a new value."]}):null]}),disabled:!el,disabledForBilling:ep,error:U,highlightNote:!el,headerNote:R?(0,t.jsx)(P.MicrofrontendsHelpBadge,{childHelp:"This configuration only applies to domains belonging to this project.",parentHelp:"This configuration applies to production and pre-production deployments for the group."}):null,note:ec(),onSave:es?Y:null,saveDisabled:!eo,saveLoading:V,title:"Password Protection",children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-row flex-wrap items-center justify-between flex-initial gap-2 md:gap-4 md:justify-start",children:[(0,t.jsx)("div",{className:"flex flex-row items-center justify-start flex-initial gap-2",style:{padding:"var(--geist-gap-quarter) 0"},children:(0,t.jsx)(i.Toggle,{"aria-labelledby":"label-for-password-protection-enabled-toggle",checked:R,direction:"switch-first",onChange:W,size:"large",children:(0,t.jsx)("p",{className:(0,w.default)("text-[14px] leading-[20px] font-medium normal-case",R?"text-gray-1000":"text-gray-900",ep?"text-gray-800":void 0),id:"label-for-password-protection-enabled-toggle",children:R?"Enabled for":"Disabled"})})}),R?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(b.DeploymentTypeSelector,{disabled:ed,onChange:Z,currentValue:N?.passwordProtection?.deploymentType,project:N,selectedValue:L,className:"order-3 md:order-none"}),(0,t.jsx)(v.ExceptionsInfo,{project:N,className:"order-2 md:order-none"})]}):null]}),(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial gap-4",children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial gap-2",children:[(0,t.jsx)("p",{className:"text-[12px] leading-[16px] font-medium text-gray-900 uppercase",id:"label-for-password-protection-password-input",children:"Password"}),(0,t.jsx)(u.default,{"aria-labelledby":"label-for-password-protection-password-input",autoFocus:z,disabled:ed,maxLength:72,onBlur:J,onChange:e=>K(e.target.value),onFocus:G,placeholder:ed?"":"Enter password",typeName:"password",value:O,width:"290px"},`input-focus-on-change-${R.toString()}`)]})})]})})}function C(){return(0,t.jsx)(h.default,{height:170})}e.s(["PasswordProtection",0,function(){return(0,t.jsx)(s.Suspense,{fallback:(0,t.jsx)(C,{}),children:(0,t.jsx)(N,{})})}])},9300544,e=>{"use strict";var t=e.i(847684),s=e.i(7185353),i=e.i(8522580),n=e.i(1906681),a=e.i(5468328),l=e.i(455575),r=e.i(57106),o=e.i(6352514),c=e.i(4759942),d=e.i(7837522),p=e.i(7780974),u=e.i(7917902),h=e.i(1717203),x=e.i(7557283),m=e.i(5807088),y=e.i(8188735),g=e.i(6060673),f=e.i(1138941),j=e.i(3555274),b=e.i(9068719),v=e.i(185801),P=e.i(5978342),w=e.i(7799383),I=e.i(9367781),N=e.i(9722978);function C(){let e=(0,f.useProjectIdOrName)(),{data:m,mutate:C}=(0,g.useProject)(e),{user:k,team:A}=(0,u.useAccount)(),{can:S,isLoading:E}=(0,h.default)(),[D,R]=(0,s.useState)(!!m?.ssoProtection),M="all_except_custom_domains",[O,_]=(0,s.useState)(m?.ssoProtection?.deploymentType||M),[B,L]=(0,s.useState)(!1),[F,V]=(0,s.useState)(null),H=(0,l.useToasts)(),{track:U}=(0,d.useTrackActivity)(),$=A?.standaloneTrustedIps?.enabled||!1,z=m?.trustedIps?.deploymentType&&"production"!==m.trustedIps.deploymentType,q=(0,s.useCallback)(async()=>{L(!0),V(null);try{c.analytics.track(o.AnalyticsEvent.DEPLOYMENT_PROTECTION_TOGGLE_VERCEL_AUTHENTICATION,{enabled:D,protectProductionEnvironment:"all"===O,projectId:e}),U(p.VercelActivityAction.ProjectSettingsUpdated,{name:"vercel-authentication",projectId:e,teamId:A?.id||"",value:{enabled:D,deploymentType:O}}),await (0,y.default)(e,A?.id,{ssoProtection:D?{deploymentType:O}:null}),H.success("Updated Vercel Authentication successfully."),await C()}catch(e){V(e.message)}L(!1)},[e,C,A,H,D,O,U]),Y=(0,s.useCallback)(()=>{R(!D)},[R,D]),W=(0,s.useCallback)(e=>{_(e)},[]);(0,s.useEffect)(()=>{R(!!m?.ssoProtection),_(m?.ssoProtection?.deploymentType||M)},[m?.ssoProtection,M]);let{addOn:G,isADPEnabled:J,enableADP:K,ADPModal:Z}=(0,b.useToggleAdvancedDeploymentProtection)("project-settings-vercel-auth"),{message:Q,action:X}=(0,j.default)({addOn:G,isEnabled:J,enable:K,modal:Z}),ee=!m||!(A||k)||E,et=S(x.Action.Update,x.Resource.Project);if(ee)return(0,t.jsx)(T,{});let es=null===A&&k?.billing?.plan==="hobby",ei=!!m.ssoProtection!==D||m.ssoProtection?.deploymentType&&m.ssoProtection.deploymentType!==O,en=!$&&z;return(0,t.jsx)(v.ProjectSettingsFieldset,{description:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial gap-4",children:[es?(0,t.jsx)("span",{className:"text-copy-14",children:"Ensures visitors to your deployments are logged in to Vercel."}):(0,t.jsx)("span",{className:"text-copy-14",children:"Ensures visitors to your deployments are logged in to Vercel and are a member of your team."}),m.appliedCve55182Migration&&m.ssoProtection?.deploymentType==="prod_deployment_urls_and_all_previews"?(0,t.jsxs)(i.Note,{label:!1,type:"warning",children:["Deployment protection was automatically enabled for this project due to"," ",(0,t.jsx)(r.Link,{href:"/changelog/cve-2025-55182",external:!0,variant:"highlight",children:"CVE-2025-55182"}),"to protect old deployments. To override this, this setting can be updated to a new value."]}):null]}),disabled:!et,error:F,highlightNote:!et,note:et?(0,t.jsxs)("p",{className:"text-gray-900 text-copy-14",children:["Learn more about"," ",(0,t.jsx)(r.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-protect-deployments/vercel-authentication",type:"highlight",children:"Vercel Authentication"})]}):(0,t.jsxs)("p",{className:"text-gray-900 text-copy-14",children:["You need additional permissions to manage your project's"," ",(0,t.jsx)(r.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-protect-deployments/vercel-authentication",type:"highlight",children:"Vercel Authentication"})]}),onSave:q,saveDisabled:!ei,saveLoading:B,title:"Vercel Authentication",headerNote:(0,t.jsx)(I.MicrofrontendsHelpBadge,{childHelp:(0,t.jsxs)(t.Fragment,{children:["This configuration applies only to this project's domains. It's recommended to protect"," ",(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium text-inherit",children:"All Deployments"})," ","for a child microfrontends project."]}),parentHelp:(0,t.jsxs)(t.Fragment,{children:["This configuration applies to production and pre-production deployments for the group. It's recommended to use"," ",(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium text-inherit",children:"Standard Protection"})," ","for the default app microfrontends project."]})}),children:(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial gap-4",children:(0,t.jsxs)("div",{className:"flex flex-row flex-wrap items-center justify-between flex-initial gap-2 md:gap-4 md:justify-start",children:[(0,t.jsx)("div",{className:"flex flex-row items-center justify-start flex-initial gap-2",style:{padding:"var(--geist-gap-quarter) 0"},children:(0,t.jsx)(a.Tooltip,{desktopOnly:!0,forceHide:!D||!en,text:"Trusted IPs can not be enabled in preview environments without Vercel Authentication.",children:(0,t.jsx)(n.Toggle,{"aria-labelledby":"label-for-vercel-auth-enabled-toggle",checked:D,direction:"switch-first",disabled:!!(D&&en),onChange:Y,size:"large",children:(0,t.jsx)("p",{className:(0,N.default)("text-[14px] leading-[20px] font-medium normal-case",D?"text-gray-1000":"text-gray-900"),id:"label-for-vercel-auth-enabled-toggle",children:D?"Enabled for":"Disabled"})})})}),D?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(P.DeploymentTypeSelector,{disabled:B,onChange:W,currentValue:m?.ssoProtection?.deploymentType,overrides:{all:{disabledDescription:Q,upgradeButton:X}},project:m,selectedValue:O,className:"order-3 md:order-none"}),(0,t.jsx)(w.ExceptionsInfo,{project:m,className:"order-2 md:order-none"})]}):null]})})})}function T(){return(0,t.jsx)(m.default,{height:88})}e.s(["VercelAuth",0,function(){return(0,t.jsx)(s.Suspense,{fallback:(0,t.jsx)(T,{}),children:(0,t.jsx)(C,{})})}])},4999769,e=>{"use strict";var t=e.i(847684),s=e.i(5169576),i=e.i(762945),n=e.i(8522580),a=e.i(1867722),l=e.i(1114103);e.s(["AnimatedNote",0,function(e){let{type:r,keyName:o,children:c}=e;return(0,t.jsx)(l.AnimatePresence,{children:c?(0,t.jsx)(a.m.div,{animate:{height:"auto",opacity:1,marginTop:0},exit:{height:0,opacity:0,marginTop:"var(--geist-space-4x-negative)"},initial:{height:0,opacity:0,marginTop:"var(--geist-space-4x-negative)"},style:{overflow:"hidden"},transition:{ease:"easeInOut"},children:(0,t.jsx)(n.Note,{fill:!0,label:!1,style:{backgroundColor:"warning"===r?void 0:"var(--ds-gray-100)",border:"none",color:"warning"===r?void 0:"var(--accents-6)"},type:r,variant:"contrast",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:["warning"===r?(0,t.jsx)(i.Warning,{className:"-mb-px shrink-0"}):(0,t.jsx)(s.Information,{className:"shrink-0"}),c]})})},o):null})}])},3982440,e=>{"use strict";var t=e.i(847684),s=e.i(7185353),i=e.i(2504781),n=e.i(455575),a=e.i(5468328),l=e.i(8459493),r=e.i(3500331),o=e.i(7448864),c=e.i(5255926),d=e.i(4585051),p=e.i(526657),u=e.i(3306538),h=e.i(8735244),x=e.i(3973638),m=e.i(1933683),y=e.i(6318858),g=e.i(57106),f=e.i(6352514),j=e.i(4759942),b=e.i(7917902),v=e.i(6198010),P=e.i(1717203),w=e.i(7557283),I=e.i(5819220),N=e.i(4712634),C=e.i(979715),T=e.i(6060673),k=e.i(1138941),A=e.i(4595422),S=e.i(2882012),E=e.i(7188996),D=e.i(7188420),R=e.i(5807088),M=e.i(185801),O=e.i(4999769),_=e.i(7743427),B=e.i(1991452),L=e.i(4011256),F=e.i(9668517),V=e.i(9367781),H=e.i(588428),U=e.i(7218483),$=e.i(6891161),z=e.i(4030453);function q(e){let{active:s,onClose:i,onConfirm:n,loading:a,title:l,children:r,error:o,buttonTitle:c="Confirm"}=e;return(0,t.jsx)($.Modal.Modal,{active:s,onClickOutside:i,width:480,children:(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),n()},children:[(0,t.jsxs)($.Modal.Body,{children:[(0,t.jsx)($.Modal.Header,{children:(0,t.jsx)($.Modal.Title,{children:l})}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial gap-4",children:[r,o?(0,t.jsx)(z.Error,{children:o}):null]})]}),(0,t.jsxs)($.Modal.Actions,{children:[(0,t.jsx)($.Modal.Action,{onClick:i,type:"secondary",children:"Cancel"}),(0,t.jsx)($.Modal.Action,{buttonType:"submit",loading:a,children:c})]})]})})}function Y(){let e=(0,k.useProjectIdOrName)(),{data:l,mutate:o}=(0,T.useProject)(e),{can:c,isLoading:d}=(0,P.default)(),{user:p,team:u}=(0,b.useAccount)(),h=l?(0,A.getDefaultAutomationBypass)(l):null,[x,m]=(0,s.useState)(null),[y,I]=(0,s.useState)(!1),[N,C]=(0,s.useState)(null),[R,M]=(0,s.useState)(!1),[_,B]=(0,s.useState)(null),L=(0,s.useRef)(null),F=(0,s.useRef)(null),{value:U}=(0,H.useMultipleAutomationBypassesFlag)(),$=!l||!(u||p)||d,z=c(w.Action.Update,w.Resource.Project),Y=c(w.Action.Read,w.Resource.ProjectProtectionBypass),Z=z&&c(w.Action.Delete,w.Resource.ProjectProtectionBypass),Q=z&&c(w.Action.Update,w.Resource.ProjectProtectionBypass),X=z&&c(w.Action.Create,w.Resource.ProjectProtectionBypass),ee=(0,s.useCallback)(async t=>{m(null),I(!0);try{let s="Created";switch(t.revoke?s=t.revoke.regenerate?"Regenerated":"Deleted":t.update&&(s="Updated"),s){case"Deleted":case"Created":j.analytics.track(f.AnalyticsEvent.DEPLOYMENT_PROTECTION_TOGGLE_BYPASS_FOR_AUTOMATION,{enabled:"Created"===s,projectId:e});break;case"Updated":case"Regenerated":j.analytics.track(f.AnalyticsEvent.DEPLOYMENT_PROTECTION_REGENERATE_BYPASS_HEADER,{projectId:e})}await (0,S.updateProjectProtectionBypass)({teamId:u?.id,projectIdOrName:e,body:t}),n.toasts.success(`${s} Automation Bypass successfully.`)}catch(e){m(`Request failed: ${e.message}`)}await o(),I(!1)},[e,u?.id,o]),et=(0,s.useCallback)(async()=>{N&&(await ee({revoke:N}),C(null))},[N,ee]),es=(0,s.useCallback)(async()=>{M({});let e=L.current?.value,t=F.current?.value;e&&32!==e.length?M({error:`Secret must be 32 characters, provided value is ${e.length}.`}):e&&!/^[a-zA-Z0-9]{32}$/.test(e)?M({error:"Secret can only contain letters and numbers."}):t&&t.length>100?M({error:`Note cannot be over 100 characters, provided note is ${t.length}.`}):(await ee({generate:e?{secret:e,note:t}:{note:t}}),M(!1))},[ee,L]),ei=async e=>{e&&(await ee({update:void 0!==U?{isEnvVar:!0,secret:e}:void 0}),B(null))},en=(0,s.useCallback)(async(e,t)=>{await ee({update:{secret:e,note:t}})},[ee]),ea=(0,s.useCallback)(()=>$?null:z?(0,t.jsxs)("p",{className:"text-gray-900 text-copy-14",children:["Learn more about"," ",(0,t.jsx)(g.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-bypass-deployment-protection/protection-bypass-automation",type:"highlight",children:"Protection Bypass for Automation"})]}):(0,t.jsxs)("p",{className:"text-gray-900 text-copy-14",children:["You need additional permissions to manage your project's"," ",(0,t.jsx)(g.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-bypass-deployment-protection/protection-bypass-automation",type:"highlight",children:"Protection Bypass for Automation"}),"."]}),[z,$]);if($)return(0,t.jsx)(K,{});let el=!!(l.ssoProtection||l.passwordProtection||l.trustedIps),er={noPermission:X?null:"Missing the required permissions to create a secret.",noProtectionEnabled:el||h?null:"No protections currently enabled for the project."},eo=er.noPermission||er.noProtectionEnabled,ec=Object.entries(l.protectionBypass||{}),ed=ec.filter(e=>"automation-bypass"===e[1].scope),ep=ec.filter(e=>{let[t,s]=e;return"integration-automation-bypass"===s.scope});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(J,{action:!h||U?(0,t.jsx)(i.Button,{disabled:!!eo,loading:y,onClick:()=>M({}),prefix:(0,t.jsx)(v.Plus,{}),size:"small",children:(0,t.jsx)(a.Tooltip,{forceHide:!eo,text:eo,children:y?"Updating...":"Add"})}):null,disabled:!(Y&&z),disabledForBilling:!Y||!X&&!h,error:x,highlightNote:!Y,note:ea(),headerNote:(0,t.jsx)(V.MicrofrontendsHelpBadge,{childHelp:"This secret bypasses deployment protection for this project's routes. The default app's secret also applies to this project.",parentHelp:"This secret bypasses deployment protection for all projects in the microfrontends group."}),children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial gap-4 mt-5",children:[(0,t.jsx)(O.AnimatedNote,{keyName:"automation-bypass-no-protection-enabled-note",children:h&&!el?(0,t.jsx)("span",{children:"Protection Bypass for Automation with no protections enabled has no effect."}):null}),(0,t.jsx)(D.EntityCollapsible,{disabled:!z,emptyDescription:"Add a secret that can be used to bypass Deployment Protection for this project.",expandedInitially:!0,entities:ed.map(e=>{let[s,i]=e;return{key:`protection-bypass-${i.createdAt}`,component:(0,t.jsx)(G,{bypass:i,secret:s,setRemoveConfirmationModal:C,setConfirmIsEnvModal:B,canDeleteProjectProtectionBypass:Z,canUpdateProjectProtectionBypass:Q,enableMultipleAutomationBypasses:U,onUpdateNote:en})}}),isLoading:$,title:"Bypasses"}),ep.length>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"text-gray-900 text-copy-14",style:{marginTop:"20px"},children:"Automation Protection Bypass created by integrations"}),(0,t.jsx)(D.EntityCollapsible,{disabled:!z,emptyDescription:"",entities:ep.map(e=>{let[s,i]=e;return{key:`integration-protection-bypass-${i.createdAt}`,component:(0,t.jsx)(W,{integrationAutomationBypass:i,secret:s})}}),isLoading:$,title:"Integration Secrets"})]}):null]})}),(0,t.jsx)(q,{active:!!N,onClose:()=>C(null),loading:y,onConfirm:()=>et(),buttonTitle:"Confirm",title:N?.regenerate?"Regenerate Protection Bypass Secret":"Remove Protection Bypass Secret",children:(0,t.jsx)("p",{className:"text-gray-900 text-copy-14",children:N?.regenerate?(0,t.jsxs)(t.Fragment,{children:["Regenerating"," ",(0,t.jsx)(E.CopyInlineCode,{value:N?.secret})," will mean any automation services using the current secret will no longer work and may report errors until they are switched to the new secret."]}):(0,t.jsxs)(t.Fragment,{children:["Removing"," ",(0,t.jsx)(E.CopyInlineCode,{value:N?.secret||""})," ","will mean any automation services currently using it will no longer work and may report errors."]})})}),(0,t.jsxs)(q,{active:!!R,onClose:()=>M(!1),buttonTitle:"Add",loading:y,onConfirm:()=>es(),title:"Add Bypass",error:R?R?.error:void 0,children:[(0,t.jsx)("p",{className:"text-gray-900 text-copy-14",children:"Add a new Deployment Protection bypass for this project."}),(0,t.jsx)(r.Input,{placeholder:"Leave blank to generate, or provide 32-character value",ref:L,title:"Bypass value"}),U?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"text-gray-900 text-copy-14",children:"Optionally add a note to help you remember what this bypass is for."}),(0,t.jsx)(r.Input,{placeholder:"e.g. Playwright tests",ref:F,title:"Note"})]}):null]}),(0,t.jsxs)(q,{active:!!_,onClose:()=>B(null),loading:y,buttonTitle:"Confirm",onConfirm:()=>ei(_?.secret),title:"Replace Environment Variable",children:[(0,t.jsx)(E.CopyInlineCode,{value:_?.secret||""}),(0,t.jsxs)("p",{className:"text-gray-900 text-copy-14",children:["Replace the current"," ",(0,t.jsx)(g.Link,{href:"/docs/environment-variables/system-environment-variables",variant:"highlight",children:"system environment variable"})," ","value with the selected value"," ",_?.bypass.note?(0,t.jsxs)("span",{className:"font-semibold",children:["(",_?.bypass.note,")"," "]}):""," ","in future deployments. This will not replace the environment variable in existing deployments."]})]})]})}function W(e){let{integrationAutomationBypass:n,secret:a}=e,{integration:r}=(0,_.useIntegration)(n.integrationId),o=(0,B.useRouter)(),[c,p]=(0,s.useState)(!1),u=`Click to ${c?"hide":"show"}`,h=(0,F.useTeamSlug)();return(0,t.jsxs)(I.Entity,{className:"!border-0",menuItems:[(0,t.jsx)(l.MenuItem,{onClick:()=>{h&&o.push((0,L.getInstallationDetailsLink)({teamSlug:h,integrationSlug:n.integrationId,configurationId:n.configurationId,isMarketplace:!0}))},children:"Manage"},"manage-integration")],thumbnail:(0,t.jsx)(N.EntityThumbnail,{size:24,children:(0,t.jsx)(d.Avatar,{size:24,hash:r?.icon})}),children:[(0,t.jsx)(C.EntityField,{width:"40%",title:r?.name}),(0,t.jsx)(C.EntityField,{children:(0,t.jsx)("div",{className:"flex flex-row items-stretch justify-start flex-initial gap-2",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start flex-initial gap-2",children:[(0,t.jsx)(i.Button,{"aria-label":u,onClick:()=>p(!c),svgOnly:!0,title:u,variant:"unstyled",children:c?(0,t.jsx)(x.EyeOff,{size:16}):(0,t.jsx)(m.Eye,{size:16})}),c?(0,t.jsx)(E.CopyInlineCode,{value:a}):(0,t.jsx)("p",{className:"text-gray-900 text-copy-14",children:"•".repeat(15)})]})})})]})}function G(e){let{bypass:n,secret:a,setRemoveConfirmationModal:c,setConfirmIsEnvModal:g,onUpdateNote:f,canDeleteProjectProtectionBypass:j,canUpdateProjectProtectionBypass:b,enableMultipleAutomationBypasses:v}=e,[P,w]=(0,s.useState)(!1),[N,T]=(0,s.useState)(n.note),[k,S]=(0,s.useState)(!1),D=`Click to ${P?"hide":"show"}`,R=(0,U.useAgo)(n.createdAt,{justNowLabel:"just now"}),M=async e=>{S(!0),await f(a,e),S(!1)};return(0,t.jsxs)(I.Entity,{className:"!border-0",menuItems:[v?(0,t.jsx)(t.Fragment,{children:b?(0,t.jsx)(l.MenuItem,{onClick:()=>g({bypass:n,secret:a}),disabled:(0,A.isDefaultAutomationBypass)(n),children:"Replace Environment Variable"}):(0,t.jsx)(o.MenuItemLocked,{children:"Replace Environment Variable"})}):null,b?(0,t.jsx)(l.MenuItem,{onClick:()=>{c({regenerate:!0,secret:a})},children:"Regenerate"}):(0,t.jsx)(o.MenuItemLocked,{children:"Regenerate"}),j?(0,t.jsx)(l.MenuItem,{onClick:()=>{c({regenerate:!1,secret:a})},type:"error",children:"Remove"}):(0,t.jsx)(o.MenuItemLocked,{children:"Remove"})].filter(Boolean),children:[(0,t.jsx)(C.EntityField,{children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start flex-initial gap-2",children:[(0,t.jsx)(i.Button,{"aria-label":D,onClick:()=>w(!P),svgOnly:!0,title:D,variant:"unstyled",children:P?(0,t.jsx)(x.EyeOff,{size:16,color:"gray-900"}):(0,t.jsx)(m.Eye,{size:16,color:"gray-900"})}),P?(0,t.jsx)(E.CopyInlineCode,{value:a}):(0,t.jsx)("p",{className:"text-gray-900 text-copy-14",children:"•".repeat(15)})]})}),v?(0,t.jsx)(C.EntityField,{children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start flex-initial gap-2",children:[(0,t.jsx)(r.Input,{"aria-label":"Add a note",disabled:!b,maxLength:100,className:"shadow-none",innerWrapperClassName:"shadow-none",placeholder:b?"Add note":"",size:"small",onKeyDown:e=>{"Enter"===e.key&&N!==n.note&&(e.preventDefault(),M(N||""))},onChange:e=>T(e.currentTarget.value),defaultValue:n.note}),N!==n.note?(0,t.jsx)(i.Button,{size:"small",type:"tertiary",onClick:()=>{M(N||"")},svgOnly:!0,shape:"square","aria-label":"update note",children:k?(0,t.jsx)(h.Spinner,{}):(0,t.jsx)(y.Check,{})}):null]})}):null,(0,t.jsx)(C.EntityField,{avatar:(0,t.jsx)(d.Avatar,{size:24,uid:n.createdBy}),description:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start flex-initial gap-2",children:[(0,A.isDefaultAutomationBypass)(n)&&v?(0,t.jsx)(u.Badge,{variant:"blue-subtle",children:"Env Var"}):null,(0,t.jsxs)(p.RelativeTimeCard,{date:n.createdAt,side:"left",children:["Added ",R]})]}),descriptionWrap:!1,right:!0})]})}function J(e){let{children:s,note:i,...n}=e;return(0,t.jsx)(M.ProjectSettingsFieldset,{description:(0,t.jsxs)(t.Fragment,{children:["Enable automation services to access protected deployments for this project. You can bypass Deployment Protection by sending an HTTP header or query parameter named"," ",(0,t.jsx)(E.CopyInlineCode,{value:"x-vercel-protection-bypass"})," with the bypass value. After the bypass is created, it is automatically available to all deployments as the"," ",(0,t.jsx)(g.Link,{href:"/docs/environment-variables/system-environment-variables",variant:"highlight",children:"system environment variable"})," ",(0,t.jsx)(E.CopyInlineCode,{value:"VERCEL_AUTOMATION_BYPASS_SECRET"}),"."]}),note:i||(0,t.jsx)(c.Skeleton,{height:16,width:240}),title:"Protection Bypass for Automation",...n,children:s})}function K(){return(0,t.jsx)(J,{note:"",children:(0,t.jsx)(D.LoadingState,{})})}e.s(["AutomationBypass",0,function(){return(0,t.jsx)(s.Suspense,{fallback:(0,t.jsx)(R.default,{}),children:(0,t.jsx)(Y,{})})}],3982440)},8270368,e=>{e.v({input:"trusted-ips-module__2PgDza__input",ipInput:"trusted-ips-module__2PgDza__ipInput",list:"trusted-ips-module__2PgDza__list",noteInput:"trusted-ips-module__2PgDza__noteInput"})},9855670,e=>{"use strict";var t=e.i(847684),s=e.i(7185353),i=e.i(2504781),n=e.i(5468328),a=e.i(6891161),l=e.i(455575),r=e.i(1906681),o=e.i(3500331),c=e.i(2064047),d=e.i(5169576),p=e.i(7957251),u=e.i(5883567),h=e.i(6401841),x=e.i(762945),m=e.i(9722978),y=e.i(4004502),g=e.i(7917902),f=e.i(7812221),j=e.i(57106),b=e.i(1717203),v=e.i(7557283),P=e.i(588428),w=e.i(4670733),I=e.i(5807088),N=e.i(8188735),C=e.i(6060673),T=e.i(1138941),k=e.i(6673134),A=e.i(185801),S=e.i(4999769),E=e.i(6827216);let D=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=[];for(let i of t)try{if((0,E.isValid)(e)&&(0,E.isValid)(i))e===i&&s.push(i);else if((0,E.isValid)(e))(0,E.parse)(e).match((0,E.parseCIDR)(i))&&s.push(i);else if((0,E.isValid)(i))(0,E.parse)(i).match((0,E.parseCIDR)(e))&&s.push(i);else{let t=(0,E.parseCIDR)(e),n=(0,E.parseCIDR)(i);(t[0].match(n)||n[0].match(t))&&s.push(i)}}catch{}return s};var R=e.i(5978342),M=e.i(9947482);function O(e){let{overrides:s,...i}=e,n={additional:{label:"Trusted IP Required",description:(0,t.jsxs)("span",{className:"text-copy-14 text-inherit",children:["Visitors"," ",(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium text-inherit",children:"must"})," ","come from a Trusted IP address, and satisfy Vercel Authentication or Password Protection if enabled."]}),...s?.additional},exclusive:{label:"Trusted IP Optional",description:(0,t.jsxs)("span",{className:"text-copy-14 text-inherit",children:["Visitors from a Trusted IP address will automatically"," ",(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium text-inherit",children:"bypass"})," ","Vercel Authentication and Password Protection. Other users will be prompted with the enabled Deployment Protection methods."]}),...s?.exclusive}};return(0,t.jsx)(M.Selector,{ariaLabel:"Select the protection mode for Trusted IPs.",values:n,width:280,...i})}var _=e.i(8270368),B=e.i(9367781);function L(){let e=(0,l.useToasts)(),I=(0,T.useProjectIdOrName)(),{data:M,mutate:L}=(0,C.useProject)(I),H=(0,g.useAccount)(),{can:U,isLoading:$}=(0,b.default)(),z=U(v.Action.Update,v.Resource.Project)&&U(v.Action.Update,v.Resource.TrustedIps),q=U(v.Action.Read,v.Resource.TrustedIps),{user:Y,team:W}=H,{value:G}=(0,w.useTrustedIpsCustomLimitFlag)(),J=F(G),K=W?.standaloneTrustedIps?.enabled||!1,Z=(0,s.useMemo)(()=>!!(q&&M?.trustedIps),[q,M?.trustedIps]),[Q,X]=(0,s.useState)(Z),ee=(0,s.useMemo)(()=>q&&M?.trustedIps?.deploymentType||"production",[q,M?.trustedIps?.deploymentType]),[et,es]=(0,s.useState)(ee),ei=(0,s.useMemo)(()=>q&&M?.trustedIps?.protectionMode||"additional",[q,M?.trustedIps?.protectionMode]),[en,ea]=(0,s.useState)(ei),[el,er]=(0,s.useState)(!1),[eo,ec]=(0,s.useState)(null),[ed,ep]=(0,s.useState)(!1),{value:eu}=(0,P.useIPBlockingTeamFlag)(),eh=U(v.Action.Read,v.Resource.IpBlocking),{data:ex}=(0,k.useIPBlocking)({limit:128}),em=(0,s.useCallback)(e=>e.map((s,i)=>{let n,{value:a,note:l}=s;if(!a&&l)return{...s,error:"Please enter a value."};let r=(n=(e=>{try{return(0,E.parse)(e)}catch{return null}})(a)||(e=>{try{let[t]=(0,E.parseCIDR)(e);return t}catch{return null}})(a))&&"ipv4"===n.kind()?["private","unspecified","loopback"].includes(n.range())?"unsupported-range":"valid":"unsupported-format";if(a&&"unsupported-format"===r)return{...s,error:"Unsupported format: Must be an IPv4 address or IPv4 CIDR block."};if(a&&"unsupported-range"===r)return{...s,error:"Unsupported range"};if(a&&e.slice(0,i).filter(e=>{let{value:t}=e;return t===a}).length>0)return{...s,error:"Address already in the list."};if(W?.slug){let e=eu&&eh?ex?.result.map(e=>{let{ip:t}=e;return t}):void 0,i=`/${W.slug}/~/settings/security#ip-blocking`,n=D(a,e);if(n.length>0)return{...s,warning:(0,t.jsxs)(t.Fragment,{children:["Potential conflict with"," ",(0,t.jsx)(j.Link,{href:i,variant:"blend",children:"Blocked IPs"})," ","(",n.join(", "),"). Blocked addresses will not be trusted."]})}}return{...s,error:null,warning:null}}),[ex,eu,eh,W?.slug]),ey=(0,s.useMemo)(()=>{let e=Date.now();return q&&M?.trustedIps?.addresses&&0!==M.trustedIps.addresses.length?em(M.trustedIps.addresses.map((t,s)=>{let{value:i,note:n}=t;return{renderingId:e+s,value:i,note:n,error:null,warning:null}})):[{renderingId:e,value:"",error:null,warning:null}]},[q,M?.trustedIps,em]),[eg,ef]=(0,s.useState)(ey),ej=(0,s.useMemo)(()=>({trustedIps:Q?{deploymentType:et,addresses:eg.map(e=>{let{value:t,note:s}=e;return{value:t,note:s}}).filter(e=>{let{value:t}=e;return!!t}),protectionMode:en}:null}),[Q,et,eg,en]),eb=(0,s.useCallback)(async()=>{er(!0);try{ec(null),await (0,N.default)(I,W?.id,ej),e.success("Updated Trusted IPs successfully."),await L()}catch(e){ec(e.message)}er(!1)},[I,L,W,e,ej]),ev=(0,s.useCallback)(e=>{X(e),ef(e=>{let[t,...s]=e;return[{...t,renderingId:t.renderingId-1},...s]})},[]),eP=(0,s.useCallback)(e=>{es(e)},[]),ew=(0,s.useCallback)(()=>{ef(e=>[...e,{renderingId:Date.now(),value:"",error:null,warning:null}])},[]),eI=(0,s.useCallback)(e=>{ef(t=>{if(t.length<=1)return[{renderingId:Date.now(),value:"",error:null,warning:null}];let s=t.findIndex(t=>{let{renderingId:s}=t;return s===e});return[...t.slice(0,s),...t.slice(s+1)]})},[]),eN=(0,s.useCallback)((e,t)=>{let{value:s,note:i}=t;ef(t=>t.map(t=>t.renderingId===e?{...t,value:s??t.value,note:i??t.note}:t))},[]),eC=(0,s.useCallback)((e,t)=>{t.relatedTarget?.id!==`remove-input-${e}`&&ef(em)},[em]);(0,s.useEffect)(()=>{X(Z),es(ee),ef(ey),ea(ei)},[ei,ey,Z,ee]);let eT=!M||!(W||Y)||$,ek=JSON.stringify(M?.trustedIps?.addresses)!==JSON.stringify(ej.trustedIps?.addresses),eA=(M?.trustedIps||ej.trustedIps)&&(M?.trustedIps?.deploymentType!==ej.trustedIps?.deploymentType||M?.trustedIps?.protectionMode!==ej.trustedIps?.protectionMode||ek),eS=Q&&eg.find(e=>{let{error:t}=e;return!!t}),eE=z&&eA&&!eS&&(!ej.trustedIps||ej.trustedIps.addresses.length>0),eD=W?.billing?.plan==="enterprise"&&z,eR=(0,s.useCallback)(()=>z?eD?(0,t.jsxs)("p",{className:"text-gray-900 text-copy-14",children:["Learn more about"," ",(0,t.jsx)(j.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-protect-deployments/trusted-ips",type:"highlight",children:"Trusted IPs"})]}):(0,t.jsxs)("span",{className:"text-gray-900 text-copy-14",children:["This feature is available on the"," ",(0,t.jsx)(j.Link,{external:!0,href:"/pricing",type:"highlight",children:"Enterprise plan"}),"."]}):(0,t.jsxs)("p",{className:"text-gray-900 text-copy-14",children:["You need additional permissions to manage your project's"," ",(0,t.jsx)(j.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-protect-deployments/trusted-ips",type:"highlight",children:"Trusted IPs"}),"."]}),[z,eD]);if(eT)return(0,t.jsx)(V,{});let eM=el||!Q||!q,eO=!(M.ssoProtection||M.passwordProtection||M.trustedIps?.protectionMode==="exclusive"),e_=eg.length>=J,eB=()=>{ep(!1)},eL=!z||!eD,eF=M.ssoProtection?.deploymentType||K?null:"Vercel Authentication must also enabled to enable Trusted IPs in preview environments.";return(0,t.jsxs)(A.ProjectSettingsFieldset,{action:eD?null:(0,t.jsx)(j.ButtonLink,{"data-testid":(0,y.tid)("project-settings","paid-feature","contact-sales"),href:f.CONTACT_SALES_DASHBOARD_HREF,size:"small",tab:!0,children:"Contact Sales"}),description:(0,t.jsxs)(t.Fragment,{children:["Restrict access to deployments to visitors from specific IP addresses only. A maximum of ",J," IP addresses can be added."]}),disabled:!z,disabledForBilling:eL,error:eo,highlightNote:!z,note:eR(),onSave:eD?async()=>{Q?await eb():ep(!0)}:null,saveDisabled:!eE,saveLoading:el,title:"Trusted IPs",headerNote:Q?(0,t.jsx)(B.MicrofrontendsHelpBadge,{childHelp:(0,t.jsxs)(t.Fragment,{children:["This configuration applies only to this project's domains. It's recommended to protect"," ",(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium text-inherit",children:"All Deployments"})," ","for a child microfrontends project."]}),parentHelp:"This configuration applies to production and pre-production deployments for the group."}):null,children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-row flex-wrap items-center justify-start flex-initial gap-2 md:gap-4",children:[(0,t.jsx)("div",{className:"flex flex-row items-center justify-start flex-initial gap-2",children:(0,t.jsx)(r.Toggle,{"aria-labelledby":"label-for-trusted-ips-enabled-toggle",checked:Q,direction:"switch-first",onChange:ev,size:"large",style:{padding:"var(--geist-gap-quarter) 0"},children:(0,t.jsx)("p",{className:(0,m.clsx)("text-[14px] leading-[20px] font-medium normal-case",eL?"text-gray-800":void 0),id:"label-for-trusted-ips-enabled-toggle",children:Q?"Enabled for":"Disabled"})})}),Q?(0,t.jsx)(R.DeploymentTypeSelector,{disabled:eM,onChange:eP,overrides:{preview:{disabledDescription:eF},production:{},all:{disabledDescription:eF},all_except_custom_domains:{disabledDescription:eF},prod_deployment_urls_and_all_previews:{disabledDescription:eF}},currentValue:M?.trustedIps?.deploymentType,project:M,selectedValue:et}):null]}),(0,t.jsx)("hr",{className:(0,m.clsx)("geist-hr-reset","geist-show-on-mobile")}),(0,t.jsxs)("form",{autoComplete:"off",className:"flex flex-col items-stretch justify-start flex-initial gap-3",children:[(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start flex-initial gap-1",children:[(0,t.jsx)("p",{className:(0,m.clsx)("text-[14px] leading-[20px] font-medium uppercase",eL?"text-gray-800":"text-gray-900"),id:"label-for-trusted-ips-trusted-ips-input",children:"IP / CIDR"}),(0,t.jsx)(n.Tooltip,{text:"Supported formats: IPv4 and IPv4 CIDR.",children:(0,t.jsx)(d.Information,{})})]}),(0,t.jsx)(c.Entity.List,{className:_.default.list,children:eg.sort((e,t)=>e.renderingId>t.renderingId?1:-1).map((e,s)=>{let{renderingId:a,value:l,note:r,error:d,warning:u}=e,y=!eM&&(d||u)&&l?(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start flex-initial gap-2",children:[d?(0,t.jsx)(h.Stop,{color:"red-900",size:14,style:{flexShrink:0}}):(0,t.jsx)(x.Warning,{color:"amber-900",size:14,style:{flexShrink:0}}),(0,t.jsx)("span",{className:(0,m.clsx)("text-copy-14",d?"text-red-900":"text-amber-900"),children:d||u})]}):null;return(0,t.jsx)(c.Entity,{footer:y,left:(0,t.jsxs)("p",{className:"text-copy-14",style:{width:"20px",marginTop:"-2px"},children:[s+1,"."]}),right:(0,t.jsx)(n.Tooltip,{disableTriggers:eM,text:"Remove",children:(0,t.jsx)(i.Button,{"aria-label":"Remove IP Address",disabled:eM,id:`remove-input-${a}`,onClick:()=>eI(a),shape:"circle",size:"small",style:{border:"none",background:"none"},svgOnly:!0,type:"tertiary",children:(0,t.jsx)(p.MinusCircle,{})})}),children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start flex-initial w-full gap-4",children:[(0,t.jsx)(o.Input,{"aria-labelledby":"label-for-trusted-ips-trusted-ips-input",autoComplete:"one-time-code",autoFocus:ek,disabled:eM,error:eM?null:d,innerWrapperClassName:(0,m.clsx)(_.default.input,_.default.ipInput,"shadow-none"),onBlur:e=>eC(a,e),onChange:e=>eN(a,{value:e.target.value}),placeholder:eM?"":d||"85.146.82.237",showErrorMessage:!1,size:"small",type:u?"warning":void 0,value:l}),(0,t.jsx)(o.Input,{"aria-labelledby":"label-for-trusted-ips-trusted-ips-input",autoComplete:"one-time-code",disabled:eM,innerWrapperClassName:(0,m.clsx)(_.default.input,_.default.noteInput,"shadow-none"),maxLength:20,onBlur:e=>eC(a,e),onChange:e=>eN(a,{note:e.target.value}),placeholder:eM?"":"Add note",size:"small",value:r})]})},a)})})]}),(0,t.jsx)(n.Tooltip,{disableTriggers:!e_,position:"right",style:{alignSelf:"flex-start"},text:`Maximum ${J} addresses allowed.`,children:(0,t.jsx)(i.Button,{disabled:eM||e_,onClick:ew,prefix:(0,t.jsx)(u.PlusCircle,{}),size:"small",style:{alignSelf:"flex-start"},type:"secondary",children:"Add another"})}),K?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("hr",{className:"geist-hr-reset"}),(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start flex-initial gap-2",children:[(0,t.jsx)("p",{className:(0,m.clsx)("text-[14px] leading-[20px] font-medium",eM?"text-gray-900":void 0),children:"Protection mode"}),(0,t.jsx)(O,{disabled:eM,onChange:ea,overrides:{exclusive:{disabledDescription:eO?"No additional protections currently enabled.":null}},selectedValue:en})]})]}):null,(0,t.jsx)(S.AnimatedNote,{keyName:"trusted-ips-ip-note",children:Q&&"exclusive"===en&&!(M.passwordProtection||M.ssoProtection)?(0,t.jsx)("span",{children:"Configuration of Trusted IP Optional with no other protections enabled has no effect."}):null})]}),(0,t.jsxs)(a.Modal.Modal,{active:ed,onClickOutside:eB,children:[(0,t.jsx)(a.Modal.Body,{children:(0,t.jsxs)("div",{className:"flex flex-col items-start justify-start flex-initial gap-4",children:[(0,t.jsx)(a.Modal.Title,{children:"Disable Trusted IPs"}),(0,t.jsx)(a.Modal.Subtitle,{children:"If you disable Trusted IPs, you will lose any previous values."}),(0,t.jsx)(a.Modal.Subtitle,{children:"Are you sure you want to continue?"})]})}),(0,t.jsxs)(a.Modal.Actions,{children:[(0,t.jsx)(a.Modal.Action,{onClick:eB,type:"secondary",children:"Cancel"}),(0,t.jsx)(a.Modal.Action,{onClick:async()=>{ep(!1),await eb()},children:"Continue"})]})]})]})}let F=e=>"number"!=typeof e?20:e>200?200:e<20?20:e;function V(){return(0,t.jsx)(I.default,{height:280})}e.s(["TrustedIps",0,function(){return(0,t.jsx)(s.Suspense,{fallback:(0,t.jsx)(V,{}),children:(0,t.jsx)(L,{})})}],9855670)},7912,e=>{"use strict";var t=e.i(847684),s=e.i(7185353),i=e.i(4585051),n=e.i(2504781),a=e.i(3500331),l=e.i(8459493),r=e.i(6891161),o=e.i(8522580),c=e.i(5255926),d=e.i(455575),p=e.i(57106),u=e.i(8042625),h=e.i(277234),x=e.i(4244280),m=e.i(7917902),y=e.i(1717203),g=e.i(7557283),f=e.i(7218483),j=e.i(3802983),b=e.i(1452806),v=e.i(3555274),P=e.i(1138941),w=e.i(6060673),I=e.i(5807088),N=e.i(2882012),C=e.i(7909933),T=e.i(9068719),k=e.i(4470704),A=e.i(185801),S=e.i(1475969),E=e.i(9367781);function D(e){let{value:s}=e;return(0,t.jsx)(i.Avatar,{size:30,uid:s})}function R(e){let{value:t}=e;return(0,f.useAge)(t,{justNowThreshold:6e4})}function M(){let e=(0,d.useToasts)(),i=(0,P.useProjectIdOrName)(),{data:f}=(0,w.useProject)(i),{user:I,team:M}=(0,m.useAccount)(),{can:_,isLoading:B}=(0,y.default)(),[L,F]=(0,s.useState)(!1),[V,H]=(0,s.useState)(null),[U,$]=(0,s.useState)(null),[z,q]=(0,s.useState)(!1),[Y,W]=(0,s.useState)(null),[G,J]=(0,s.useState)(null),{data:{exceptions:K=[]}={},mutate:Z}=function(e,t){let{projectId:s,teamId:i}=e;return(0,C.default)(()=>s?`${(0,x.API_PROJECTS_VERSION)("v10")}/${s}/deployment-protection-exceptions${(0,u.encode)({teamId:i})}`:null,e=>(0,h.fetchAPI)(e),void 0)}({teamId:M?.id,projectId:f?.id}),Q=(0,s.useCallback)(async(s,i)=>{if(!z&&("create"!==s||Y)&&f){$(null),q(!0);try{let[n,a]=await Promise.all([(0,h.fetchAPI)(`${x.API_ALIASES}/${i}${(0,u.encode)({teamId:M?.id,projectId:f.id})}`,{throwOnHTTPError:!0}),(0,h.fetchAPI)((0,k.getDeploymentKey)(i,M?.id),{throwOnHTTPError:!1})]),l=(n?{id:n.uid,url:n.alias}:void 0)??(a&&a.url===i&&a.projectId===f.id?a:void 0);l?(await (0,N.updateAliasProtectionBypass)({teamId:M?.id,aliasId:l.id,body:{override:{scope:"alias-protection-override",action:s}}}),e.success("create"===s?`Successfully unprotected ${l.url}`:`Successfully removed ${l.url} from Deployment Protection Exceptions`),W(null)):$((0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("b",{children:i})," not found in project ",(0,t.jsx)("b",{children:f.name}),"."]}))}catch(e){$(e.message||"An error occured, please try again later.")}F(!1),await Z(),q(!1)}},[Y,M?.id,z,f,e,Z]),{addOn:X,isADPEnabled:ee,enableADP:et,ADPModal:es}=(0,T.useToggleAdvancedDeploymentProtection)("project-settings-deployment-protection-exceptions"),{enabled:ei,message:en,action:ea}=(0,v.default)({addOn:X,isEnabled:ee,enable:et,modal:es}),el=!f||!(M||I)||B,er=_(g.Action.Update,g.Resource.Project),eo=_(g.Action.Update,g.Resource.AliasProtectionBypass),ec=_(g.Action.List,g.Resource.AliasProtectionBypass),ed=_(g.Action.Create,g.Resource.PasswordProtection),ep=(0,s.useCallback)(()=>er&&eo&&ec?ei?(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["Learn more about"," ",(0,t.jsx)(p.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-bypass-deployment-protection/deployment-protection-exceptions",type:"highlight",children:"Deployment Protection Exceptions"})]}):ed?en:(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["You need additional permissions to enable"," ",(0,t.jsx)(p.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-bypass-deployment-protection/deployment-protection-exceptions",type:"highlight",children:"Deployment Protection Exceptions"})," ","for your project."]}):(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["You need additional permissions to manage your project's"," ",(0,t.jsx)(p.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-bypass-deployment-protection/deployment-protection-exceptions",type:"highlight",children:"Deployment Protection Exceptions"}),"."]}),[er,ei,en,ed,eo,ec]),eu=(0,s.useCallback)(()=>(H(null),!!Y&&(!K.map(e=>{let{alias:t}=e;return t}).includes(Y)||(H((0,t.jsxs)(t.Fragment,{children:["Invalid Input: ",(0,t.jsx)("b",{children:Y})," is already included in Deployment Protection Exceptions."]})),!1))),[Y,K]),eh=()=>{$(null),W(null),F("add")},ex=(0,s.useCallback)(e=>{e.preventDefault(),eu()&&F("confirm-add")},[eu]),em=(0,s.useCallback)(async e=>{e.preventDefault(),Y&&await Q("create",Y)},[Y,Q]),ey=(0,s.useCallback)(async e=>{e.preventDefault(),G&&await Q("revoke",G)},[G,Q]),eg=(0,s.useCallback)(()=>{H(null),Y||W("")},[Y]),ef=(0,s.useCallback)(()=>{eu(),Y||W(null)},[Y,eu]),ej=(0,s.useMemo)(()=>{switch(L){case"add":return{title:"Unprotect Domain",description:"Enter the preview domain that you would like to unprotect.",body:(0,t.jsx)(j.default,{error:V,id:"alias",name:"alias",onBlur:ef,onChange:e=>W(e.target.value),onFocus:eg,placeholder:"domain.vercel.app",required:!0,value:Y||"",width:"100%"}),actionTitle:"Continue",action:ex};case"confirm-add":return{title:"Unprotect Domain",description:(0,t.jsxs)(o.Note,{fill:!0,type:"warning",variant:"contrast",children:["This action will remove any deployent protection for the domain, making it ",(0,t.jsx)("b",{children:"publicly accessible"}),", until the domain is manually removed from this list."]}),body:(0,t.jsx)(r.Modal.Inset,{last:!0,children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsx)("label",{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["Enter the domain"," ",(0,t.jsx)("b",{style:{overflowWrap:"anywhere"},children:Y})," ","to continue:"]}),(0,t.jsx)(a.Input,{"aria-label":"Domain Name",disabled:z,pattern:`\\s*${Y||""}\\s*`,required:!0})]})}),(0,t.jsx)("label",{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["To verify, type ",(0,t.jsx)("b",{children:"unprotect my domain"})," below:"]}),(0,t.jsx)(a.Input,{"aria-label":"Verification Code",disabled:z,pattern:"\\s*unprotect my domain\\s*",required:!0})]})})]})}),actionTitle:"Confirm",action:em};case"confirm-remove":return{title:"Reprotect Domain",description:(0,t.jsxs)(o.Note,{fill:!0,type:"warning",variant:"contrast",children:["This action will reprotect the domain with Deployment Protection, making it ",(0,t.jsx)("b",{children:"no longer publicly accessible"}),"."]}),body:(0,t.jsx)(r.Modal.Inset,{last:!0,children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsx)("label",{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["Enter the domain"," ",(0,t.jsx)("b",{style:{overflowWrap:"anywhere"},children:G})," ","to continue:"]}),(0,t.jsx)(a.Input,{"aria-label":"Domain Name",disabled:z,pattern:`\\s*${G||""}\\s*`,required:!0})]})}),(0,t.jsx)("label",{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["To verify, type ",(0,t.jsx)("b",{children:"reprotect my domain"})," below:"]}),(0,t.jsx)(a.Input,{"aria-label":"Verification Code",disabled:z,pattern:"\\s*reprotect my domain\\s*",required:!0})]})})]})}),actionTitle:"Confirm",action:ey};case!1:return null}},[L,G,Y,V,ef,em,ey,eg,ex,z]);return el?(0,t.jsx)(O,{}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(A.ProjectSettingsFieldset,{action:ed?ea:void 0,description:(0,t.jsxs)("span",{className:"flex flex-col md:flex-row items-start justify-between gap-4 flex-initial",children:[(0,t.jsxs)("span",{children:["Specify pre-production domains that you want to exclude from Deployment Protection. ",(0,t.jsx)("br",{}),(0,t.jsxs)("span",{className:"text-copy-14",children:["Domains listed will become"," ",(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium text-inherit",children:"unprotected"})," ","and"," ",(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium text-inherit",children:"publicly accessible"}),"."]})]}),(0,t.jsx)(n.Button,{onClick:eh,type:"warning",children:"Add Domain"})]}),disabled:!er,disabledForBilling:!er||!ei||!eo||!ec,error:U,highlightNote:!er,note:ep(),saveLoading:z,title:"Deployment Protection Exceptions",headerNote:(0,t.jsx)(E.MicrofrontendsHelpBadge,{childHelp:"This configuration only applies to domains belonging to this project.",parentHelp:"This configuration only applies to domains belonging to this project."}),children:K.length>0?(0,t.jsx)(b.default,{caption:"Unprotected Domains",columns:[{Header:"Unprotected Domains",accessor:"alias"},{Header:"Creator",accessor:"createdBy",Cell:D},{Header:"Age",accessor:"createdAt",Cell:R}],data:K.map(e=>{let{alias:t,protectionBypass:s}=e,{createdBy:i,createdAt:n}=(0,S.getAliasDeploymentProtectionException)(s)||{};return{alias:t,createdBy:i,createdAt:n}}),headerActions:()=>(0,t.jsx)(l.MenuItem,{onClick:eh,children:"Add domain"}),rowActions:e=>{let{row:{original:{alias:s}}}=e;return(0,t.jsx)(l.MenuItem,{onClick:()=>{J(s),F("confirm-remove")},type:"error",children:"Remove"})},selectable:!0,sortable:!0}):null}),(0,t.jsx)(r.Modal.Modal,{active:!!ej,onClickOutside:()=>F(!1),width:480,children:(0,t.jsxs)("form",{onSubmit:ej?.action,children:[(0,t.jsx)(r.Modal.Body,{children:(0,t.jsx)(r.Modal.Header,{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[ej?(0,t.jsx)("p",{className:"text-[20px] leading-[24px] tracking-[-0.33px] font-medium",children:ej.title}):(0,t.jsx)(c.Skeleton,{height:24,width:"100%"}),(0,t.jsx)(r.Modal.Subtitle,{children:(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:ej?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:ej.description}),(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:ej.body})]}):(0,t.jsx)(c.Skeleton,{height:80,width:"100%"})})})]})})}),(0,t.jsxs)(r.Modal.Actions,{children:[(0,t.jsx)(r.Modal.Action,{onClick:()=>F(!1),type:"secondary",children:"Cancel"}),ej?(0,t.jsx)(r.Modal.Action,{buttonType:"submit",loading:z||!ej,type:"warning",children:ej.actionTitle}):(0,t.jsx)(c.Skeleton,{height:40,width:50})]})]})})]})}function O(){return(0,t.jsx)(I.default,{height:170})}e.s(["DeploymentProtectionExceptions",0,function(){return(0,t.jsx)(s.Suspense,{fallback:(0,t.jsx)(O,{}),children:(0,t.jsx)(M,{})})}],7912)},1131172,e=>{"use strict";var t=e.i(847684),s=e.i(7185353),i=e.i(2504781),n=e.i(3500331),a=e.i(1906681),l=e.i(5468328),r=e.i(455575),o=e.i(57106),c=e.i(7957251),d=e.i(5883567),p=e.i(8042625),u=e.i(277234),h=e.i(4244280),x=e.i(7917902),m=e.i(1717203),y=e.i(7557283),g=e.i(1138941),f=e.i(6060673),j=e.i(5807088),b=e.i(185801),v=e.i(9367781),P=e.i(9722978);function w(){let e=(0,g.useProjectIdOrName)(),{data:s,mutate:i}=(0,f.useProject)(e),{team:n}=(0,x.useAccount)(),{can:a,isLoading:l}=(0,m.default)();return!s||l?(0,t.jsx)(I,{}):(0,t.jsx)(N,{can:a,project:s,revalidateProject:i,teamId:n?.id})}function I(){return(0,t.jsx)(j.default,{height:170})}function N(e){let{project:n,revalidateProject:c,teamId:x,can:m}=e,g=n.optionsAllowlist,[f,j]=(0,s.useState)(!!g),[w,I]=(0,s.useState)(g?.paths.map(e=>{let{value:t}=e;return{value:t,key:T(t)}})||[{value:"",key:T("")}]),[N,k]=(0,s.useState)(null),[A,S]=(0,s.useState)(!1),E=m(y.Action.Update,y.Resource.Project),D=m(y.Action.Update,y.Resource.OptionsAllowlist),R=m(y.Action.Read,y.Resource.OptionsAllowlist),M=!E||!D||!R,O=(0,s.useMemo)(()=>JSON.stringify({optionsAllowlist:f?{paths:w.map(e=>{let{value:t}=e;return{value:t}})}:null}),[f,w]),_=(0,s.useMemo)(()=>!!(f?O!==JSON.stringify({optionsAllowlist:g}):g),[f,O,g]),B=(0,s.useMemo)(()=>_?f&&0===w.length?"Must have at least one path":f&&w.some(e=>""===e.value)?"Cannot save empty paths":f&&w.some(e=>!e.value.startsWith("/"))?"Paths must start with a /":void 0:"No changes made",[f,w,_]),L=(0,s.useCallback)(async()=>{if(k(null),!B){S(!0);try{await (0,u.fetchAPI)(`${(0,h.API_PROJECTS_VERSION)("v5")}/${n.id}${(0,p.encode)({teamId:x})}`,{method:"PATCH",body:O,throwOnHTTPError:!0}),f||I([{value:"",key:T("")}]),r.toasts.success("OPTIONS Allowlist updated.")}catch(e){k(`Request failed: ${e.message}`)}await c(),S(!1)}},[n.id,x,c,O,f,B]),F=(0,s.useCallback)(()=>M?(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["You need additional permissions to manage your project's"," ",(0,t.jsx)(o.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-bypass-deployment-protection/options-allowlist",type:"highlight",children:"OPTIONS Allowlist"}),"."]}):(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["Learn more about"," ",(0,t.jsx)(o.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-bypass-deployment-protection/options-allowlist",type:"highlight",children:"OPTIONS Allowlist"})]}),[M]),V=(0,s.useMemo)(()=>w.length>=5?"Maximum number of paths reached":D?void 0:"Missing required permission",[w,D]),H=(0,s.useCallback)(()=>{k(null),I([...w,{value:"",key:T("")}])},[w]),U=(0,s.useCallback)(e=>{k(null),I(w.filter(t=>t.key!==e))},[w]),$=(0,s.useCallback)((e,t)=>{k(null),I(w.map(s=>s.key===e?{...s,value:t}:s))},[w]),z=(0,s.useCallback)(()=>{k(null),j(!f)},[f]),q={noPermission:D?null:"Missing required permission",noProtectionEnabled:n.ssoProtection||n.passwordProtection||n.trustedIps||g?null:"No protections currently enabled for the project."},Y=q.noPermission||q.noProtectionEnabled;return(0,t.jsx)(b.ProjectSettingsFieldset,{description:(0,t.jsxs)(t.Fragment,{children:["Specify paths to be unprotected for ",(0,t.jsx)("code",{children:"OPTIONS"})," requests. This can be used to enable"," ",(0,t.jsx)(o.Link,{external:!0,href:"https://developer.mozilla.org/en-US/docs/Glossary/Preflight_request",variant:"highlight",children:"CORS preflight"})," ","requests to this project's protected deployments, as browsers do not send authentication on preflight requests. If an incoming request path"," ",(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium text-inherit",children:"starts with"})," ","one of the specified paths, and has the method ",(0,t.jsx)("code",{children:"OPTIONS"}),", the request will bypass deployment protection."]}),disabled:!E,disabledForBilling:M,error:N,highlightNote:!E,note:F(),onSave:L,saveDisabled:!!B,saveDisabledMessage:B,saveLoading:A,title:"OPTIONS Allowlist",headerNote:f?(0,t.jsx)(v.MicrofrontendsHelpBadge,{childHelp:"This configuration only applies to domains belonging to this project.",parentHelp:"This configuration applies to production and pre-production deployments for the group."}):null,children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsx)(l.Tooltip,{forceHide:!Y,text:Y,children:(0,t.jsx)(a.Toggle,{"aria-labelledby":"label-for-protection-bypass-automation-header",checked:f,direction:"switch-first",disabled:!!Y,onChange:z,size:"large",children:(0,t.jsx)("p",{className:(0,P.default)("text-[14px] leading-[20px] font-medium",Y?"text-gray-900":""),id:"label-for-protection-bypass-automation-header",children:f?"Enabled":"Disabled"})})}),f?(0,t.jsxs)(t.Fragment,{children:[w.map(e=>(0,t.jsx)(C,{canRemove:w.length>1&&D,onChange:t=>$(e.key,t),onRemove:()=>U(e.key),path:e},e.key)),(0,t.jsx)(l.Tooltip,{style:{alignSelf:"flex-start"},text:V,children:(0,t.jsx)(i.Button,{disabled:!!V,onClick:H,prefix:(0,t.jsx)(d.PlusCircle,{}),size:"small",style:{alignSelf:"flex-start"},type:"secondary",children:"Add path"})})]}):null]})})}function C(e){let{path:s,onRemove:a,canRemove:l,onChange:r}=e;return(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsx)(n.Input,{"aria-labelledby":"path input",defaultValue:s.value,onChange:e=>r(e.target.value),placeholder:"/api",width:"100%"}),(0,t.jsx)(i.Button,{"aria-label":"Remove",disabled:!l,onClick:a,shape:"square",svgOnly:!0,type:"secondary",children:(0,t.jsx)(c.MinusCircle,{})})]})}function T(e){return`${e}-${Math.random()}-${Date.now()}`}e.s(["OPTIONSAllowlist",0,function(){return(0,t.jsx)(s.Suspense,{fallback:(0,t.jsx)(I,{}),children:(0,t.jsx)(w,{})})}])}]);

//# debugId=02e786f2-b245-a2d2-051e-95dcb96d299c
//# sourceMappingURL=9c31db71d1ddbea8.js.map