;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="4e8f977f-a8f9-46c7-63a3-ff5a2aed1182")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,9937599,e=>{"use strict";let a=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M11.5253 10.2634L8 13.8578L4.47471 10.2634C2.50843 8.25857 2.50843 4.99627 4.47471 2.99144C6.42507 1.00285 9.57493 1.00285 11.5253 2.99144C13.4916 4.99627 13.4916 8.25857 11.5253 10.2634ZM12.5962 11.3137L9.05051 14.9289L8 16L6.94949 14.9289L3.40381 11.3137C0.865397 8.72554 0.865399 4.52929 3.40381 1.94113C5.94222 -0.647042 10.0578 -0.647042 12.5962 1.94113C15.1346 4.52929 15.1346 8.72554 12.5962 11.3137ZM9 6.5C9 7.05228 8.55228 7.5 8 7.5C7.44772 7.5 7 7.05228 7 6.5C7 5.94772 7.44772 5.5 8 5.5C8.55228 5.5 9 5.94772 9 6.5ZM8 9C9.38071 9 10.5 7.88071 10.5 6.5C10.5 5.11929 9.38071 4 8 4C6.61929 4 5.5 5.11929 5.5 6.5C5.5 7.88071 6.61929 9 8 9Z" fill="currentColor"/>');e.s(["Location",0,a])},5164288,e=>{"use strict";var a=e.i(9979783);async function t(e){let{team:t,enableTeam:l}=e;await (0,a.typedFetchData)("/v1/security/plus","post",{teamId:t.id},{enabled:l},{throwOnHTTPError:!0})}e.s(["isSecurityPlusEnabled",0,function(e){let{team:a}=e;return a?.securityPlus?.enabled??!1},"patchSecurityPlusConfiguration",0,t])},1743600,2627313,e=>{"use strict";var a=e.i(2598434),t=e.i(455575);let l=null,r=null,n=null;async function s(){try{let e=await fetch("https://bots.fyi/bots");if(!e.ok)throw Error("Failed to fetch verified bots");let a=await e.json(),t={names:[],categories:[]},n=new Set;for(let e of a)t.names.push({label:e.displayName,value:e.name}),n.has(e.category)||(t.categories.push({label:e.category.replace(/\bai\b|_(.)|^\w/g,(e,a)=>a?a.padStart(2," ").toUpperCase():e.toUpperCase()),value:e.category}),n.add(e.category));return l=t,r=Date.now(),t}catch(e){if(e instanceof Error){if("production"!==a.default.env.VERCEL_ENV)throw e;return t.toasts.error("Error fetching bot data"),{categories:[],names:[]}}throw e}}async function i(){return l&&r&&Date.now()-r<6e5?l:n||(n=s().catch(e=>{throw l=null,r=null,e}).finally(()=>{n=null}))}e.s(["fetchVerifiedBots",0,i],1743600);var o=e.i(847684),d=e.i(7185353);let u=(0,d.createContext)(null);u.displayName="ItemStateContextProvider",e.s(["FilterItemStateProvider",0,function(e){let{children:a,state:t,index:l,moduleConfig:r,groupId:n}=e,s=(0,d.useMemo)(()=>({state:t,moduleConfig:r,index:l,groupId:n}),[t,r,l,n]);return(0,o.jsx)(u.Provider,{value:s,children:a})},"useItemStateContext",0,function(){let e=(0,d.useContext)(u);if(null===e)throw Error("Filter context should be wrapped in Provider");return e}],2627313)},467779,e=>{"use strict";var a=e.i(847684),t=e.i(7185353),l=e.i(8914449),r=e.i(9544652);let n=(0,t.createContext)(null);function s(e){let{children:t,disabled:l,store:s}=e;return(0,a.jsx)(n.Provider,{value:s,children:(0,a.jsx)(r.DisabledContext.Provider,{value:!!l,children:t})})}n.displayName="FilterContextProvider",s.displayName="FilterProvider",e.s(["FilterProvider",0,s,"useFilterContext",0,function(){let e=(0,t.useContext)(n);if(null===e)throw Error("Filter context should be wrapped in Provider");return(0,l.useStore)(e)}])},5120783,3957279,7894499,7754792,8181947,5812308,e=>{"use strict";var a=e.i(847684),t=e.i(9937599),l=e.i(8626589),r=e.i(8486711),n=e.i(764581),s=e.i(2375916),i=e.i(6675233);e.i(3512434);var o=e.i(9835407),d=e.i(455575),u=e.i(7429602),c=e.i(1637579),p=e.i(1361980),m=e.i(5164288),h=e.i(1743600),v=e.i(4496450),x=e.i(7047540),f=e.i(2504781),g=e.i(6881349),b=e.i(3500331),y=e.i(8674454),w=e.i(6694387),C=e.i(4991687),j=e.i(8459493),S=e.i(8522580),N=e.i(9544652),_=e.i(6318858),I=e.i(2560270),z=e.i(923772),E=e.i(7185353),T=e.i(2627313),P=e.i(467779),O=e.i(9689002),A=e.i(3869281),R=e.i(3306538),k=e.i(1821888),$=e.i(9376050),D=e.i(9550268),L=e.i(5883567),M=e.i(9722978);let V={values:[],valueSet:new Set,initialSet:new Set,options:[]};function q(e,a){switch(a.type){case"INITIALIZE":return{...e,...a.payload};case"TOGGLE_VALUE":{let{item:t,allowMulti:l}=a.payload,r=new Set(e.valueSet);if(r.has(t.value))return r.delete(t.value),{...e,values:e.values.filter(e=>e.value!==t.value),valueSet:r,initialSet:l?e.initialSet:new Set([])};return r.add(t.value),{...e,values:l?[...e.values,t]:[t],valueSet:l?r:new Set([t.value]),initialSet:l?e.initialSet:new Set}}case"ADD_NEW":{let t=new Set(e.valueSet),l=new Set(e.initialSet),r=Array.isArray(a.payload.item)?a.payload.item.map(e=>({value:e,label:`"${e}"`})):[{value:a.payload.item,label:`"${a.payload.item}"`}];return r.forEach(e=>{l.add(e.value),t.add(e.value)}),{...e,values:a.payload.allowMulti?[...e.values,...r]:r,valueSet:a.payload.allowMulti?t:new Set(r.map(e=>e.value)),initialSet:a.payload.allowMulti?l:new Set(r.map(e=>e.value))}}case"CLOSE_SELECT":{let a=new Set(e.values.map(e=>e.value));return{...e,initialSet:a}}default:return e}}function H(e){let{errors:t,initialValue:l,allowAdd:r,allowMulti:n=!1,filterName:s,disabled:i,onChange:o,getOptions:d,labels:u,placeholder:c,updateOnChange:p}=e,[m,h]=(0,E.useReducer)(q,V),[v,x]=(0,E.useState)(!1),[f,g]=(0,E.useState)(""),b=(0,E.useRef)(null);(0,E.useEffect)(()=>{(async()=>{let e=Array.isArray(l)?l:[l],a=new Set(e.map(e=>`${e}`)),t=new Set(a),n=[],s=[];if(void 0===d)n=e.map(e=>({value:`${e}`,label:`"${e}"`}));else{if(s=await d(),r)for(let a of e.filter(Boolean))s.some(e=>e.value===`${a}`)||s.push({value:`${a}`,label:u?.[a]||`"${a}"`});n=s.filter(e=>a.has(e.value))}h({type:"INITIALIZE",payload:{values:n,valueSet:a,initialSet:t,options:s}})})()},[l,r,n,s,d,t,u]);let y=(0,E.useMemo)(()=>t?new Set(t.map(e=>e.value)):new Set,[t]),w=(0,E.useMemo)(()=>m.values.filter(e=>m.valueSet.has(e.value)),[m.values,m.valueSet]),C=m.values.filter(e=>m.initialSet.has(e.value)),j=(0,E.useCallback)(e=>{h({type:"TOGGLE_VALUE",payload:e})},[]),S=(0,E.useMemo)(()=>Array.from(new Set([...m.options,...m.values])),[m.options,m.values]),N=(0,E.useCallback)(e=>{o?.(e)},[o]);(0,E.useEffect)(()=>{p&&N([...m.valueSet])},[m.valueSet,N,p]);let _=S.filter(e=>m.initialSet.has(e.value)),I=m.options.filter(e=>!m.initialSet.has(e.value));return(0,a.jsxs)(k.Root,{onOpenChange:e=>{e||(h({type:"CLOSE_SELECT"}),g(""),o?.([...m.valueSet])),x(e)},open:v,children:[(0,a.jsx)(k.Anchor,{className:"flex w-full items-center",children:(0,a.jsx)(k.Trigger,{className:(0,M.clsx)("my-0 size-full min-h-[32px] items-center rounded border-gray-alpha-400 bg-background-100 px-3 py-0 outline outline-1 outline-gray-alpha-400 data-[state=open]:bg-gray-100 data-[state=open]:shadow-focus-border focus-visible:shadow-focus-ring disabled:border-gray-400 disabled:bg-gray-100 disabled:text-gray-700",{"data-[state=open]:shadow-focus-border data-[state=open]:border-gray-alpha-400 shadow-[0_0_0_1px_var(--ds-red-900),0_0_0_4px_var(--ds-red-300)]":t}),disabled:i,children:(0,a.jsxs)("div",{className:"flex h-full items-center gap-x-2",children:[(0,a.jsx)("span",{children:(0,a.jsx)(D.ListUnordered,{size:16})}),(0,a.jsx)("div",{className:"grid",children:(0,a.jsxs)("p",{className:"text-copy-14 truncate text-inherit","aria-disabled":i,children:[n&&w.length>0?(0,a.jsx)("span",{className:"text-sm text-gray-900",children:`${w.length} ${1===w.length?s:function(e){for(let[a,t]of[[/ss$/,"sses"],[/s$/,"s"],[/s$/,"es"],[/(?![aeiou])y$/,"ies"]])if(a.test(e))return e.replace(a,t);return`${e}s`}(s)}: `}):null,w.length>0?w.map((e,t)=>y.has(e.value)?(0,a.jsxs)("span",{className:"text-red-900",children:[e.label.replaceAll('"',""),`${t<w.length-1?", ":""}`]},e.value):`${e.label.replaceAll('"',"")}${t<w.length-1?", ":""}`):(0,a.jsx)("span",{className:"text-gray-700",children:`Add option${n?"s":""}`})]})})]})})}),(0,a.jsx)(k.Portal,{children:(0,a.jsx)(k.Content,{className:"tailwind-preflight",side:"bottom",sideOffset:8,children:(0,a.jsxs)($.Command,{className:"w-[var(--radix-popover-trigger-width)] min-w-[320px] justify-between rounded-lg border-gray-alpha-400 bg-background-100 shadow-menu",children:[(0,a.jsxs)("div",{className:(0,M.clsx)("-mb-px flex w-full items-center justify-between px-4 py-3",(C.length>0||f||m.options.length>0)&&"border-b"),children:[(0,a.jsx)($.Command.Input,{className:"w-full border-none bg-transparent text-sm outline-none",onPaste:e=>{if(!r)return;e.preventDefault();let a=e.clipboardData.getData("text").split("\n").map(e=>e.trim());n?h({type:"ADD_NEW",payload:{item:a,allowMulti:n}}):h({type:"ADD_NEW",payload:{item:a[0],allowMulti:n}})},onValueChange:g,placeholder:c&&c.length>0?c:"Search…",ref:b,value:f}),(0,a.jsx)(O.Kbd,{small:!0,children:"Esc"})]}),(0,a.jsxs)($.Command.List,{className:"flex max-h-[288px] flex-col gap-y-5 overflow-y-auto border-gray-alpha-400",children:[C.length>0?(0,a.jsx)($.Command.Group,{className:"p-2",children:_.map(e=>(0,a.jsx)($.Command.Item,{className:"w-full rounded *:aria-selected:bg-gray-100 data-[selected=true]:bg-gray-100 hover:bg-gray-100 focus-visible:bg-gray-100 active:bg-gray-100",onSelect:()=>j({item:e,allowMulti:n}),value:`${e.label}-${e.value}`,children:(0,a.jsxs)("div",{className:"flex w-full gap-2 rounded p-2",children:[(0,a.jsx)(A.Checkbox,{checked:m.valueSet.has(e.value),className:"pointer-events-none gap-1 text-sm",onChange:()=>{},tabIndex:-1,children:e.label}),y.has(e.value)?(0,a.jsx)(R.Badge,{size:"sm",variant:"red-subtle",children:"Invalid Option"}):null]})},e.value))}):null,I.length>0?(0,a.jsx)($.Command.Group,{className:(0,M.clsx)("p-2",I.length&&"border-t"),children:I.map(e=>(0,a.jsx)($.Command.Item,{className:"w-full rounded *:aria-selected:bg-gray-100 data-[selected=true]:bg-gray-100 hover:bg-gray-100 focus:bg-gray-100 active:bg-gray-100",onSelect:()=>j({item:e,allowMulti:n}),value:`${e.label}-${e.value}`,children:(0,a.jsx)("div",{className:"w-full rounded p-2",children:(0,a.jsx)(A.Checkbox,{checked:m.valueSet.has(e.value),className:"pointer-events-none gap-1 text-sm",onChange:()=>{},tabIndex:-1,children:e.label})})},`${e.value}-${e.label}`))}):[],(0,a.jsx)($.Command.Group,{children:r?(0,a.jsx)(F,{onAddNew:e=>{h({type:"ADD_NEW",payload:{item:e,allowMulti:n}}),b.current?.focus(),g("")},search:f}):null}),f.length?(0,a.jsx)($.Command.Empty,{className:"px-4 py-3 text-sm text-gray-900",children:`No results match "${f}"`}):null]}),(0,a.jsx)($.Command.Group,{className:"border-t border-gray-alpha-400 p-2",children:(0,a.jsx)($.Command.Item,{className:"cursor-default rounded p-2 aria-disabled:opacity-100",children:(0,a.jsxs)("span",{className:"text-xs text-gray-700",children:["Limits are calculated by the combination of"," ",(0,a.jsx)("strong",{children:"all"})," selected keys"]})})})]})})})]})}function F(e){let{search:t,onAddNew:l}=e;return 0===t.length?null:(0,a.jsx)("div",{className:"p-2",children:(0,a.jsx)($.Command.Item,{"aria-label":`add ${t}`,className:"w-full rounded *:aria-selected:bg-gray-100 data-[selected=true]:bg-gray-100 hover:bg-gray-100 focus:bg-gray-100 active:bg-gray-100",onSelect:()=>l(t),children:(0,a.jsxs)("div",{className:"flex items-center  gap-x-2 rounded p-2 text-gray-900",children:[(0,a.jsx)(L.PlusCircle,{size:14}),(0,a.jsx)("p",{className:"text-copy-14 text-gray-900",children:`Add "${t}"`})]})})})}e.s(["FilterSelectComponent",0,H],3957279);var U=e.i(9386557),B=e.i(5468328);function G(e){var t,l;let r,{className:n,disabled:s,error:i,id:o,onChange:d,value:u,...c}=e,[p,m]=(0,E.useState)(u?.toString()??""),h=(0,E.useRef)(null),v=(0,E.useRef)(null),x=(0,E.useCallback)(()=>{let{current:e}=v,{current:a}=h,t=getComputedStyle(document.documentElement).getPropertyValue("--geist-form-small-height");e&&a&&(e.style.height=t||"40px",e.style.height=`${e.scrollHeight}px`,a.style.height=e.style.height)},[h,v]);t=v,l=x,r=(0,E.useRef)(null),(0,E.useEffect)(()=>{let e=t.current;if(e&&"undefined"!=typeof ResizeObserver)return r.current=new ResizeObserver(l),r.current.observe(e),()=>{r.current?.disconnect()}},[l,t]),(0,E.useEffect)(x,[p]);let f=(0,E.useMemo)(()=>{let e=p.startsWith(" "),a=p.endsWith(" ");return e&&a?"This value starts and ends with whitespace.":e?"This value starts with whitespace.":a?"This value ends with whitespace.":null},[p]),g=(0,E.useMemo)(()=>p.split(/( )/).filter(Boolean),[p]),b=(0,E.useMemo)(()=>s?"cursor-not-allowed text-gray-700 bg-gray-100 shadow-[0_0_0_1px_var(--ds-gray-400),_0_0_0_1px_var(--ds-background-200)]":i?"shadow-[0_0_0_1px_var(--ds-red-900),0_0_0_4px_var(--ds-red-300)] hover:shadow-[0_0_0_1px_var(--ds-red-900),0_0_0_4px_var(--ds-red-500)] focus-within:!shadow-[0_0_0_1px_var(--ds-red-900),0_0_0_4px_var(--ds-red-300)]":"shadow-[0_0_0_1px_var(--border-color,var(--ds-gray-alpha-400))] hover:shadow-[0_0_0_1px_var(--ds-gray-alpha-500)] focus-within:!shadow-[0_0_0_1px_var(--ds-gray-alpha-600),0px_0px_0px_4px_#00000029]",[i,s]);return(0,a.jsxs)("div",{className:(0,M.clsx)(`
      w-full grid grid-cols-1 grid-rows-1 items-center rounded px-2 transition-shadow
      *:text-sm *:font-mono relative *:p-0 *:py-2 *:rounded *:leading-none *:tracking-normal *:col-span-full *:row-span-full
      `,{[b]:!0,[n??""]:!!n}),id:o,children:[(0,a.jsx)("textarea",{ref:v,className:"text-transparent caret-foreground resize-none overflow-hidden outline-none z-10 bg-transparent",value:p,onChange:e=>{m(e.target.value),d?.(e)},disabled:s,...c,spellCheck:"false",autoComplete:"off"}),(0,a.jsx)("p",{ref:h,className:"text-foreground pointer-events-none wrap-break-word whitespace-pre-wrap",children:g.map((e,t)=>" "!==e?(0,a.jsx)("span",{children:e}):(0,a.jsx)("span",{className:(0,M.clsx)("relative after:content-['⎵'] after:absolute after:-left-[1px] after:top-1.5 after:text-[0.8rem]  text-gray-900",{"text-geist-warning bg-amber-100":0===t||t===g.length-1}),children:" "}))}),(0,a.jsx)("div",{className:(0,M.clsx)("absolute right-0 bottom-0 translate-y-1.5 translate-x-0.5 z-10 transition-opacity duration-75",f?"pointer-events-auto opacity-1":"opacity-0 pointer-events-none"),children:(0,a.jsx)(B.Tooltip,{position:"top",text:f,tabIndex:-1,children:(0,a.jsx)(U.WarningFill,{color:"amber-600"})})})]})}var W=e.i(57106);let Z=(0,E.createContext)(null);function K(){let e=(0,E.useContext)(Z);return(0,E.useMemo)(()=>null==e?[]:e.conditionGroup.flatMap(e=>e.conditions.map(e=>e.type)),[e])}Z.displayName="RuleConditionsConxtext",e.s(["RuleConditionProvider",0,function(e){let{children:t,rule:l}=e;return(0,a.jsx)(Z.Provider,{value:l,children:t})},"useRuleConditionProvider",0,K],7894499);var J=e.i(2006191),Q=e.i(8238875),Y=e.i(4597921);function X(){let e=(0,Q.useParams)(),a=(0,J.useTeam)(e?.teamSlug??""),t=(0,Y.useServerFlag)("firewall-rate-limit-api",!1),l=(0,Y.useServerFlag)("security-plus-access",!1);return{team:a?.data??null,flags:new Map([["firewall-rate-limit-api",t],["security-plus-access",l]])}}function ee(e){return["inc","!inc","ninc"].includes(e)}function ea(e){return["ex","!ex","nex"].includes(e)}function et(e,a){return e.moduleMap.get(a)}function el(){let e=(0,P.useFilterContext)(),{state:t,index:l,groupId:r}=(0,T.useItemStateContext)(),n=(0,N.useDisabled)(),s=K(),i=X(),o=et(e,t.filterId),d=e.state.find(e=>e.id===r),u=e.state.length>1||(d?.filters??[]).length>1,c=o?.disabled?.(i,s)??!1;return(0,a.jsxs)("div",{className:"flex flex-col gap-3 w-full",children:[o&&c?(0,a.jsx)(S.Note,{type:"warning",fill:!0,children:(0,a.jsxs)("p",{children:["You do not have access to the"," ",(0,a.jsx)("span",{className:"font-medium",children:o.title})," control."]})}):null,(0,a.jsxs)("div",{className:"min-h-[80px]  rounded-md border bg-white p-6 flex flex-col @lg-page:flex-row gap-3 items-start",children:[(0,a.jsxs)("div",{className:"flex gap-2 items-center w-full @lg-page:max-w-[240px]",children:[(0,a.jsx)("p",{className:"text-copy-14 text-left capitalize pe-1",children:0===l?"if":"and"}),(0,a.jsx)(en,{}),u?(0,a.jsx)(f.Button,{"aria-label":"remove rule",disabled:n,onClick:()=>{d?.filters.length===1?e.deleteConditionGroup(r):e.deleteCondition(t.fieldId)},shape:"square",size:"small",svgOnly:!0,type:"error",typeName:"button",className:"size-[30px]",children:(0,a.jsx)(z.Trash,{size:16})}):null]}),(0,a.jsx)(er,{}),(0,a.jsx)(es,{}),(0,a.jsx)(ei,{})]})]})}function er(){let e=(0,P.useFilterContext)(),{state:t,moduleConfig:l}=(0,T.useItemStateContext)(),r=l.placeholder?.key||"",n=e.allErrors[`${t.fieldId}-key`],s=(0,N.useDisabled)();return(0,a.jsx)(a.Fragment,{children:l.allowKey?(0,a.jsx)("div",{className:"w-full @lg-page:max-w-[175px]",children:(0,a.jsx)(b.Input,{className:"w-full",disabled:s,error:n?"error":void 0,id:t.fieldId,name:`${t.filterId}-${t.fieldId}-key`,onChange:a=>e.updateCondition(t.fieldId,{type:"key",value:a.target.value}),placeholder:r,showErrorMessage:!1,size:"small",value:t.key,width:"100%"})}):null})}function en(){let e=(0,P.useFilterContext)(),{state:t,moduleConfig:l}=(0,T.useItemStateContext)(),r=(0,N.useDisabled)(),n=X(),s=K(),i=(0,E.useMemo)(()=>e.moduleKeys.map(a=>{let t=et(e,a);return{label:t.title,value:a,icon:t.icon,badge:t.badge,description:t.description,deprecated:t.deprecated,accessControl:t.accessControl,disabled:t.disabled}}),[e]);return(0,a.jsxs)("div",{className:"jsx-4f438cb26d60b0d9 flex flex-col items-stretch justify-start flex-initial w-full tailwind-preflight",children:[(0,a.jsx)(x.default,{id:"4f438cb26d60b0d9",children:".firewall-components-module-configuration-components-module-select-component [class*=combobox-module]>button{min-height:var(--geist-form-small-height,32px)!important;max-height:var(--geist-form-small-height,32px)!important;height:var(--geist-form-small-height,32px)!important}"}),(0,a.jsxs)(g.Combobox,{"aria-label":`rule type ${l.title}`,disabled:r,displaySelectedSuffix:!0,noRawSelectedValue:!0,onChange:a=>{a&&e.updateCondition(t.fieldId,{type:"filter",value:a})},placeholder:"Select attribute…",prefixIcon:l.icon,size:"small",value:t.filterId,width:"100%",className:"firewall-components-module-configuration-components-module-select-component",children:[(0,a.jsx)(g.Combobox.Input,{}),(0,a.jsx)(g.Combobox.List,{className:"overflow-x-hidden min-w-60",align:"start",children:(0,a.jsxs)(a.Fragment,{children:[i.filter(e=>{let a=e.deprecated?.(t.filterId)??!1,l=e.accessControl?.(n,s)??!0;return!a&&l}).map(e=>{let{value:t,label:l,icon:r,description:i,badge:o,disabled:d}=e;return(0,a.jsx)(g.Combobox.Option,{className:"!h-auto min-h-0 max-h-40 !p-2.5 [&_>_span]:self-start",disabled:d?.(n,s)??!1,label:l,suffix:o||null,value:t,children:(0,a.jsxs)("div",{className:"jsx-4f438cb26d60b0d9 flex flex-col gap-1",children:[(0,a.jsxs)("header",{className:"jsx-4f438cb26d60b0d9 flex gap-2",children:[r?(0,a.jsx)("span",{className:"jsx-4f438cb26d60b0d9",children:r}):null,(0,a.jsx)("p",{className:"jsx-4f438cb26d60b0d9 font-medium text-gray-1000",children:l})]}),i?(0,a.jsx)("p",{className:"jsx-4f438cb26d60b0d9 text-label-13 text-gray-900",children:i}):null]})},t)}),(0,a.jsx)("div",{className:"jsx-4f438cb26d60b0d9 sticky top-0",children:(0,a.jsx)(W.Link,{className:"flex justify-between text-label-12 bg-background-200 hover:bg-gray-100 transition-colors text-gray-900 p-2.5 w-[calc(100%+20px)] -translate-x-2 -translate-y-2 rounded-t-md",external:!0,href:"/docs/vercel-firewall/vercel-waf/rule-configuration",children:"Rule Configuration Docs"})})]})})]})]})}function es(){let e=(0,P.useFilterContext)(),{state:t,moduleConfig:l}=(0,T.useItemStateContext)(),r=(0,N.useDisabled)(),n=l.allowedOperators.find(e=>e.value===t.operator)?.label;return(0,a.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial w-full @lg-page:max-w-[175px]",children:l.allowedOperators.length>1?(0,a.jsxs)(C.MenuContainer,{position:"bottom-start",children:[(0,a.jsx)(w.MenuButton,{align:"flex-grow","aria-label":`Operator ${n||""}`,disabled:r,size:"small",suffix:(0,a.jsx)(I.ChevronDown,{}),type:"secondary",width:"100%",children:(0,a.jsx)("div",{className:"flex flex-row items-center justify-start flex-1 w-full",children:(0,a.jsx)("span",{children:n??""})})}),(0,a.jsx)(y.Menu,{className:"w-full overflow-y-auto lg:min-w-[200px]",portalClassName:"tailwind-preflight",useNewListHeightBehavior:{maxHeight:240,numberOfChildren:l.allowedOperators.length},children:l.allowedOperators.map(l=>(0,a.jsx)(j.MenuItem,{onClick:()=>{e.updateCondition(t.fieldId,{type:"operator",value:l.value})},value:l.value,children:(0,a.jsxs)("div",{className:"flex flex-row items-center justify-between gap-3 flex-1",children:[(0,a.jsx)("div",{className:"flex flex-row items-center justify-start flex-1",children:(0,a.jsx)("span",{children:l.label})}),l.value===t.operator?(0,a.jsx)(_.Check,{}):null]})},l.value))})]}):(0,a.jsx)(w.MenuButton,{align:"flex-grow","aria-label":`Operator ${n||""}`,disabled:!0,size:"small",type:"secondary",width:"100%",children:(0,a.jsx)("div",{className:"flex flex-row items-center justify-start flex-1 w-full",children:(0,a.jsx)("span",{children:n??""})})})})}function ei(){let e=(0,P.useFilterContext)(),{state:t,moduleConfig:l}=(0,T.useItemStateContext)(),r=(0,N.useDisabled)(),n=!!l.resolveValues,s=ee(t.operator),i=ea(t.operator),o=l.placeholder?.value||"";"re"===t.operator&&(o="Type a regular expression..");let d=e.allErrors[`${t.fieldId}-value`];if(n||s)return(0,a.jsx)(H,{allowAdd:l.allowCustomValue||s&&!n||!1,allowMulti:s,disabled:r,errors:d,filterName:l.title,getOptions:l.resolveValues,initialValue:t.value,onChange:a=>{s?e.updateCondition(t.fieldId,{type:"value",value:a}):e.updateCondition(t.fieldId,{type:"value",value:a[0]})},placeholder:o});let u=Array.isArray(t.value)?`${t.value.length>0?t.value[0]:""}`:`${t.value}`;return(0,a.jsx)(G,{className:"w-full",disabled:!!i||r,error:d?"errors":null,id:t.fieldId,name:`${t.filterId}-${t.fieldId}`,onChange:a=>e.updateCondition(t.fieldId,{type:"value",value:a.target.value}),placeholder:i?"Any value":o,value:i?"":u})}e.s(["isExistsOperator",0,ea,"isMultiOperator",0,ee],7754792),e.s(["getFieldModule",0,et],8181947);var eo=e.i(423255);let ed=o.z.string().nullable(),eu=o.z.string().min(1,"Requires a value"),ec=o.z.string().min(1,"Requires a value").refine(e=>RegExp("^(?!-)[A-Za-z0-9-]{1,63}(?<!-)(?:\\.(?!-)[A-Za-z0-9-]{1,63}(?<!-))*$").test(e),{message:"Invalid host name provided"}),ep=o.z.string().min(1,"Requires a value").refine(e=>{try{return new RegExp(e),!0}catch(e){return!1}},{message:"Invalid regular expression provided"}),em=o.z.string().min(1,"Requires a value").superRefine((e,a)=>{if(!eo.default.isIP(e)){if(eo.default.isIPRange(e)){let[t,l]=e.split("/"),r=Number.parseInt(l,10);return t.includes(".")?r<0?void a.addIssue({code:o.z.ZodIssueCode.custom,message:"IPv4 CIDR cannot have a net mask less than /0"}):{isValid:!0,errorMsg:""}:void(r>32&&a.addIssue({code:o.z.ZodIssueCode.custom,message:"IPv6 CIDR cannot have a net mask greater than /32"}))}a.addIssue({code:o.z.ZodIssueCode.custom,message:"Invalid IP address or CIDR"})}}),eh=o.z.string().min(1,"Requires a value").refine(e=>e.startsWith("/"),'Path must start with a "/"').refine(e=>{try{return new URL(e,"https://example.com"),!0}catch{return!1}},"Path must be a valid URL path"),ev=o.z.string().min(1,"Requires a value").refine(e=>/^\d+$/.test(e));e.s(["digitSchema",0,ev,"hostnameSchema",0,ec,"ipAndCidrsSchema",0,em,"optionalString",0,ed,"pathSchema",0,eh,"regexSchema",0,ep,"stringSchema",0,eu],5812308);let ex=[{value:"eq",label:"Equals"},{value:"!eq",label:"Does not equal"},{value:"inc",label:"Is any of"},{value:"!inc",label:"Is not any of"}],ef=[{value:"ex",label:"Exists",schema:ed},{value:"!ex",label:"Does not exist",schema:ed}],eg=[...ex,{value:"sub",label:"Contains",schema:eu},{value:"!sub",label:"Does not contain",schema:eu},{value:"pre",label:"Starts with",schema:eu},{value:"!pre",label:"Does not start with",schema:eu},{value:"suf",label:"Ends with",schema:eu},{value:"!suf",label:"Does not end with",schema:eu},{value:"re",label:"Matches expression",schema:ep},{value:"!re",label:"Does not match expression",schema:ep}],eb={title:"Country",icon:(0,a.jsx)(t.Location,{}),Component:el,description:"Client country derived from IP address",schema:o.z.union([eu,o.z.array(eu).min(1,"Country cannot be empty")]),resolveValues:()=>p.default.getCountries().map(e=>({label:e.name,value:e.iso2.toUpperCase()})),allowedOperators:ex,placeholder:{value:"Type a country name.."}},ey={title:"Hostname",icon:(0,a.jsx)(n.WindowGlobe,{}),Component:el,description:"Hostname of the incoming request",schema:o.z.union([ec,o.z.array(ec).min(1,"Hostname cannot be empty")]),allowedOperators:eg,placeholder:{value:"Type a hostname.."}},ew={title:"Request Header",icon:(0,a.jsx)(l.Hash,{}),Component:el,description:"HTTP header key and value from request",schema:o.z.union([eu,o.z.array(eu).min(1,"Request header cannot be empty")]),allowedOperators:[...eg,...ef],allowKey:!0,placeholder:{value:"Type a value..",key:"X-Request-Header"}},eC={title:"IP Address",icon:(0,a.jsx)(n.WindowGlobe,{}),Component:el,description:"Client IP address or CIDR block",schema:o.z.union([em,o.z.array(em).min(1,"IP address cannot be empty")]),allowedOperators:ex,placeholder:{value:"e.g. 10.0.0.1, 10.0.0.1/32"}},ej={title:"Method",icon:(0,a.jsx)(l.Hash,{}),Component:el,description:"HTTP method of the incoming request",schema:o.z.union([eu,o.z.array(eu).min(1,"Method cannot be empty")]),resolveValues:()=>[{label:"GET",value:"GET"},{label:"HEAD",value:"HEAD"},{label:"POST",value:"POST"},{label:"DELETE",value:"DELETE"},{label:"PATCH",value:"PATCH"},{label:"PUT",value:"PUT"},{label:"CONNECT",value:"CONNECT"},{label:"OPTIONS",value:"OPTIONS"},{label:"TRACE",value:"TRACE"},{label:"DEBUG",value:"DEBUG"},{label:"QUERY",value:"QUERY"}],allowedOperators:ex},eS={title:"Environment",icon:(0,a.jsx)(n.WindowGlobe,{}),Component:el,description:"Vercel deployment environment",schema:o.z.union([eu,o.z.array(eu).min(1,"Vercel environment cannot be empty")]),resolveValues:()=>[{label:"Preview",value:"preview"},{label:"Production",value:"production"}],allowedOperators:ex},eN={title:"Request Path",icon:(0,a.jsx)(r.Route,{}),Component:el,description:"Normalized URL path of the request excluding query",schema:o.z.union([eh,o.z.array(eh).min(1,"Path cannot be empty")]),allowedOperators:eg,placeholder:{value:"e.g. /api, /signup/new"}},e_={title:"Route",icon:(0,a.jsx)(r.Route,{}),Component:el,description:"Framework determined route pattern",schema:o.z.union([eh,o.z.array(eh).min(1,"Path cannot be empty")]),allowedOperators:eg,placeholder:{value:"e.g. /blog/[slug]"}},eI={title:"Server Action Name",icon:(0,a.jsx)(r.Route,{}),Component:el,description:"Next.js server action invoked",schema:o.z.union([eu,o.z.array(eu).min(1,"Server action name cannot be empty")]),allowedOperators:eg,placeholder:{value:"e.g. app/lib/action.ts#getLogin"}},ez={title:"Raw Path",icon:(0,a.jsx)(r.Route,{}),Component:el,description:"Raw URL path of the request excluding query",schema:o.z.union([eh,o.z.array(eh).min(1,"Path cannot be empty")]),allowedOperators:eg,placeholder:{value:"e.g. /api/, /signup/new/"}},eE={title:"User Agent",icon:(0,a.jsx)(l.Hash,{}),Component:el,description:"HTTP User-Agent header from client",schema:o.z.union([eu,o.z.array(eu).min(1,"User Agent cannot be empty")]),allowedOperators:eg,placeholder:{value:"e.g. curl"}},eT={title:"Query",icon:(0,a.jsx)(l.Hash,{}),Component:el,description:"Query parameter key and value",schema:o.z.union([eu,o.z.array(eu).min(1,"Query cannot be empty")]),allowedOperators:[...eg,...ef],allowKey:!0,placeholder:{key:"e.g. id, postId",value:"Type a value.."}},eP={title:"Cookie",icon:(0,a.jsx)(l.Hash,{}),Component:el,description:"Cookie name and value from request",schema:o.z.union([eu,o.z.array(eu).min(1,"Cookie cannot be empty")]),allowedOperators:[...eg,...ef],allowKey:!0,placeholder:{key:"Cookie-Name",value:"Type a value.."}},eO={title:"Continent",icon:(0,a.jsx)(t.Location,{}),Component:el,description:"Client continent derived from IP address",schema:o.z.union([eu,o.z.array(eu).min(1,"Continent cannot be empty")]),resolveValues:()=>[{label:"Africa",value:"AF"},{label:"Antarctica",value:"AN"},{label:"Asia",value:"AS"},{label:"Europe",value:"EU"},{label:"North America",value:"NA"},{label:"Oceania",value:"OC"},{label:"South America",value:"SA"}],allowedOperators:ex},eA={title:"City",icon:(0,a.jsx)(t.Location,{}),Component:el,description:"Client city derived from IP address",schema:o.z.union([eu,o.z.array(eu).min(1,"City cannot be empty")]),allowedOperators:eg,placeholder:{value:"Type a city name.."}},eR={title:"State",icon:(0,a.jsx)(t.Location,{}),Component:el,description:"Client state derived from IP address",schema:o.z.union([eu,o.z.array(eu).min(1,"State cannot be empty")]),allowedOperators:eg,placeholder:{value:"Type a state abbreviation.."}},ek={title:"AS Number",icon:(0,a.jsx)(t.Location,{}),Component:el,description:"Autonomous System Number from client IP",schema:o.z.union([ev,o.z.array(ev).min(1,"AS Number cannot be empty")]),allowedOperators:eg,placeholder:{value:"Digits only, ex. 12345"}},e$={title:"Vercel Region",icon:(0,a.jsx)(t.Location,{}),Component:el,description:"Vercel region that handled request",schema:o.z.union([eu,o.z.array(eu).min(1,"Vercel Region cannot be empty")]),resolveValues:()=>Object.values(c.regions).map(e=>({label:`${e.key} - ${e.name}`,value:e.key})),allowedOperators:ex},eD={title:"Protocol",icon:(0,a.jsx)(n.WindowGlobe,{}),Component:el,description:"HTTP protocol version",schema:o.z.union([eu,o.z.array(eu).min(1,"Protocol cannot be empty")]),resolveValues:()=>[{label:"HTTP/1.1",value:"HTTP/1.1"},{label:"HTTP/2.0",value:"HTTP/2.0"}],allowedOperators:ex},eL={title:"JA3 Digest",icon:(0,a.jsx)(s.Shield,{}),Component:el,description:"JA3 TLS fingerprint of client connection",schema:o.z.union([eu,o.z.array(eu).min(1,"JA3 cannot be empty")]),allowedOperators:eg,placeholder:{value:"Type a value.."},accessControl:e=>{let{team:a}=e;return a?.billing?.plan==="enterprise"}},eM={title:"JA4 Digest",icon:(0,a.jsx)(s.Shield,{}),Component:el,description:"JA4 TLS fingerprint of client connection",schema:o.z.union([eu,o.z.array(eu).min(1,"JA4 cannot be empty")]),allowedOperators:eg,placeholder:{value:"Type a value.."}},eV={title:"@vercel/firewall",icon:(0,a.jsx)(s.Shield,{}),Component:el,description:"Rate limit ID from @vercel/firewall package",schema:o.z.union([eu,o.z.array(eu).min(1,"Rate-limit ID cannot be empty")]),allowedOperators:[{value:"eq",label:"with rate limit ID"}],placeholder:{value:"Rate limit ID"},accessControl:e=>{let{team:a,flags:t}=e,l=t.get("firewall-rate-limit-api")??!1,r=a?.billing?.planIteration??null;return l&&!(0,v.isLegacyPlanIteration)(r)}};function eq(e){let{team:a,flags:t}=e;return(0,m.isSecurityPlusEnabled)({team:a})||!!t?.get("security-plus-access")}let eH={path:eN,route:e_,server_action:eI,raw_path:ez,method:ej,user_agent:eE,header:ew,query:eT,bot_name:{title:"Bot Name",icon:(0,a.jsx)(i.Robot,{}),badge:(0,a.jsx)(u.default,{size:"sm"}),Component:el,description:"Common name of the identified known bot",schema:o.z.union([eu,o.z.array(eu).min(1,"Bot name cannot be empty")]),resolveValues:()=>(0,h.fetchVerifiedBots)().then(e=>e.names).catch(e=>(d.toasts.error(`Error fetching Bot Name: ${e instanceof Error?e.message:String(e)}`),[])),allowedOperators:eg,placeholder:{value:"Type a bot name…"},accessControl:(e,a)=>{let t=eq(e);return/\/configure\/rule\//.test(globalThis.location.pathname)?t||a.includes("bot_name"):t},disabled:e=>!eq(e)},bot_category:{title:"Bot Category",icon:(0,a.jsx)(i.Robot,{}),badge:(0,a.jsx)(u.default,{size:"sm"}),Component:el,description:"Category identified known bot",schema:o.z.union([eu,o.z.array(eu).min(1,"Bot category cannot be empty")]),resolveValues:()=>(0,h.fetchVerifiedBots)().then(e=>e.categories).catch(e=>(d.toasts.error(`Error fetching Bot Category: ${e instanceof Error?e.message:String(e)}`),[])),allowedOperators:eg,placeholder:{value:"Type a bot category…"},accessControl:(e,a)=>{let t=eq(e);return/\/configure\/rule\//.test(globalThis.location.pathname)?t||a.includes("bot_category"):t},disabled:e=>!eq(e)},cookie:eP,host:ey,environment:eS,ip_address:eC,protocol:eD,region:e$,geo_continent:eO,geo_country:eb,geo_country_region:eR,geo_city:eA,geo_as_number:ek,ja4_digest:eM,ja3_digest:eL,rate_limit_api_id:eV,target_path:{...e_,deprecated:e=>"target_path"!==e}};e.s(["baseModules",0,eH],5120783)}]);

//# debugId=4e8f977f-a8f9-46c7-63a3-ff5a2aed1182
//# sourceMappingURL=27c09ca2ee011952.js.map